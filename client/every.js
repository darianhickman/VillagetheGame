var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var h=a[e];if(c.call(b,h,e,a))return{i:e,v:h}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
var GameObject=IgeEntity.extend({classId:"GameObject",init:function(){IgeEntity.prototype.init.call(this);this.isometric(!0).bounds3d(40,40,40).drawBounds(!0);this._tileAdjustY=this._tileAdjustX=0},calcTileAdjust:function(){this._tileAdjustX=this._bounds3d.x/ige.client.currentTileMap._tileWidth/2-.5;this._tileAdjustY=this._bounds3d.y/ige.client.currentTileMap._tileHeight/2-.5},place:function(){},moveTo:function(a,c){this.unOccupyTile(this.data("tileX"),this.data("tileY"),this.data("tileWidth"),this.data("tileHeight"));
this.data("tileX",a).data("tileY",c);this.occupyTile(this.data("tileX"),this.data("tileY"),this.data("tileWidth"),this.data("tileHeight"));this.translateToTile(a+this._tileAdjustX,c+this._tileAdjustY);dataLayer.push({event:"gameObjectMove"});ige.client.eventEmitter.emit("updatePosition",{id:this.classId(),type:this.type});console.log("this",this);return this}});var HiEntity=IgeEntity.extend({classId:"HiEntity",tick:function(a){IgeEntity.prototype.tick.call(this,a);for(var c=-100;300>c;c++)for(var b=-100;300>b;b++){var d=20*c,e=20*b,h=Math.ceil(d/ige.$("tileMap1")._tileWidth),g=Math.ceil(e/ige.$("tileMap1")._tileHeight);ige.$("tileMap1").inGrid(h,g,1,1)&&(ige.$("tileMap1").isTileOccupied(h,g,1,1)?a.fillStyle="red":a.fillStyle="#3f3",d=(new IgePoint3d(d,e,0)).toIso(),a.fillRect(d.x,d.y,3,3))}}});var Villager=IgeEntity.extend({classId:"Villager",init:function(){var a=this;IgeEntity.prototype.init.call(this);a.isometric(!0).bounds3d(20,20,30).texture(ige.client.textures.villager1).dimensionsFromCell().addComponent(IgeAnimationComponent).animation.define("NW",[1,2,3,2],12,-1).animation.define("SW",[4,5,6,5],12,-1).cell(5).translateTo(0,-10,0);a.pathFinder=(new IgePathFinder).neighbourLimit(100);a.addComponent(IgePathComponent).path.finder(a.pathFinder).tileMap(ige.$("tileMap1")).tileChecker(function(a,
b,d,e,h,g,p){return!a&&0<=b&&0<=d&&b<=ige.$("tileMap1").gridSize().x&&d<=ige.$("tileMap1").gridSize().y}).lookAheadSteps(3).dynamic(!0).allowSquare(!0).allowDiagonal(!0).drawPath(!1).drawPathGlow(!0).drawPathText(!0);a.path.speed(3);a.path.on("pathComplete",function(){a.path.clear()})},walkToTile:function(a,c){var b=this.path;1<b._points.length?(b.replacePoints(b._currentPointTo,b._points.length,b._points[b._currentPointTo]),b.add(a,c,0,!0)):b.clear().add(a,c,0,!0).start()},currentTile:function(){return this._parent.pointToTile(this._translate)},
update:function(a,c){IgeEntity.prototype.update.call(this,a,c);var b=this.path.getDirection(),d=b;if(b!==this._direction){if(b){switch(b){case "NE":b="NW";this.scaleTo(-1,1,1);break;case "SE":b="SW";this.scaleTo(-1,1,1);break;case "N":b="NW";this.scaleTo(-1,1,1);break;case "W":b="NW";this.scaleTo(1,1,1);break;case "S":b="SW";this.scaleTo(1,1,1);break;case "E":b="NW";this.scaleTo(-1,1,1);break;default:this.scaleTo(1,1,1)}this.animation.start(b);console.log(b)}else switch(this.animation.stop(),this._direction){case "NE":this.cell(2);
this.scaleTo(-1,1,1);break;case "SE":this.cell(5);this.scaleTo(-1,1,1);break;case "NW":this.cell(2);this.scaleTo(1,1,1);break;case "SW":this.cell(5),this.scaleTo(1,1,1)}this._direction=d}}});var gameScale=parseFloat(GameConfig.config.gameScale),uniqueCounter=0,Client=IgeClass.extend({classId:"Client",init:function(){var a=this;this.audio={};this.textures={};this.fsm=new IgeFSM;$("body").disableSelection();this.fsm.defineState("loaded",{enter:function(a,b){vlg.log.info("entering state this.fsm.loaded");dataLayer.push({event:"loaded"});vlg.bindSounds();vlg.music.welcome.fadeOut(0,2E3);vlg.music.levelfull1.fadeIn(1,2E3);ige.client.fsm.enterState("select");b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.loaded");
b()}});this.fsm.defineState("select",{enter:function(a,b){vlg.log.info("entering state this.fsm.select");dataLayer.push({event:"select"});var d=ige.$("tileMap1");ige.$("vp1").mousePan.enabled(!0).scrollZoom.enabled(!0);this.mouseUpHandle=d.on("mouseUp",function(a,b,c){a=d.mouseToTile();ige.$("bob").walkToTile(a.x,a.y)});ige.client.eventEmitter&&ige.client.eventEmitter.emit("executePendingAction",null);b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.select");ige.$("tileMap1").off("mouseUp",
this.mouseUpHandle);ige.client.currentMouseOverPanelOwner&&(ige.client.currentMouseOverPanelOwner.cancelTimeouts(),ige.client.currentMouseOverPanelOwner.hideMouseOverPanel());b()}});this.fsm.defineState("move",{enter:function(a,b){var d=this,e=ige.$("tileMap1");dataLayer.push({event:"move"});ige.client.showGrid("tileMap1");ige.$("vp1").mousePan.enabled(!0).scrollZoom.enabled(!0);ige.$("outlineEntity").mount(ige.$("tileMap1")).hide();ige.$("vp1").mousePan.off("panStart",c.mousePanStartHandler);ige.$("vp1").mousePan.off("panEnd",
c.mousePanEndHandler);$("#moveButton").unbind("click").click(function(){c.fsm.enterState("select")});$("#endMove").show();d.isMouseMoved=!1;d.mouseDownHandle=e.on("mouseDown",function(a,b,c){if(ige.client.data("moveItem")){if(a=e.map,g=ige.client.data("moveItem"),b=g.data("lastMoveX"),c=g.data("lastMoveY"),!a.collision(b,c,g.data("tileWidth"),g.data("tileHeight"))||a.collisionWithOnly(b,c,g.data("tileWidth"),g.data("tileHeight"),g))d.isMouseMoved=!1,ige.$("vp1").mousePan.enabled(!0),g.moveTo(b,c),
ige.client.data("moveItem",""),ige.$("outlineEntity").hide(),API.updateObject(g,b,c)}else{a=e.mouseToTile();var g=ige.client.itemAt("tileMap1",a.x,a.y);g&&(ige.$("vp1").mousePan.enabled(!1),d.isMouseMoved=!1,ige.client.data("moveItem",g),ige.client.data("moveItemX",g.data("tileX")),ige.client.data("moveItemY",g.data("tileY")),g.data("lastMoveX",g.data("tileX")),g.data("lastMoveY",g.data("tileY")),ige.$("outlineEntity").tileWidth=g.data("tileWidth"),ige.$("outlineEntity").tileHeight=g.data("tileHeight"),
ige.$("outlineEntity").isFeasible=!0,ige.$("outlineEntity").translateToTile(g.data("tileX"),g.data("tileY")),ige.$("outlineEntity").show())}});d.mouseUpHandle=e.on("mouseUp",function(a,b,c){if(!0===d.isMouseMoved&&ige.client.data("moveItem")){a=e.map;b=ige.client.data("moveItem");c=b.data("lastMoveX");var g=b.data("lastMoveY");if(!a.collision(c,g,b.data("tileWidth"),b.data("tileHeight"))||a.collisionWithOnly(c,g,b.data("tileWidth"),b.data("tileHeight"),b))d.isMouseMoved=!1,ige.$("vp1").mousePan.enabled(!0),
b.moveTo(c,g),ige.client.data("moveItem",""),ige.$("outlineEntity").hide(),API.updateObject(b,c,g)}});d.mouseMoveHandle=ige.$("vp1").on("mouseMove",function(a,b,c){d.isMouseMoved=!0;a=ige.client.data("moveItem");b=e.map;c=e.mouseToTile();if(a){var g=a.data("tileWidth"),h=a.data("tileHeight");0===g%2&&--g;0===h%2&&--h;c.x-=Math.floor(g/2);c.y-=Math.floor(h/2);0>c.x&&(c.x=0);0>c.y&&(c.y=0);c.x>ige.$("tileMap1").gridSize().x-a.data("tileWidth")&&(c.x=ige.$("tileMap1").gridSize().x-a.data("tileWidth"));
c.y>ige.$("tileMap1").gridSize().y-a.data("tileHeight")&&(c.y=ige.$("tileMap1").gridSize().y-a.data("tileHeight"));!b.collision(c.x,c.y,a.data("tileWidth"),a.data("tileHeight"))||b.collisionWithOnly(c.x,c.y,a.data("tileWidth"),a.data("tileHeight"),a)?(a.opacity(1),ige.$("outlineEntity").isFeasible=!0):(a.opacity(.5),ige.$("outlineEntity").isFeasible=!1);a.translateToTile(c.x+a._tileAdjustX,c.y+a._tileAdjustY);ige.$("outlineEntity").translateToTile(c.x,c.y);a.data("lastMoveX",c.x);a.data("lastMoveY",
c.y)}});b()},exit:function(a,b){var d=ige.$("tileMap1");ige.client.hideGrid("tileMap1");ige.$("outlineEntity").hide();$("#moveButton").unbind("click").click(function(){c.fsm.enterState("move")});$("#endMove").hide();c.mousePanStartHandler=ige.$("vp1").mousePan.on("panStart",function(){c.fsm.enterState("pan")});c.mousePanEndHandler=ige.$("vp1").mousePan.on("panEnd",function(){void 0!==ige.client.isEditorOn&&!0===ige.client.isEditorOn?ige.client.fsm.enterState("editor"):c.fsm.enterState("select")});
d.off("mouseDown",this.mouseDownHandle);d.off("mouseUp",this.mouseUpHandle);ige.$("vp1").off("mouseMove",this.mouseMoveHandle);if(ige.client.data("moveItem")){var d=ige.client.data("moveItem"),e=d.data("lastMoveX"),p=d.data("lastMoveY");d.moveTo(e,p);ige.client.data("moveItem","");ige.client.hideGrid("tileMap1");API.updateObject(d,e,p)}b()}});this.fsm.defineState("editor",{enter:function(a,b){vlg.log.info("entering state this.fsm.editor");dataLayer.push({event:"editor"});var d=ige.$("tileMapEditor");
$("#topToolbar").hide();$("#notifyIconContainer").hide();ige.$("vp1").mousePan.enabled(!0).scrollZoom.enabled(!0);ige.$("outlineEntity").mount(ige.$("tileMapEditor"));this.mouseUpHandle=d.on("mouseUp",function(a,b,c){if(ige.client.data("moveItem"))c=ige.client.data("moveItem"),a=c.data("lastMoveX"),b=c.data("lastMoveY"),c.moveTo(a,b),ige.client.data("moveItem",""),ige.client.hideGrid("tileMapEditor"),ige.client.editorManager.updateObject(c,a,b);else if(a=d.mouseToTile(),c=ige.client.itemAt("tileMapEditor",
a.x,a.y))ige.client.data("moveItem",c),ige.client.data("moveItemX",c.data("tileX")),ige.client.data("moveItemY",c.data("tileY")),c.data("lastMoveX",c.data("tileX")),c.data("lastMoveY",c.data("tileY")),ige.$("outlineEntity").tileWidth=c.data("tileWidth"),ige.$("outlineEntity").tileHeight=c.data("tileHeight"),ige.$("outlineEntity").isFeasible=!0,ige.$("outlineEntity").translateToTile(c.data("tileX"),c.data("tileY")),ige.client.showGrid("tileMapEditor")});this.mouseMoveHandle=ige.$("vp1").on("mouseMove",
function(a,b,c){a=ige.client.data("moveItem");b=d.map;c=d.mouseToTile();if(a){var e=a.data("tileWidth"),g=a.data("tileHeight");0===e%2&&--e;0===g%2&&--g;c.x-=Math.floor(e/2);c.y-=Math.floor(g/2);0>c.x&&(c.x=0);0>c.y&&(c.y=0);c.x>ige.$("tileMapEditor").gridSize().x-a.data("tileWidth")&&(c.x=ige.$("tileMapEditor").gridSize().x-a.data("tileWidth"));c.y>ige.$("tileMapEditor").gridSize().y-a.data("tileHeight")&&(c.y=ige.$("tileMapEditor").gridSize().y-a.data("tileHeight"));if(!b.collision(c.x,c.y,a.data("tileWidth"),
a.data("tileHeight"))||b.collisionWithOnly(c.x,c.y,a.data("tileWidth"),a.data("tileHeight"),a))a.translateToTile(c.x+a._tileAdjustX,c.y+a._tileAdjustY),ige.$("outlineEntity").translateToTile(c.x,c.y),a.data("lastMoveX",c.x),a.data("lastMoveY",c.y)}});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.editor");var d=ige.$("tileMapEditor");d&&d.off("mouseUp",this.mouseUpHandle);ige.$("vp1").off("mouseMove",this.mouseMoveHandle);ige.client.isEditorOn||(ige.client.editorManager=null);if(ige.client.data("moveItem")){var d=
ige.client.data("moveItem"),c=d.data("lastMoveX"),e=d.data("lastMoveY");d.moveTo(c,e);ige.client.data("moveItem","");ige.client.hideGrid("tileMapEditor");ige.client.editorManager.updateObject(d,c,e)}b()}});this.fsm.defineState("view",{enter:function(a,b){vlg.log.info("entering state this.fsm.view");dataLayer.push({event:"view"});ige.addGraph("IgeBaseScene");ige.$("vp1").addComponent(IgeMousePanComponent).addComponent(ScrollZoomComponent).addComponent(ScaleToPointComponent).addComponent(LimitZoomPanComponent,
{boundsX:0,boundsY:0,boundsWidth:parseInt(GameConfig.config.boundsWidth),boundsHeight:parseInt(GameConfig.config.boundsHeight)}).mousePan.enabled(!0).scrollZoom.enabled(!0).autoSize(!0).drawBounds(!1).drawBoundsData(!1).scene(ige.$("baseScene")).mount(ige);ige.addGraph("GraphView");ige.client.currentTileMap=ige.$("tileMapView");$("#topToolbar").hide();$("#notifyIconContainer").hide();$("#processingDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,
height:300,modal:!0,autoOpen:!1});$("#processingDialog").dialog("open");$("#processingContent").html("<div><p>Loading village, please wait!</p><p><img src='assets/textures/ui/loading_spinner.gif'></p></div>");$.ajax({dataType:"json",url:"/api/village/"+ige.client.viewVillageID,error:function(a){$("#processingContent").html("<div style='padding-top:80px'><p>There was an error contacting the server!<br />Please try again.</p><p><button id='refreshPageButton'>Refresh</button></p></div>");$("#refreshPageButton").on("click",
function(){location.reload()})},success:function(a){if("false"===a.viewable)$("#processingContent").html("<div style='padding-top:80px'><p>Village is not viewable, sorry.</p></div>");else{$("#villageTitle").text(a.title).show();for(var b=0;b<a.data.length;b++)ClientHelpers.addObject(a.data[b],"tileMapView"),ige.$(a.data[b].id).mouseOverPanel.find(".objectInfoFooter").first().hide();$("#processingDialog").dialog("close")}}});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.view");b()}});
this.fsm.defineState("tutorial",{enter:function(b,c){vlg.log.info("entering state this.fsm.tutorial");dataLayer.push({event:"tutorial"});!0!==API.state.isTutorialShown&&(vlg.bindSounds(),vlg.music.welcome.fadeOut(0,2E3),vlg.music.levelfull1.fadeIn(1,2E3));ige.$("vp1").mousePan.enabled(!1).scrollZoom.enabled(!1).camera.translateTo(0,0,0).camera.scaleTo(1,1,0);ige.$("level1").hide();ige.addGraph("GraphTutorial");$("#topToolbar").hide();$("#notifyIconContainer").hide();var d=$("#topToolbar").clone(!0,
!0);$(d).find("[id]").add(d).each(function(){this.id+="Tutorial"});d.insertAfter("#topToolbar");$("#topToolbarTutorial").children().hide();$("#topToolbarTutorial").children().unbind("click");$("#topToolbarTutorial").show();$("#cashbarProgressTutorial").progressbar("value",0);$("#cashbarProgressTutorial").text(0);$("#coinbarProgressTutorial").progressbar("value",parseInt(GameConfig.config.startCoins));$("#coinbarProgressTutorial").text(parseInt(GameConfig.config.startCoins));$("#waterbarProgressTutorial").progressbar("value",
parseInt(GameConfig.config.startWater));$("#waterbarProgressTutorial").text(parseInt(GameConfig.config.startWater));a.tutorial=new Tutorial;a.tutorial.gotoStep("initialStep");c()},exit:function(b,c){vlg.log.info("exiting state this.fsm.tutorial");ige.$("level1").show();ige.removeGraph("GraphTutorial");$("#topToolbarTutorial").remove();$("#topToolbar").show();$("#notifyIconContainer").show();a.tutorial=null;a.eventEmitter=a.eventEmitter||new EventEmitter;a.gameLogic=a.gameLogic||new GameLogic;API.setTutorialAsShown();
c()}});this.fsm.defineState("marketDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.marketDialog");dataLayer.push({event:"marketDialog"});$("#marketDialog").closest("div.ui-dialog").find("div.ui-dialog-titlebar").addClass("marketDialogHeader");b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.marketDialog");ige.$("marketDialog").hide();b()}});this.fsm.defineState("editorMarketDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.editorMarketDialog");dataLayer.push({event:"editorMarketDialog"});
b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.editorMarketDialog");b()}});this.fsm.defineState("cashDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.cashDialog");dataLayer.push({event:"cashDialog"});$("#cashBuyDialog").closest("div.ui-dialog").find("div.ui-dialog-titlebar").addClass("cashBuyDialogHeader");b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.cashDialog");ige.$("cashDialog").hide();b()}});this.fsm.defineState("coinDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.coinDialog");
dataLayer.push({event:"coinDialog"});$("#coinBuyDialog").closest("div.ui-dialog").find("div.ui-dialog-titlebar").addClass("coinBuyDialogHeader");b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.coinDialog");ige.$("coinDialog").hide();b()}});this.fsm.defineState("waterDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.waterDialog");dataLayer.push({event:"waterDialog"});$("#waterBuyDialog").closest("div.ui-dialog").find("div.ui-dialog-titlebar").addClass("waterBuyDialogHeader");
b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.waterDialog");ige.$("waterDialog").hide();b()}});this.fsm.defineState("goalDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.goalDialog");dataLayer.push({event:"goalDialog"});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.goalDialog");$("#goalDialog").dialog({close:function(a,b){}});$("#goalDialog").dialog("close");b()}});this.fsm.defineState("buyConfirmDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.buyConfirmDialog");
dataLayer.push({event:"buyConfirmDialog"});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.buyConfirmDialog");$("#buyConfirmYes").unbind("click");$("#buyConfirmNo").unbind("click");$("#buyConfirmOK").unbind("click");$("#buyConfirmDialog").dialog({close:function(a,b){}});$("#buyConfirmDialog").dialog("close");ige.client.newBuyConfirm&&(ige.client.newBuyConfirm.destroy(),ige.client.newBuyConfirm=null);b()}});this.fsm.defineState("showMessage",{enter:function(a,b){dataLayer.push({event:"showMessage"});
vlg.log.info("entering state this.fsm.showMessage");this.messageDialog=(new MessageDialog(a.title,a.message,a.callback)).layer(1).show().mount(ige.$("uiScene"));b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.showMessage");$("#messageDialogOK").unbind("click");this.messageDialog&&(this.messageDialog.isHidden()||this.messageDialog.hide(),null!==this.messageDialog.callback&&void 0!==this.messageDialog.callback&&(this.messageDialog.callback(),this.messageDialog.callback=null),this.messageDialog.destroy(),
this.messageDialog=null);b()}});this.fsm.defineState("playerMenu",{enter:function(b,c){vlg.log.info("entering state this.fsm.playerMenu");dataLayer.push({event:"playerMenu"});a.slideRight.open();c()},exit:function(b,c){vlg.log.info("exiting state this.fsm.playerMenu");a.slideRight.close();c()}});this.fsm.defineState("shareMyVillage",{enter:function(a,b){vlg.log.info("entering state this.fsm.shareMyVillage");dataLayer.push({event:"shareMyVillage"});$("#shareMyVillageDialog").dialog({resizable:!1,draggable:!0,
closeOnEscape:!1,close:function(a,b){ige.client.fsm.enterState("select")},width:500,height:300,modal:!0,autoOpen:!1});$("#shareMyVillageDialog").dialog("open");$("#shareMyVillageContent").html('<div style="padding-top:45px"><p>Share My Village:</p><div><textarea id="shareMyVillageTextArea" style="width:428px;"></textarea><div id="shareMyVillageErrorField" class="ui-state-error" style="display:none;font-size:14px;">Your browser doesn\'t support copying. Please copy manually</div><button id="copyMyVillageClipboardButton">Copy to Clipboard</button></div></div>');
var d=window.location.href.split("/"),d=d[0]+"//"+d[2];$("#shareMyVillageTextArea").val(d+"/view/"+API.user.key_id);$("#copyMyVillageClipboardButton").on("click",function(){$("#shareMyVillageTextArea").select();try{var a=document.execCommand("copy");console.log("Copying text command was "+(a?"successful":"unsuccessful"));a||$("#shareMyVillageErrorField").css("display","")}catch(p){console.log("Oops, unable to copy"),$("#shareMyVillageErrorField").css("display","")}});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.shareMyVillage");
$("#shareMyVillageDialog").dialog({close:function(a,b){}});$("#shareMyVillageDialog").dialog("close");b()}});this.fsm.defineState("feedbackDialog",{enter:function(a,b){vlg.log.info("entering state this.fsm.feedbackDialog");dataLayer.push({event:"feedbackDialog"});$("#feedBackDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:600,height:"auto",modal:!0,autoOpen:!1,close:function(a,b){ige.client.fsm.enterState("select")}});$("#feedBackDialog").dialog("open");$("#contact-submit").click(function(){$("#contactName")[0].checkValidity()&&
$("#contactEmail")[0].checkValidity()&&$("#contactMessage")[0].checkValidity()&&($(this).hide(),$("#contactSending").show(),$.ajax({url:"/sendfeedback",dataType:"json",method:"POST",async:!0,data:JSON.stringify({name:$("#contactName").val(),email:$("#contactEmail").val(),message:$("#contactMessage").val()}),success:function(a){(new BuyConfirm(a.message,null,!0)).layer(1).show().mount(ige.$("uiScene"))}}))});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.feedbackDialog");$("#feedBackDialog").dialog({close:function(a,
b){}});$("#feedBackDialog").dialog("close");$("#contactName").val("");$("#contactEmail").val("");$("#contactMessage").val("");$("#contactSending").hide();$("#contact-submit").show().unbind("click");b()}});this.fsm.defineState("login",{enter:function(a,b){vlg.log.info("entering state this.fsm.login");dataLayer.push({event:"login"});$("#processingDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1});$("#processingDialog").closest("div.ui-dialog").find("button.ui-dialog-titlebar-close").hide();
$("#processingDialog").dialog("open");$("#processingContent").html("<div><p>Signing in, please wait!</p><p><img src='assets/textures/ui/loading_spinner.gif'></p></div>");ige.client.gameLogic.loginManager.login();b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.login");$("#processingDialog").dialog("close");b()}});this.fsm.defineState("logout",{enter:function(a,b){vlg.log.info("entering state this.fsm.logout");dataLayer.push({event:"logout"});$("#processingDialog").dialog({resizable:!1,
draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1});$("#processingDialog").closest("div.ui-dialog").find("button.ui-dialog-titlebar-close").hide();$("#processingDialog").dialog("open");$("#processingContent").html("<div><p>Signing out, please wait!</p><p><img src='assets/textures/ui/loading_spinner.gif'></p></div>");ige.client.gameLogic.loginManager.logout();b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.logout");$("#processingDialog").dialog("close");
b()}});this.fsm.defineState("reloadGame",{enter:function(a,b){vlg.log.info("entering state this.fsm.reloadGame");dataLayer.push({event:"reloadGame"});$("#processingDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1});$("#processingDialog").closest("div.ui-dialog").find("button.ui-dialog-titlebar-close").hide();$("#processingDialog").dialog("open");$("#processingContent").html("<div><p>Loading village, please wait!</p><p><img src='assets/textures/ui/loading_spinner.gif'></p></div>");
for(var d=1;d<=ige.$("marketDialog")._pageCount;d++)$("#marketDialogPage"+d).remove();$("#marketDialogPagination").jqPagination("destroy");$("#marketDialogPagination").find("input").data("current-page",1);$(".notifyIconContainer").empty();d=$("#objectInfoPanelTemplate");$("#objectInfoContainer").empty();$("#objectInfoContainer").append(d);history.replaceState({villageID:"none"},"load_village",location.href.split("?")[0]);ige.client.viewVillageID=null;ige.client.eventEmitter=null;ige.client.gameLogic=
null;ige.removeGraph("GraphLevel1");ige.removeGraph("GraphUi");API.state={coins:parseInt(GameConfig.config.startCoins),cash:parseInt(GameConfig.config.startCash),water:parseInt(GameConfig.config.startWater),isTutorialShown:!0};API.stateObjectsLookup={};API.stateGoalsLookup={};API.user=null;API.loginStatus="offline";API.init(function(){ige.addGraph("GraphLevel1");ige.client.currentTileMap=ige.$("tileMap1");ige.addGraph("GraphUi");(new Villager).id("bob").mount(ige.$("tileMap1"));dataLayer.push({event:"gameReload"})});
b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.reloadGame");$("#processingDialog").dialog("close");b()}});var c=this;this.fsm.defineState("build",{enter:function(a,b){vlg.log.info("entering state this.fsm.build");dataLayer.push({event:"build"});var d=this,e=ige.$("tileMap1");ige.client.cursorObject=(new ige.newClassInstance(a.classId)).mount(ige.$("tileMap1")).layer(24);var p=a.classId;ige.client.cursorObjectData=a;var q=ige.client.cursorObject.xTiles,t=ige.client.cursorObject.yTiles;
ige.client.cursorObject.data("tileWidth",q).data("tileHeight",t);ige.$("outlineEntity").mount(ige.$("tileMap1"));ige.$("outlineEntity").tileWidth=q;ige.$("outlineEntity").tileHeight=t;ige.client.showGrid("tileMap1");d.mouseMoveHandle=ige.$("vp1").on("mouseMove",function(a,b,c){a=e.mouseToTile();b=q;c=t;0===b%2&&--b;0===c%2&&--c;a.x-=Math.floor(b/2);a.y-=Math.floor(c/2);0>a.x&&(a.x=0);0>a.y&&(a.y=0);a.x>ige.$("tileMap1").gridSize().x-ige.client.cursorObject.xTiles&&(a.x=ige.$("tileMap1").gridSize().x-
ige.client.cursorObject.xTiles);a.y>ige.$("tileMap1").gridSize().y-ige.client.cursorObject.yTiles&&(a.y=ige.$("tileMap1").gridSize().y-ige.client.cursorObject.yTiles);b=!e.isTileOccupied(a.x,a.y,q,t);ige.client.cursorObject.opacity(b?1:.5);ige.$("outlineEntity").isFeasible=b;ige.client.cursorObject.translateToTile(a.x+ige.client.cursorObject._tileAdjustX,a.y+ige.client.cursorObject._tileAdjustY);ige.$("outlineEntity").translateToTile(a.x,a.y);d.cursorTile=a});d.mouseUpHandle=e.on("mouseUp",function(a,
b,g){b=ige.client.cursorObject.xTiles;g=ige.client.cursorObject.yTiles;a=ige.$("bob").currentTile();var h=e.mouseToTile(),f=b,l=g;0===f%2&&--f;0===l%2&&--l;h.x-=Math.floor(f/2);h.y-=Math.floor(l/2);0>h.x&&(h.x=0);0>h.y&&(h.y=0);h.x>ige.$("tileMap1").gridSize().x-ige.client.cursorObject.xTiles&&(h.x=ige.$("tileMap1").gridSize().x-ige.client.cursorObject.xTiles);h.y>ige.$("tileMap1").gridSize().y-ige.client.cursorObject.yTiles&&(h.y=ige.$("tileMap1").gridSize().y-ige.client.cursorObject.yTiles);ige.client.hideGrid("tileMap1");
if(e.isTileOccupied(h.x,h.y,b,g))ige.client.cursorObject.destroy(),ige.client.cursorObject=null,ige.client.cursorObjectData=null,c.fsm.enterState("select");else if(API.reduceAssets({coins:parseInt(ige.client.cursorObjectData.coins,10),cash:parseInt(ige.client.cursorObjectData.cash,10)}).status){dataLayer.push({event:"gameObjectBuild"});vlg.sfx.build.play();ige.client.cursorObject.occupyTile(d.cursorTile.x,d.cursorTile.y,b,g);ige.client.cursorObject.data("tileX",d.cursorTile.x).data("tileY",d.cursorTile.y).data("tileWidth",
b).data("tileHeight",g);b={id:ige.client.cursorObject.id(),x:d.cursorTile.x,y:d.cursorTile.y,w:b,h:g,name:p,buildStarted:Date.now(),currentState:"building"};ige.client.cursorObject._buildStarted=b.buildStarted;API.createObject(b);b=ige.client.cursorObject._translate.toIso();ige.client.cursorObject.layer(5).translate().z(100)._translate.tween({z:0},1E3,{easing:"outBounce"}).start();ige.client.cursorObject.currentState="building";ige.client.cursorObject.place();if(0<ige.client.cursorObjectData.coins){var m;
m=(new IgeEntity).layer(10).texture(ige.client.textures.coin).dimensionsFromCell().scaleTo(1,1,1).translateToPoint(b).translateBy(-10,-50,0).mount(ige.$("tileMap1"));(new IgeFontEntity).layer(2).textAlignX(0).colorOverlay("#ffffff").nativeFont("12px Verdana").textLineSpacing(0).text("-"+ige.client.cursorObjectData.coins).width(45).center(28).mount(m);m._translate.tween({y:b.y-100},2E3).start(200);m.tween({_opacity:0},2E3,{easing:"inQuad"}).afterTween(function(){m.destroy()}).start(200);ige.$("coinEmitter").quantityMax(parseInt(ige.client.cursorObjectData.coins,
10)).start()}ige.client.eventEmitter.emit("build",{id:p,type:ige.client.cursorObject.type,unlocks:ige.client.cursorObject.unlocks,callback:function(){ige.client.cursorObject=null;ige.client.cursorObjectData=null}});ige.$("tileMap1").isTileOccupied(a.x,a.y,1,1)?ige.$("bob").walkToTile(a.x+1,a.y-1):ige.$("bob").walkToTile(d.cursorTile.x,d.cursorTile.y)}else ga("send",  "Not enough money"),ige.client.cursorObject.destroy(),ige.client.cursorObject=null,ige.client.cursorObjectData=null,(new BuyConfirm(GameConfig.config.notEnoughCoinsString,
function(){ige.$("coinDialog").show()})).layer(1).show().mount(ige.$("uiScene"))});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.build");ige.$("tileMap1").off("mouseUp",this.mouseUpHandle);ige.$("vp1").off("mouseMove",this.mouseMoveHandle);ige.client.hideGrid("tileMap1");ige.client.cursorObject&&(ige.client.cursorObject.destroy(),delete ige.client.cursorObject);b()}});this.fsm.defineState("editorBuild",{enter:function(a,b){vlg.log.info("entering state this.fsm.editorBuild");dataLayer.push({event:"editorBuild"});
var d=ige.$("tileMapEditor"),c=a.classId,e,q;ige.client.createNewCursorObject(a);e=ige.client.cursorObject.xTiles;q=ige.client.cursorObject.yTiles;ige.client.showGrid("tileMapEditor");this.mouseMoveHandle=ige.$("vp1").on("mouseMove",function(a,b,c){a=d.mouseToTile();b=e;c=q;0===b%2&&--b;0===c%2&&--c;a.x-=Math.floor(b/2);a.y-=Math.floor(c/2);0>a.x&&(a.x=0);0>a.y&&(a.y=0);a.x>ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles&&(a.x=ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles);
a.y>ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles&&(a.y=ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles);b=!d.isTileOccupied(a.x,a.y,e,q);ige.client.cursorObject.opacity(b?1:.5);ige.$("outlineEntity").isFeasible=b;ige.client.cursorObject.translateToTile(a.x+ige.client.cursorObject._tileAdjustX,a.y+ige.client.cursorObject._tileAdjustY);ige.$("outlineEntity").translateToTile(a.x,a.y)});this.mouseUpHandle=d.on("mouseUp",function(a,b,g){a=d.mouseToTile();b=e;g=
q;0===b%2&&--b;0===g%2&&--g;a.x-=Math.floor(b/2);a.y-=Math.floor(g/2);0>a.x&&(a.x=0);0>a.y&&(a.y=0);a.x>ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles&&(a.x=ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles);a.y>ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles&&(a.y=ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles);d.isTileOccupied(a.x,a.y,e,q)||(vlg.sfx.build.play(),ige.client.cursorObject.occupyTile(a.x,a.y,e,q),ige.client.cursorObject.data("tileX",
a.x).data("tileY",a.y).data("tileWidth",e).data("tileHeight",q),a={id:ige.client.cursorObject.id(),x:a.x,y:a.y,w:e,h:q,name:c,buildStarted:Date.now(),buildCompleted:Date.now()},ige.client.cursorObject._buildStarted=a.buildStarted,ige.client.cursorObject._buildCompleted=a.buildCompleted,ige.client.editorManager.createObject(a),ige.client.cursorObject.place(!0),ige.client.cursorObject=null,ige.client.createNewCursorObject(ige.client.cursorObjectData))});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.build");
var d=ige.$("tileMapEditor");d&&d.off("mouseUp",this.mouseUpHandle);ige.$("vp1").off("mouseMove",this.mouseMoveHandle);ige.client.hideGrid("tileMapEditor");ige.client.cursorObject&&(ige.client.cursorObject.destroy(),delete ige.client.cursorObject);b()}});this.fsm.defineState("editorDelete",{enter:function(a,b){vlg.log.info("entering state this.fsm.editorDelete");dataLayer.push({event:"editorDelete"});var d=ige.$("tileMapEditor"),c=ige.$("uiSceneEditor").mousePos();ige.client.deleteCursorObject=(new IgeEntity).texture(ige.client.textures.xbutton).isometric(!1).dimensionsFromTexture().mount(ige.$("uiSceneEditor")).translateTo(c.x,
c.y,0);this.mouseMoveHandle=ige.$("vp1").on("mouseMove",function(a,b,d){a=ige.$("uiSceneEditor").mousePos();ige.client.deleteCursorObject.translateTo(a.x,a.y,0)});this.mouseUpHandle=d.on("mouseUp",function(a,b,c){a=d.mouseToTile();if(a=ige.client.itemAt("tileMapEditor",a.x,a.y))a.unOccupyTile(a.data("tileX"),a.data("tileY"),a.data("tileWidth"),a.data("tileHeight")),a.destroy(),ige.client.editorManager.deleteObject(a)});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.editorDelete");var d=
ige.$("tileMapEditor");d&&d.off("mouseUp",this.mouseUpHandle);ige.$("vp1").off("mouseMove",this.mouseMoveHandle);ige.client.deleteCursorObject.destroy();ige.client.deleteCursorObject=null;b()}});this.fsm.defineState("pan",{enter:function(a,b){vlg.log.info("entering state this.fsm.pan");dataLayer.push({event:"pan"});b()},exit:function(a,b){vlg.log.info("exiting state this.fsm.pan");b()}});this.fsm.defineTransition("build","marketDialog",function(a,b){ige.client.cursorObject&&(ige.client.cursorObject.destroy(),
delete ige.client.cursorObject);b(!1)});var b=$.when(getGameCatalog(),getGameEarnings(),getGameProblems(),getGameGoals(),getGameAssets(),getDropDownMenu(),getSpecialEvents());b.done(function(b,c,h,g,p,q,t){var d,e,G,k=[],f;for(f in GameObjects.gameObjectTextures)k.push(f);d=function(f){"TRUE"!==GameAssets.assets[f].enabled||"Audio"===GameAssets.assets[f].type||"FontSheet"===GameAssets.assets[f].type||a.isAssetInAtlas(uiAtlas,GameAssets.assets[f].id)?(f++,f===GameAssets.assets.length?e(0):d(f)):$.ajax({type:"HEAD",
async:!0,url:GameAssets.assets[f].url}).done(function(a,b,c){f++;f===GameAssets.assets.length?e(0):d(f)}).fail(function(a,b,c){GameAssets.assets[f].url=GameConfig.config.notFoundImageURL;f++;f===GameAssets.assets.length?e(0):d(f)})};e=function(f){a.isAssetInAtlas(catalogAtlas,GameObjects.gameObjectTextures[k[f]][2])?(f++,f===k.length?G():e(f)):$.ajax({type:"HEAD",async:!0,url:GameObjects.gameObjectTextures[k[f]][0]}).done(function(a,b,d){f++;f===k.length?G():e(f)}).fail(function(a,b,d){GameObjects.gameObjectTextures[k[f]][0]=
GameConfig.config.notFoundImageURL;f++;f===k.length?G():e(f)})};G=function(){a.textures.uiAtlas=new TexturePackerAtlas("uiAtlas","./assets/textures/sprites/atlas/uiAtlas.png","./assets/textures/sprites/atlas/uiAtlas.json");a.textures.catalogAtlas=new TexturePackerAtlas("catalogAtlas","./assets/textures/sprites/atlas/catalogAtlas.png","./assets/textures/sprites/atlas/catalogAtlas.json");for(var f=0;f<GameAssets.assets.length;f++)if("FALSE"!==GameAssets.assets[f].enabled){var b=GameAssets.assets[f];
"CellSheet"===b.type?a[b.attachTo][b.name]=new IgeCellSheet(b.url,parseInt(b.horizontalCells),parseInt(b.verticalCells)):"Audio"!==b.type&&("Texture"===b.type?a.isAssetInAtlas(uiAtlas,b.id)?(a[b.attachTo][b.name]=a.textures.uiAtlas.textureFromCell(b.id),a[b.attachTo][b.name]._url=b.url):a[b.attachTo][b.name]=new IgeTexture(b.url):"FontSheet"===b.type&&(a[b.attachTo][b.name]=new IgeFontSheet(b.url)))}for(var d in GameObjects.gameObjectTextures)f=GameObjects.gameObjectTextures[d],a.isAssetInAtlas(catalogAtlas,
f[2])?a.textures[d]=a.textures.catalogAtlas.textureFromCell(f[2]):a.textures[d]=new IgeCellSheet(f[0],f[1],1)};d(0)});b.fail(function(){alert("Game does not load at the moment. Please try again later.")});ige.ui.style(".dialog",{left:0,right:0,top:0,bottom:0});ige.ui.style(".underlay",{backgroundColor:"#000000",opacity:.6,left:0,right:0,top:0,bottom:0});ige.on("texturesLoaded",function(){for(var a in GameObjects.gameObjectTextures){var b=ige.client,h=GameObjects.gameObjectTextures[a],g,p,q,t,x;g=
b.textures[a]._sizeX;p=b.textures[a]._sizeY;q=g/h[1];t=p;q!==parseInt(q,10)&&b.log("Cell width is a floating-point number! (Image Width "+g+" / Number of Columns 3 = "+q+") in file: "+b.textures[a]._url,"warning");t!==parseInt(t,10)&&b.log("Cell height is a floating-point number! (Image Height "+p+" / Number of Rows 1 = "+t+")  in file: "+b.textures[a]._url,"warning");if(1<h[1])for(g=1;g<=1*h[1];g++)x=Math.ceil(g/h[1])-1,p=g-h[1]*x-1,b.textures[a]._cells[g]=[p*q,x*t,q,t];else b.textures[a]._cells[1]=
[0,0,b.textures[a]._sizeX,b.textures[a]._sizeY];b.textures[a]._url=h[0];b.textures[a]._cellColumns=h[1];b.textures[a]._cellRows=1}ige.createFrontBuffer(!0);ige.canvas(document.getElementById("gameCanvas"));ige.start(function(a){function d(a){ige.addGraph("IgeBaseScene");ige.addGraph("GraphLevel1");ige.client.currentTileMap=ige.$("tileMap1");ige.addGraph("GraphUi");ige.$("vp1").addComponent(IgeMousePanComponent).addComponent(ScrollZoomComponent).addComponent(ScaleToPointComponent).addComponent(LimitZoomPanComponent,
{boundsX:0,boundsY:0,boundsWidth:parseInt(GameConfig.config.boundsWidth),boundsHeight:parseInt(GameConfig.config.boundsHeight)}).mousePan.enabled(!1).scrollZoom.enabled(!1).autoSize(!0).drawBounds(!1).drawBoundsData(!1).scene(ige.$("baseScene")).mount(ige);c.mousePanStartHandler=ige.$("vp1").mousePan.on("panStart",function(){c.fsm.enterState("pan")});c.mousePanEndHandler=ige.$("vp1").mousePan.on("panEnd",function(){void 0!==ige.client.isEditorOn&&!0===ige.client.isEditorOn?ige.client.fsm.enterState("editor"):
c.fsm.enterState("select")});(new Villager).id("bob").mount(ige.$("tileMap1"));!0===a?b.fsm.initialState("loaded"):b.fsm.initialState("tutorial");dataLayer.push({event:"gameStart"})}if(a){if(a=getParameterByName(location.search,"v"))ige.client.viewVillageID=a;API.init(d)}})})},itemAt:function(a,c,b){return ige.$(a).map.tileData(c,b)},showGrid:function(a){ige.$(a).drawGrid(!0);ige.$(a).highlightOccupied(!0);ige.$("outlineEntity").show()},hideGrid:function(a){ige.$(a)&&(ige.$(a).drawGrid(!1),ige.$(a).highlightOccupied(!1));
ige.$("outlineEntity").hide()},setGameBoardPostTutorial:function(a){if(!API.state.objects)for(var c=0;c<a.length;c++)ClientHelpers.addObject(a[c],"tileMap1"),ClientHelpers.moveOutPlayer(),API.createObject(a[c]),API.addUnlockedItem(a[c].classID)},createNewCursorObject:function(a){var c=ige.$("tileMapEditor"),b,d,e,h,g;b=c.mouseToTile();ige.client.cursorObject=(new ige.newClassInstance(a.classId)).mount(c).layer(24);d=ige.client.cursorObject.xTiles;e=ige.client.cursorObject.yTiles;h=d;g=e;0===h%2&&
--h;0===g%2&&--g;b.x-=Math.floor(h/2);b.y-=Math.floor(g/2);0>b.x&&(b.x=0);0>b.y&&(b.y=0);b.x>ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles&&(b.x=ige.$("tileMapEditor").gridSize().x-ige.client.cursorObject.xTiles);b.y>ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles&&(b.y=ige.$("tileMapEditor").gridSize().y-ige.client.cursorObject.yTiles);ige.client.cursorObject.translateToTile(b.x+ige.client.cursorObject._tileAdjustX,b.y+ige.client.cursorObject._tileAdjustY);
ige.$("outlineEntity").translateToTile(b.x,b.y);ige.client.cursorObjectData=a;c.inGrid(b.x,b.y,d,e)?(a=!c.isTileOccupied(b.x,b.y,d,e),ige.client.cursorObject.opacity(a?1:.5),ige.$("outlineEntity").isFeasible=a):(ige.client.cursorObject.opacity(.5),ige.$("outlineEntity").isFeasible=!1);ige.client.cursorObject.data("tileWidth",d).data("tileHeight",e);ige.$("outlineEntity").tileWidth=d;ige.$("outlineEntity").tileHeight=e},isAssetInAtlas:function(a,c){for(var b=0;b<a.frames.length;b++)if(a.frames[b].filename===
c)return!0;return!1}});"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=Client);var LimitZoomPanComponent=IgeEventingClass.extend({classId:"LimitZoomPanComponent",componentId:"limitZoomPan",init:function(a,c){this._entity=a;var b=this;a.mousePan||this.log("Entity does not have mouse pan component...","error");a.camera||this.log("Entity does not have a camera (it's not a viewport?)","error");void 0!==c.boundsX&&void 0!==c.boundsY&&void 0!==c.boundsWidth&&void 0!==c.boundsHeight?this._options=c:this.log("Missing limit bounds parameters!","error");this._currentViewportScaleY=this._currentViewportScaleX=
1;this._oldScaleTo=a.camera.scaleTo;a.camera.scaleTo=function(a,c,h){b._currentViewportScaleX=a;b._currentViewportScaleY=c;b._limitZoomToWindow.call(b,b._entity);b._resizeEvent.call(b)};this._oldResizeEvent=a._resizeEvent;a._resizeEvent=function(a){b._oldResizeEvent.call(b._entity,a);b._resizeEvent.call(b)};this._resizeEvent()},_limitZoomToWindow:function(a){var c=this._currentViewportScaleX,b=this._currentViewportScaleY,d=a._bounds2d.x/c;a=a._bounds2d.y/b;this._entity._bounds2d.x>=this._entity._bounds2d.y&&
d>=this._options.boundsWidth&&(b=c=this._entity._bounds2d.x/this._options.boundsWidth);this._entity._bounds2d.y>this._entity._bounds2d.x&&a>=this._options.boundsHeight&&(c=b=this._entity._bounds2d.y/this._options.boundsHeight);this._oldScaleTo.call(this._entity.camera,c,b,0);this._currentViewportScaleX=c;this._currentViewportScaleY=b},_limitPanToWindow:function(a){var c=a.camera._translate.x,b=a.camera._translate.y;c<a.mousePan._limit.x&&(c=a.mousePan._limit.x);c>a.mousePan._limit.x+a.mousePan._limit.width&&
(c=a.mousePan._limit.x+a.mousePan._limit.width);b<a.mousePan._limit.y&&(b=a.mousePan._limit.y);b>a.mousePan._limit.y+a.mousePan._limit.height&&(b=a.mousePan._limit.y+a.mousePan._limit.height);a.camera.translateTo(c,b,0)},_resizeEvent:function(){var a=this._entity,c=a._bounds2d.x/this._currentViewportScaleX,b=a._bounds2d.y/this._currentViewportScaleY;a.mousePan.limit(new IgeRect(-(this._options.boundsWidth-c)/2+this._options.boundsX,-(this._options.boundsHeight-b)/2+this._options.boundsY,this._options.boundsWidth-
c,this._options.boundsHeight-b));this._limitZoomToWindow(a);this._limitPanToWindow(a)}});var PinchZoomComponent=IgeEventingClass.extend({classId:"PinchZoomComponent",componentId:"pinchZoom",init:function(a,c){var b=this;this._entity=a;this._enabled=!1;this._options={threshold:20,zoomSize:500,minScale:.25,maxScale:1};for(i in c)this._options[i]=c[i];this._entity.on("mouseDown",function(a){b._mouseDown(a)});this._entity.on("mouseMove",function(a){b._mouseMove(a)});this._entity.on("mouseUp",function(a){b._mouseUp(a)})},enabled:function(a){if(void 0===a)return this._enabled;this._enabled=
a;return this._entity},_mouseDown:function(a){a instanceof TouchEvent&&this._decideToZoom(a)},_mouseMove:function(a){a instanceof TouchEvent&&2==a.touches.length&&(newDistance=this._distanceBetweenTouches(a.touches[0],a.touches[1]),deltaDistance=newDistance-this._initialDistance,Math.abs(deltaDistance)>=this._options.threshold&&(newScale=this._initialScale+deltaDistance/this._options.zoomSize,newScale=Math.min(Math.max(newScale,this._options.minScale),this._options.maxScale),a=this._centerBetweenTouches(a.touches[0],
a.touches[1]),this._entity.scaleToPoint?this._entity.scaleToPoint.scaleTo(newScale,newScale,a.x,a.y):this._entity.camera.scaleTo(newScale,newScale,0),this._entity.limitZoomPan&&this._entity.limitZoomPan._limitPanToWindow(this._entity)))},_mouseUp:function(a){a instanceof TouchEvent&&this._decideToZoom(a)},_decideToZoom:function(a){2==a.touches.length?(this._entity.mousePan&&this._entity.mousePan.enabled(!1),this._initialDistance=this._distanceBetweenTouches(a.touches[0],a.touches[1]),this._initialScale=
this._entity.camera._scale.x):this._entity.mousePan&&this._entity.mousePan.enabled(!0)},_distanceBetweenTouches:function(a,c){return Math.sqrt(Math.pow(c.clientX-a.clientX,2)+Math.pow(c.clientY-a.clientY,2))},_centerBetweenTouches:function(a,c){return{x:(c.clientX+a.clientX)/2,y:(c.clientY+a.clientY)/2}}});var ScaleToPointComponent=IgeEventingClass.extend({classId:"ScaleToPointComponent",componentId:"scaleToPoint",init:function(a,c){this._entity=a},scaleTo:function(a,c,b,d){ige.input._updateMouseData({igeX:b,igeY:d});var e=this._entity.mousePosWorld();this._entity.camera.scaleTo(a,c,0);ige.input._updateMouseData({igeX:b,igeY:d});a=this._entity.mousePosWorld();this._entity.camera.translateBy(e.x-a.x,e.y-a.y,0)}});var ScrollZoomComponent=IgeEventingClass.extend({classId:"ScrollZoomComponent",componentId:"scrollZoom",init:function(a,c){var b=this;this._entity=a;this._enabled=!1;this.scrollScale=1;this._options={scaleMin:.25,scaleMax:1,scaleStep:.05};for(i in c)this._options[i]=c[i];ige.input.on("mouseWheel",function(a){b._handleMouseWheel(a)});document.getElementById("igeFrontBuffer").addEventListener("mousewheel",function(a){a.preventDefault();return!1},!1)},enabled:function(a){return void 0!==a?(this._enabled=
a,this._entity):this._enabled},_handleMouseWheel:function(a){if(this._enabled){var c=Math.round(this._entity.camera._scale.x/this._options.scaleStep)*this._options.scaleStep;0<a.wheelDelta?(c+=this._options.scaleStep,c>this._options.scaleMax&&(c=this._options.scaleMax)):0>a.wheelDelta&&(c-=this._options.scaleStep,c<this._options.scaleMin&&(c=this._options.scaleMin));this.scrollScale=c;this._entity.scaleToPoint?this._entity.scaleToPoint.scaleTo(c,c,a.igeX,a.igeY):this._entity.camera.scaleTo(c,c,0);
this._entity.limitZoomPan&&this._entity.limitZoomPan._limitPanToWindow(this._entity)}}});var TexturePackerAtlas=IgeTexture.extend({classId:"TexturePackerAtlas",IgeSpriteSheet:!0,init:function(a,c,b){this.dataurl=b;this.atlasName=a;this.atlasData=null;IgeTexture.prototype.init.call(this,c)},_loadImage:function(a){var c=this,b;"string"===typeof c.dataurl?ige.isClient?(b=document.createElement("script"),b.src=c.dataurl,b.onload=function(){c.log("Texture packer data loaded, waiting for image...");c.atlasData=eval(c.atlasName);IgeTexture.prototype._loadImage.call(c,a)},document.getElementsByTagName("head")[0].appendChild(b)):
(this.log("URL-based Tiled data is only available client-side. If you want to load Tiled map data on the server please include the map file in your ServerConfig.js file and then specify the map's data object instead of the URL.","error"),IgeTexture.prototype._loadImage.call(c,a)):(c.atlasData=c.dataurl,IgeTexture.prototype._loadImage.call(c,a))},_textureLoaded:function(){var a;if(this.image)for(this._sheetImage=this.image,a=this._processData(this.atlasData),i=0;i<a.length;i++)this._cells[i+1]=a[i],
this._checkModulus&&(this._cells[i][2]%2&&this.log("This texture's cell definition defines a cell width is not divisible by 2 which can cause the texture to use sub-pixel rendering resulting in a blurred image. This may also slow down the renderer on some browsers. Image file: "+this._url,"warning",cells[i]),_cells[i][3]%2&&this.log("This texture's cell definition defines a cell height is not divisible by 2 which can cause the texture to use sub-pixel rendering resulting in a blurred image. This may also slow down the renderer on some browsers. Image file: "+
this._url,"warning",cells[i]));else this.log("Cannot create cell-sheet because texture has not loaded an image!","error");IgeTexture.prototype._textureLoaded.call(this)},_processData:function(a){var c=[],b;for(b=0;b<a.frames.length;b++){var d=[];d[0]=a.frames[b].frame.x;d[1]=a.frames[b].frame.y;d[2]=a.frames[b].frame.w;d[3]=a.frames[b].frame.h;d[4]=a.frames[b].filename;c[b]=d}return c},cellCount:function(){return this._cells.length},cellIdToIndex:function(a){var c=this._cells,b;for(b=1;b<c.length;b++)if(c[b][4]===
a)return b;return-1},stringify:function(){return"new "+this.classId()+"('"+this.url()+"', "+this._cells.toString()+")"}});"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=TexturePackerAtlas);var GraphEditor=IgeSceneGraph.extend({classId:"GraphEditor",addGraph:function(a){a=ige.client;var c=ige.$("baseScene"),b=(new IgeScene2d).id("editorLevel").mount(c),d=(new IgeScene2d).layer(0).mount(b),c=(new IgeScene2d).id("objectSceneEditor").layer(1).mount(b);(new IgeScene2d).id("uiSceneEditor").layer(2).ignoreCamera(!0).mount(b);(new IgeEntity).layer(0).texture(a.textures.valleyBackground).dimensionsFromTexture().translateTo(0,0,0).mount(d);a=parseInt(1008/mapTileSize*gameScale);(new IgeTileMap2d).id("tileMapEditor").drawGrid(!0).mouseEventsActive(!0).isometricMounts(!0).tileWidth(mapTileSize).tileHeight(mapTileSize).gridSize(a,
a).drawGrid(!1).drawMouse(!1).drawMouseData(!1).translateTo(0,-640,0).highlightOccupied(!1).mount(c)},removeGraph:function(){ige.$("editorLevel").destroy()}});var mapTileSize=parseInt(GameConfig.config.mapTileSize),GraphLevel1=IgeSceneGraph.extend({classId:"GraphLevel1",addGraph:function(a){a=ige.client;var c=ige.$("baseScene"),b=(new IgeScene2d).id("level1").mount(c),d=(new IgeScene2d).id("backScene").layer(0).mount(b),c=(new IgeScene2d).id("objectScene").layer(1).mount(b);(new IgeScene2d).id("uiScene").layer(2).ignoreCamera(!0).mount(b);(new IgeEntity).id("background").layer(0).texture(a.textures.valleyBackground).dimensionsFromTexture().translateTo(0,
0,0).mount(d);a=parseInt(1008/mapTileSize*gameScale);(new IgeTileMap2d).id("tileMap1").drawGrid(!0).mouseEventsActive(!0).isometricMounts(!0).tileWidth(mapTileSize).tileHeight(mapTileSize).gridSize(a,a).drawGrid(!1).drawMouse(!1).drawMouseData(!1).translateTo(0,-640,0).highlightOccupied(!1).mount(c);(new IgeEntity).id("outlineEntity").isometric(!0).texture(ige.client.textures.outline).layer(30).mount(ige.$("tileMap1")).hide();ige.$("outlineEntity").isFeasible=!0},removeGraph:function(){ige.$("level1").destroy()}});var GraphTutorial=IgeSceneGraph.extend({classId:"GraphTutorial",addGraph:function(a){a=ige.client;var c=ige.$("baseScene"),b=(new IgeScene2d).id("tutorialLevel").mount(c),d=(new IgeScene2d).layer(0).mount(b),c=(new IgeScene2d).id("objectSceneTutorial").layer(1).mount(b);(new IgeScene2d).id("uiSceneTutorial").layer(2).ignoreCamera(!0).mount(b);(new IgeEntity).layer(0).texture(a.textures.valleyBackground).dimensionsFromTexture().translateTo(0,0,0).mount(d);a=parseInt(1008/mapTileSize*gameScale);(new IgeTileMap2d).id("tileMapTutorial").drawGrid(!0).mouseEventsActive(!0).isometricMounts(!0).tileWidth(mapTileSize).tileHeight(mapTileSize).gridSize(a,
a).drawGrid(!1).drawMouse(!1).drawMouseData(!1).translateTo(0,-640,0).highlightOccupied(!1).mount(c)},removeGraph:function(){ige.$("tutorialLevel").destroy()}});var GraphUi=IgeSceneGraph.extend({classId:"GraphUi",addGraph:function(a){a=ige.client;var c=ige.$("uiScene"),b=[{id:"marketDialog",image:"Shop"},{id:"goalDialog",image:"star"},{id:"cashBuyDialog",image:"Banknotes"},{id:"coinBuyDialog",image:"Coin1"},{id:"waterBuyDialog",image:"Water-48"}],d=(new MarketDialog).id("marketDialog").layer(1).hide().mount(c);GameObjects.setupMarket(d);(new CashDialog).id("cashDialog").layer(1).hide().mount(c);(new CoinDialog).id("coinDialog").layer(1).hide().mount(c);(new WaterDialog).id("waterDialog").layer(1).hide().mount(c);
(new BuyStatus).id("buyStatus").layer(1).hide().mount(c);$("#cashbarProgress").progressbar({max:1E5,value:0});$("#coinbarProgress").progressbar({max:1E6,value:0});$("#waterbarProgress").progressbar({max:1E6,value:0});"on"===GameConfig.config.xpFeature&&(d=(new IgeUiElement).id("xpBar").texture(ige.client.textures.xpBar).dimensionsFromTexture().left(325).mount(topNav),(new IgeUiProgressBar).id("xpProgress").barColor("#69f22f").min(0).max(500).progress(80).width(87).height(18).right(17).barText("",
" XP","black").mount(d));"on"===GameConfig.config.energyFeature&&(new IgeUiElement).id("energyBar").texture(ige.client.textures.energyBar).dimensionsFromTexture().left(475).mount(topNav);if(!0!==ige.client.isFirstLoadFinished)for(d=0;d<b.length;d++){var e=b[d];$("#"+e.id).dialog();$("#"+e.id).closest("div.ui-dialog").find("div.ui-dialog-titlebar").prepend("<img src='assets/textures/ui/"+e.image+".png' class='dialogTitleImage'>");$("#"+e.id).dialog("close")}$("#topToolbar").tooltip();$("#topToolbar").show();
$("#notifyIconContainer").show();$("#newGoalNotification").hide();$("#goalCompleteNotification").hide();$("#endMove").hide();$("#dropDownContent").html(DropDownMenu.dropDownContent);$(".c-menu__items").html(DropDownMenu.dropDownLinksList);for(d=0;d<DropDownMenu.links.length;d++)$("#"+DropDownMenu.links[d].id).html(DropDownMenu.links[d].string);"no-picture"===API.user.picture_url?$("#loginPicture").attr("src",DropDownMenu.offlinePictureURL):$("#loginPicture").attr("src",API.user.picture_url);"offline"===
API.loginStatus?($("#logoutLink").hide(),$("#shareMyVillageLink").hide()):($("#loginLink").hide(),$("#loginID").html(API.user.name));"false"===API.user.editor_enabled&&$("#editorLink").hide();(new IgeParticleEmitter).id("coinEmitter").layer(10).quantityTimespan(60).quantityBase(10).velocityVector(new IgePoint3d(0,-.03,0),new IgePoint3d(-.025,-.005,0),new IgePoint3d(.025,-.01,0)).linearForceVector(new IgePoint3d(0,.25,0),new IgePoint3d(0,0,0),new IgePoint3d(0,0,0)).scaleBaseX(2).scaleBaseY(2).deathScaleBaseX(2).deathScaleBaseY(2).deathRotateBase(0).deathRotateVariance(0,
360).deathOpacityBase(0).quantityMax(10).particle(CoinParticle).mount(c).top(20).left(380);a.slideRight=new Menu({wrapper:"#o-wrapper",type:"slide-right",menuOpenerClass:".c-button",maskId:"#c-mask"});this.addActions()},addActions:function(){function a(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||($("#fullscreenIcon img:first-child").show(),$("#fullscreenIcon img:nth-child(2)").hide())}var c=this;$("#dropDownIcon").on("click",function(){ige.client.fsm.enterState("playerMenu")});
$(".c-menu__close").on("click",function(){ige.client.fsm.enterState("select")});$(".c-mask").on("click",function(){ige.client.fsm.enterState("select")});document.addEventListener("fullscreenchange",a,!1);document.addEventListener("webkitfullscreenchange",a,!1);document.addEventListener("mozfullscreenchange",a,!1);$("#fullscreenIcon").on("click",function(){ga("send",  "Go fullscreen");$("#fullscreenIcon").find("img").toggle();$.FullScreen.isFullScreen()?$.FullScreen.cancelFullScreen():$("body").requestFullScreen()});
$("#fullscreenIcon").on("mouseover",function(){});$("#loginLink").on("click",function(){ga("send",  "Click login");ige.client.fsm.enterState("login")});$("#logoutLink").on("click",function(){ga("send",  "Logout");ige.client.fsm.enterState("logout")});$("#helpLink").on("click",function(){ige.client.fsm.enterState("tutorial")});$("#feedbackLink").on("click",function(){ige.client.fsm.enterState("feedbackDialog")});$("#editorLink").on("click",function(){ige.client.slideRight.close();ige.client.editorManager=
new EditorManager;ige.client.editorManager.gotoStep("init");ige.$("vp1").mousePan.enabled(!1).scrollZoom.enabled(!1).camera.translateTo(0,0,0).camera.scaleTo(1,1,0);ige.$("level1").hide();ige.addGraph("GraphEditor");ige.addGraph("GraphUiEditor");ige.client.fsm.enterState("editor")});$("#shareMyVillageLink").on("click",function(){ige.client.fsm.enterState("shareMyVillage")});vlg.isSFXOn?$("#toggleSFXLink").append("<span id='toggleSFXStatus'> - On</span>"):$("#toggleSFXLink").append("<span id='toggleSFXStatus'> - Off</span>");
$("#toggleSFXLink").on("click",function(){vlg.isSFXOn=!vlg.isSFXOn;vlg.isSFXOn?$("#toggleSFXStatus").html(" - On"):$("#toggleSFXStatus").html(" - Off")});vlg.isMusicOn?$("#toggleMusicLink").append("<span id='toggleMusicStatus'> - On</span>"):$("#toggleMusicLink").append("<span id='toggleMusicStatus'> - Off</span>");$("#toggleMusicLink").on("click",function(){vlg.isMusicOn=!vlg.isMusicOn;vlg.isMusicOn?$("#toggleMusicStatus").html(" - On"):$("#toggleMusicStatus").html(" - Off");toggleMusic()});$("#marketButton").click(function(){ga("send",  "Open market dialog");
c.toggleDialog("marketDialog")});$("#goalButton").click(function(){c.toggleGoalDialog()});$("#cashbar").click(function(){ga("send",  "Open cash dialog");c.toggleDialog("cashDialog")});$("#coinbar").click(function(){ga("send",  "Open coin dialog");c.toggleDialog("coinDialog")});$("#waterbar").click(function(){ga("send",  "Open water dialog");c.toggleDialog("waterDialog")});$("#moveButton").click(function(){ige.client.fsm.enterState("move")})},removeActions:function(){$("#dropDownIcon").unbind("click");
$(".c-menu__close").unbind("click");$(".c-mask").unbind("click");$("#fullscreenIcon").unbind("click");$("#loginLink").unbind("click");$("#logoutLink").unbind("click");$("#helpLink").unbind("click");$("#feedbackLink").unbind("click");$("#editorLink").unbind("click");$("#shareMyVillageLink").unbind("click");$("#toggleSFXLink").unbind("click");$("#toggleMusicLink").unbind("click");$("#marketButton").unbind("click");$("#goalButton").unbind("click");$("#cashbar").unbind("click");$("#coinbar").unbind("click");
$("#waterbar").unbind("click");$("#moveButton").unbind("click")},toggleDialog:function(a){ige.$(a).isVisible()?ige.$(a).closeMe():ige.$(a).show()},toggleGoalDialog:function(a){"goalDialog"===ige.client.fsm.currentStateName()?ige.client.fsm.enterState("select"):(ga("send",  "Open goal dialog"),$("#newGoalNotification").hide(),$("#goalCompleteNotification").hide(),ige.client.fsm.enterState("goalDialog",null,function(a){a||($("#goalDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!0,close:function(a,
c){ige.client.fsm.enterState("select")},width:"auto",height:"auto",modal:!0,autoOpen:!1}),$("#goalDialog").dialog("open"))}))},removeGraph:function(){this.removeActions()}});var GraphUiEditor=IgeSceneGraph.extend({classId:"GraphUiEditor",addGraph:function(a){a=ige.$("uiSceneEditor");a=(new EditorMarketDialog).id("editorMarketDialog").layer(1).hide().mount(a);EditorMarketDialog.prototype.isMarketSet||(EditorMarketDialog.prototype.isMarketSet=!0,GameObjects.setupEditorMarket(a));$("#editorTopNavBar").css("display","");$("#editorTopNavList").is(":empty")&&($("#editorTopNavList").append($('<li id="quitButtonEditor"/>').text("Quit"),$('<li id="saveButtonEditor"/>').text("Save"),
$('<li id="selectButtonEditor"/>').text("Select"),$('<li id="deleteButtonEditor"/>').text("Delete"),$('<li id="marketButtonEditor"/>').text("Build")),this.addActions())},addActions:function(){$("#quitButtonEditor").click(function(){ige.client.editorManager.gotoStep("closeEditor")});$("#saveButtonEditor").click(function(){ige.client.editorManager.saveVillageData()});$("#selectButtonEditor").click(function(){ige.client.fsm.enterState("editor")});$("#deleteButtonEditor").click(function(){ige.client.fsm.enterState("editorDelete")});
$("#marketButtonEditor").click(function(){ga("send",  "Open editor dialog");ige.$("editorMarketDialog").show()})},removeGraph:function(){ige.$("scene1").destroy()}});var GraphView=IgeSceneGraph.extend({classId:"GraphView",addGraph:function(a){a=ige.client;var c=ige.$("baseScene"),b=(new IgeScene2d).id("viewLevel").mount(c),d=(new IgeScene2d).layer(0).mount(b),c=(new IgeScene2d).id("objectSceneView").layer(1).mount(b);(new IgeScene2d).id("uiSceneView").layer(2).ignoreCamera(!0).mount(b);(new IgeEntity).layer(0).texture(a.textures.valleyBackground).dimensionsFromTexture().translateTo(0,0,0).mount(d);a=parseInt(1008/mapTileSize*gameScale);(new IgeTileMap2d).id("tileMapView").drawGrid(!0).mouseEventsActive(!0).isometricMounts(!0).tileWidth(mapTileSize).tileHeight(mapTileSize).gridSize(a,
a).drawGrid(!1).drawMouse(!1).drawMouseData(!1).translateTo(0,-640,0).highlightOccupied(!1).mount(c)},removeGraph:function(){ige.$("viewLevel").destroy()}});var Game=IgeClass.extend({classId:"Game",init:function(a,c){ige=new IgeEngine;ige.isClient&&(ige.client=new a);ige.isServer&&(ige.server=new a(c))}});if("undefined"!==typeof module&&"undefined"!==typeof module.exports)module.exports=Game;else var game=new Game(Client);var DropDownMenu={links:[]},getDropDownMenu=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",url:"/dropdownmenu",success:function(b){for(var c=0;c<b.length;c++)switch(b[c].Type){case "String":DropDownMenu.links.push({id:b[c].Key,string:b[c].Value});break;default:DropDownMenu[b[c].Key]=b[c].Value}a.resolve("ok")},error:function(d,e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var GameAssets={assets:{}},getGameAssets=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",method:"POST",data:{worksheet:"assets"},url:"/config",success:function(b){GameAssets.assets=b;a.resolve("ok")},error:function(d,e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var getGameCatalog=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"text",url:"/catalog",success:function(b){eval("(function(){"+b+"})();");a.resolve(b)},error:function(d,e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var GameConfig={config:{}},getGameConfig=function(a){a=a||1;$.ajax({async:!0,dataType:"json",method:"POST",url:"/config",success:function(a){GameConfig.config=a;for(var b in GameConfig.config)-1!==b.indexOf("String")&&(GameConfig.config[b]=GameConfig.config[b].replace(/\\n/g,"\n"));vlg.soundinit();a=document.createElement("script");b=document.getElementById("gameConfig").getAttribute("data-location");"localhost"===b?a.src="/ige/engine/loader.js":"deploy"===b&&(a.src="deploy/game.js");a.addEventListener("error",
function(){throw"ERROR LOADING loader/game.js - does it exist?";},!0);document.getElementsByTagName("head")[0].appendChild(a)},error:function(c,b,d){3===a?alert("Game does not load at the moment. Please try again later."):(a++,getGameConfig(a))}})};getGameConfig();var GameEarnings={earnings:{}},getGameEarnings=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",method:"POST",data:{worksheet:"earnings"},url:"/config",success:function(b){for(var c=0;c<b.length;c++){var d=b[c];GameEarnings.earnings[d.event]=GameEarnings.earnings[d.event]||[];GameEarnings.earnings[d.event].push({asset:d.asset,amount:d.amount})}a.resolve("ok")},error:function(d,e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var GameGoals={goals:[],settings:{},tasks:[]},getGameGoals=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",url:"/goals",success:function(b){GameGoals.goals=b.goals;GameGoals.settings=b.settings;GameGoals.tasks=b.tasks;a.resolve("ok")},error:function(d,e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var GameProblems={problems:[],problemsLookup:{},goalsLookup:{}},getGameProblems=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",url:"/problems",success:function(b){for(var c=0;c<b.length;c++){var d=b[c];GameProblems.problems.push({problemID:d.Problem_ID,title:d.Title,details:d.Details,goalID:d.Load_Goal_ID});GameProblems.problemsLookup[d.Problem_ID]=GameProblems.goalsLookup[d.Load_Goal_ID]=GameProblems.problems[GameProblems.problems.length-1]}a.resolve("ok")},error:function(d,
e,h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var NewsFeed=IgeEventingClass.extend({classId:"NewsFeed",init:function(){var a=this;$.ajax({url:"/newsFeed",dataType:"json",success:function(c){console.log("loaded newsFeed",c);a.feedNews(c)}})},feedNews:function(a){var c=[];$.each(a,function(a,d){console.log(d.news);c.push("<li>"+d.news+"</li>")});$("#newsList").html(c.join(""))}});var SpecialEvents={events:[]},getSpecialEvents=function(){var a=$.Deferred(),c;c=function(b){$.ajax({async:!0,dataType:"json",url:"/specialevents",success:function(b){for(var c=0;c<b.length;c++){var d=b[c];SpecialEvents.events[d.ID]={id:d.ID,displayName:d.DisplayName,description:d.Description,cost:d.Cost,time:d.Time,startCell:d.StartCell,endCell:d.EndCell,speedValue:d.SpeedValue,speedText:d.SpeedText,notifyIcon:d.NotifyIcon,notifyIconEasing:d.NotifyIconEasing}}a.resolve("ok")},error:function(d,e,
h){b===parseInt(GameConfig.config.URLRetryCount)?a.reject():(b++,c(b))}})};c(1);return a.promise()};var EditorManager=IgeEventingClass.extend({classId:"EditorManager",init:function(a){var c=this;ige.client.isEditorOn=!0;$(document).ajaxSend(function(a,c,e){"editor"===e.sentFrom&&($("#processingDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1}),$("#processingDialog").closest("div.ui-dialog").find("button.ui-dialog-titlebar-close").hide(),$("#processingDialog").dialog("open"),$("#processingContent").html("<div><p>Processing, please wait!</p><p><img src='assets/textures/ui/loading_spinner.gif'></p></div>"))});
$(document).ajaxError(function(a,c,e){"editor"===e.sentFrom&&($("#processingContent").html("<div><p>There was an error contacting the server!<br />Please try again later.</p><p><button id='closeProcessingDialog'>Close</button></p></div>"),$("#closeProcessingDialog").on("click",function(){$("#processingDialog").dialog("close")}))});$(document).ajaxSuccess(function(a,c,e){"editor"===e.sentFrom&&$("#processingDialog").dialog("close")});c.editorObjects=[];c.editorObjectsLookup={};c.isSaved=!1;c.dbRef=
null;c.villageID;c.villageSpreadsheetID="";c.villageTitle;c.villageOrganization;c.villageIsViewable;c.steps=[];c.currentStep="";c.editorViews=new EditorViews;c.steps.init={enter:function(){$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,d){c.gotoStep("closeEditor",{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("init").view);$("#newVillageButton").on("click",
function(){c.gotoStep("new")});$("#loadVillagesButton").on("click",function(){c.gotoStep("load")});$("#cancelEditorModeButton").on("click",function(){c.gotoStep("closeEditor",{forceQuit:!0})})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps["new"]={enter:function(){$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,d){c.gotoStep("closeEditor",
{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("new").view);$("#createNewVillageButton").on("click",function(){$("#newVillageTitle").val()?($("#newVillageErrorField").css("display","none"),c.villageID=ige.newIdHex(),c.villageTitle=$("#newVillageTitle").val(),c.villageOrganization=$("#newVillageOrganization").val(),c.villageIsViewable=$("#newVillageViewable").is(":checked"),c.createVillage(function(){c.gotoStep("editModeOn")})):$("#newVillageErrorField").css("display",
"")});$("#cancelCreateNewVillageButton").on("click",function(){c.gotoStep("init")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps.load={enter:function(){$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:800,height:500,modal:!0,autoOpen:!1,close:function(a,d){c.gotoStep("closeEditor",{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("load").view);
$.ajax({dataType:"json",url:"/api/get_villages",sentFrom:"editor",success:function(a){$.each(a,function(a,b){$("<tr>").append($("<td>").text(b.title),$("<td>").text(b.organization),$("<td>").append($("<button/>").text("Load").click(function(){c.loadVillageFromDB(b.village_id)})),$("<td>").append($("<button/>").text("Edit").click(function(){c.gotoStep("edit",{id:b.village_id,title:b.title,organization:b.organization,viewable:b.viewable})})),$("<td>").append($("<button/>").text("Delete").click(function(){c.gotoStep("delete",
{id:b.village_id,title:b.title})})),$("<td>").append($("<button/>").text("View").click(function(){window.open("/view/"+b.village_id,"_blank")})),$("<td>").append($("<button/>").text("Share").click(function(){c.gotoStep("share",{id:b.village_id,title:b.title})}))).appendTo("#loadedVillagesTable")})}});$("#cancelLoadVillageButton").on("click",function(){c.gotoStep("init")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps.edit={enter:function(a){var b,
e,h;$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,b){c.gotoStep("closeEditor",{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("edit").view);$("#editVillageTitle").val(a.title);$("#editVillageOrganization").val(a.organization);$("#editVillageViewable").prop("checked",a.viewable);$("#editVillageButton").on("click",function(){$("#editVillageTitle").val()?
($("#editVillageErrorField").css("display","none"),b=$("#editVillageTitle").val(),e=$("#editVillageOrganization").val(),h=$("#editVillageViewable").is(":checked"),c.editVillage({id:a.id,title:b,organization:e,viewable:h})):$("#editVillageErrorField").css("display","")});$("#cancelEditVillageButton").on("click",function(){c.gotoStep("load")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps["delete"]={enter:function(a){$("#editorDialog").dialog({resizable:!1,
draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,b){c.gotoStep("closeEditor",{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("warnBeforeDelete").view);$("#deleteVillageTitle").html(a.title);$("#yesDeleteButton").on("click",function(){$("#deleteVillageTitleInput").val()!==a.title?$("#deleteVillageErrorField").css("display",""):($("#deleteVillageErrorField").css("display",
"none"),c.deleteVillage(a.id))});$("#cancelDeleteButton").on("click",function(){c.gotoStep("load")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps.share={enter:function(a){$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,b){c.gotoStep("closeEditor",{forceQuit:!0})}});$("#editorDialog").dialog("open");$("#editorContent").html(c.editorViews.getViewByID("share").view);
$("#shareVillageTitle").html(a.title);var b=window.location.href.split("/"),b=b[0]+"//"+b[2];$("#shareTextArea").val(b+"/view/"+a.id);$("#copyClipboardButton").on("click",function(){$("#shareTextArea").select();try{var a=document.execCommand("copy");console.log("Copying text command was "+(a?"successful":"unsuccessful"));a||$("#shareVillageErrorField").css("display","")}catch(h){console.log("Oops, unable to copy"),$("#shareVillageErrorField").css("display","")}});$("#cancelShareButton").on("click",
function(){c.gotoStep("load")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps.closeEditor={enter:function(a){a&&a.forceQuit?c.closeEditor(!0):c.closeEditor()},exit:function(){}};c.steps.warnBeforeQuit={enter:function(){$("#editorDialog").dialog({resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:300,modal:!0,autoOpen:!1,close:function(a,d){c.gotoStep("editModeOn")}});$("#editorDialog").dialog("open");
$("#editorContent").html(c.editorViews.getViewByID("warnBeforeQuit").view);$("#yesWarningButton").on("click",function(){c.saveVillageData(function(){c.gotoStep("closeEditor",{forceQuit:!0})})});$("#noWarningButton").on("click",function(){c.gotoStep("closeEditor",{forceQuit:!0})});$("#cancelWarningButton").on("click",function(){c.gotoStep("editModeOn")})},exit:function(){$("#editorDialog").dialog({close:function(a,c){}});$("#editorDialog").dialog("close")}};c.steps.editModeOn={enter:function(){},exit:function(){}}},
gotoStep:function(a,c){""!==this.currentStep&&this.steps[this.currentStep].exit();this.currentStep=a;this.steps[a].enter(c)},createObject:function(a){var c=this.editorObjects.push(a);this.editorObjectsLookup[a.id]=this.editorObjects[c-1];this.isSaved=!1},deleteObject:function(a){this.editorObjects.splice(this.editorObjects.indexOf(this.editorObjectsLookup[a.id()]),1);this.isSaved=!1},updateObject:function(a,c,b){this.editorObjectsLookup[a.id()].x=c;this.editorObjectsLookup[a.id()].y=b;this.isSaved=
!1},loadVillageFromDB:function(a){var c=this;$.ajax({dataType:"json",url:"/api/village/"+a,sentFrom:"editor",success:function(b){for(var d=0;d<b.data.length;d++)ClientHelpers.addObject(b.data[d],"tileMapEditor"),c.createObject(b.data[d]);c.villageID=a;c.villageTitle=b.title;c.villageOrganization=b.organization;c.villageIsViewable=b.viewable;c.gotoStep("editModeOn");c.isSaved=!0;dataLayer.push({event:"loadVillage"});history.replaceState({villageID:a},"load_village","?v="+a)}})},editVillage:function(a){var c=
this;$.ajax({dataType:"json",contentType:"application/json; charset=utf-8",sentFrom:"editor",method:"PUT",data:JSON.stringify({title:a.title,organization:a.organization,viewable:a.viewable}),url:"/api/village/"+a.id,success:function(a){dataLayer.push({event:"editVillage"});c.gotoStep("init")}})},deleteVillage:function(a){var c=this;$.ajax({type:"DELETE",url:"/api/village/"+a,sentFrom:"editor",success:function(a){dataLayer.push({event:"deleteVillage"});c.gotoStep("init")}})},createVillage:function(a){var c=
this;$.ajax({dataType:"json",contentType:"application/json; charset=utf-8",sentFrom:"editor",method:"POST",data:JSON.stringify({mode:"new",title:c.villageTitle,organization:c.villageOrganization,viewable:c.villageIsViewable}),url:"/api/village/"+c.villageID,success:function(b){dataLayer.push({event:"createVillage"});c.isSaved=!0;a&&a()}})},saveVillageData:function(a){var c=this;$.ajax({dataType:"json",contentType:"application/json; charset=utf-8",sentFrom:"editor",method:"POST",data:JSON.stringify({mode:"data",
title:c.villageTitle,data:c.editorObjects}),url:"/api/village/"+c.villageID,success:function(b){dataLayer.push({event:"saveVillage"});c.isSaved=!0;a&&a()}})},closeEditor:function(a){this.isSaved||a?(ige.client.isEditorOn=!1,ige.$("level1").show(),ige.$("outlineEntity").hide(),ige.$("outlineEntity").unMount(),ige.$("outlineEntity").mount(ige.$("tileMap1")),ige.removeGraph("GraphEditor"),ige.client.data("moveItem")&&ige.client.data("moveItem",""),$("#editorTopNavBar").css("display","none"),$("#topToolbar").show(),
$("#notifyIconContainer").show(),history.replaceState({villageID:API.user.key_id},"load_village","?v="+API.user.key_id),ige.client.fsm.enterState("select")):this.gotoStep("warnBeforeQuit")}});var EventEmitter=IgeEventingClass.extend({classId:"EventEmitter",init:function(){}});var GameLogic=IgeObject.extend({classId:"GameLogic",init:function(){IgeObject.prototype.init.call(this);var a=this,c,b=ige.$("marketDialog");a.queueManager=new QueueManager;a.loginManager=new LoginManager;for(var d in API.state.objects){var e=API.state.objects[d];c=GameObjects.catalogLookup[e.name];c.enabled&&a.unlockMarketDialogItem(b.getItemByID(e.name));"none"!==c.unlocks&&GameObjects.catalogLookup[c.unlocks].enabled&&a.unlockMarketDialogItem(b.getItemByID(c.unlocks))}for(d in API.state.unlockedItems)c=
b.getItemByID(API.state.unlockedItems[d]),this.unlockMarketDialogItem(c);for(d in API.state.objects)e=API.state.objects[d],e.buildCompleted&&function(a){setTimeout(function(){ige.$(a.id).notifySpecialEvent()},100)}(e);a.problemManager=new ProblemManager;a.goals=new Goals;$("#goalDialogContent").html("<p style='text-align:center;'>"+GameConfig.config.noActiveGoalString+"</p>");$("#goalDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!0,title:"Goals",close:function(a,b){ige.client.fsm.enterState("select")},
width:"auto",height:"auto",modal:!0,autoOpen:!1});a.goals.on("goalLoaded",function(a){var b=[],c=a.gameGoalObj.goalReward.split(","),d;$.each(a.gameGoalObj.tasks,function(a,c){var d="";"__"===c.targetOBJ.substr(0,2)&&(d=c.targetOBJ.substr(2),d=GameObjects.catalogLookup[d],$("<div class='goalTaskImage'></div>").hide().appendTo("body").remove(),d="<span class='goalTaskImage'><img class='goalTaskImage' src='"+d.iconUrl+"' /></span>");b.push("<li>"+d+" <span class='goalTaskTitle'>"+c.title+"</span><div class='goalTaskPercent' id='task"+
c.taskID+"' ><div class='progressLabel' id='taskLabel"+c.taskID+"'></div></div></li>")});$("#goalDialogContent").html("<div class='goalDialogInfo'>Solves:"+GameProblems.problemsLookup[API.state.currentProblemID].title+"<span class='problemDetails'><img class='problemDetailsIcon' src='/assets/textures/ui/Info-50.png'></span></div>");d=$("#goalDialogContent").find(".problemDetails").first();d.attr("title",GameProblems.problemsLookup[API.state.currentProblemID].details);d.tooltip({position:{my:"right center",
at:"left center"}});$("#goalDialogContent").append("<ul id='taskList'>"+b.join("")+"</ul>");$.each(a.gameGoalObj.tasks,function(a,b){var c=$("#task"+b.taskID),d=$("#taskLabel"+b.taskID);$("#task"+b.taskID).progressbar({value:!1,change:function(){d.text(c.data("currentValue")+"/"+b.totalValue)},complete:function(){d.text("Complete!")}});$("#task"+b.taskID).data("currentValue",b.currentValue);$("#task"+b.taskID).progressbar("value",b.percent)});for(var e=0;e<c.length;e++)d=c[e].split(":"),c[e]=d.reverse().join("");
$("#goalDialogContent").append("<hr><div class='goalDialogInfo'>Rewards:"+c+"</div>");API.stateGoalsLookup[a.id].isComplete&&!API.stateGoalsLookup[a.id].isRewardsCollected&&($("#goalDialogContent").append("<div class='goalDialogInfo'><button id='collectRewardsGoal"+a.id+"'>Collect Rewards</button></div>"),$("#collectRewardsGoal"+a.id).click(function(){$("#goalCompleteNotification").hide();ige.client.eventEmitter.emit("collectRewards",{goalID:a.id,title:a.gameGoalObj.goalTitle,message:a.gameGoalObj.goalMessage,
reward:a.gameGoalObj.goalReward})}),$("#goalCompleteNotification").show(GameConfig.config.goalCompleteEffect,parseInt(GameConfig.config.goalCompleteEffectDuration)));$("#goalDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!0,title:a.gameGoalObj.goalTitle,close:function(a,b){ige.client.fsm.enterState("select")},width:"auto",height:"auto",modal:!0,autoOpen:!1});a.isNewGoal&&$("#newGoalNotification").show(GameConfig.config.newGoalEffect,parseInt(GameConfig.config.newGoalEffectDuration))});a.goals.on("goalComplete",
function(a){dataLayer.push({event:"goalComplete"});API.setGoalAsComplete(a.goalID);$("#goalDialogContent").append("<div class='goalDialogInfo'><button id='collectRewardsGoal"+a.goalID+"'>Collect Rewards</button></div>");$("#collectRewardsGoal"+a.goalID).click(function(){$("#goalCompleteNotification").hide();ige.client.eventEmitter.emit("collectRewards",a)});$("#goalCompleteNotification").show(GameConfig.config.goalCompleteEffect,parseInt(GameConfig.config.goalCompleteEffectDuration))});ige.client.eventEmitter.on("collectRewards",
function(b){for(var c=b.reward.split(","),d={},e,h=0;h<c.length;h++)e=c[h].split(":"),d[e[0]]=e[1];var c=-75*(Object.keys(d).length-1)/2-75,x;for(x in d)c+=75,a.rewardMechanism.claimReward(x,d[x],{x:-ige.$("uiScene")._renderPos.x+c,y:200,z:0});API.setGoalRewardsAsCollected(b.goalID);ige.client.gameLogic.queueManager.addNewAction("loadNextProblem",function(){var a=ige.client.gameLogic.goals.getGoal(b.goalID).Load_Problem_On_Complete;"None"!==a&&"none"!==a&&""!==a&&null!==a&&void 0!==a&&(ige.client.gameLogic.problemManager.showProblem(a),
API.state.currentProblemID=a,API.setProblemAsShown(a))});ige.client.fsm.enterState("goalDialog",null,function(a){a||($("#goalDialogContent").html("<p style='text-align:center;'>"+b.message+"</p>"),$("#goalDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!0,title:b.title,close:function(a,b){ige.client.fsm.enterState("select")},width:"auto",height:"auto",modal:!0,autoOpen:!1}),$("#goalDialog").dialog("open"))})});a.goals.on("eventComplete",function(a){a=a.item;API.updateGoal(API.state.currentGoalID,
a.taskID,a._eventCount);$("#task"+a.taskID).data("currentValue",a._eventCount);$("#task"+a.taskID).progressbar("value",Math.floor(100*a._eventCount/a.count))});ige.client.eventEmitter.on("showMessage",function(a){ige.client.fsm.enterState("showMessage",a,null)});ige.client.eventEmitter.on("loadGoal",function(b){a.goals.loadGoal(b.goalID)});ige.client.eventEmitter.on("executePendingAction",function(){a.queueManager.isAnyActionPending()&&a.queueManager.callNextPendingAction()});if(API.state.goals&&
!API.state.problems)for(c=API.state.goals.map(function(a){return a.goalID}),d=0;d<c.length;d++)API.setProblemAsShown(a.problemManager.getProblemIDbyGoalID(c[d]));if(!API.state.goals)API.state.problems?a.goals.loadGoal(a.problemManager.getGoalIDbyProblemID(API.state.currentProblemID)):a.queueManager.addNewAction("loadNextProblem",function(){var b=GameConfig.config.firstProblemID;a.problemManager.showProblem(b);API.state.currentProblemID=b;API.setProblemAsShown(b)});else if(API.state.currentGoalID)if(c=
API.state.currentGoalID,API.stateGoalsLookup[c].isComplete&&API.stateGoalsLookup[c].isRewardsCollected)d=a.goals.getGoal(API.state.currentGoalID).Load_Problem_On_Complete,"None"!==d&&"none"!==d&&""!==d&&null!==d&&void 0!==d&&(a.problemManager.showProblem(d),API.state.currentProblemID=d,API.setProblemAsShown(d));else{if(!API.state.currentProblemID)for(d in GameProblems.goalsLookup)if(d===API.state.currentGoalID){API.state.currentProblemID=GameProblems.goalsLookup[d].problemID;API.saveState();break}a.goals.loadGoal(c,
API.stateGoalsLookup[c])}a.rewardMechanism=new RewardMechanism;for(e in GameEarnings.earnings)for(c=GameEarnings.earnings[e],d=0;d<c.length;d++)(function(b,c){ige.client.eventEmitter.on(e,function(d){var e=null;if(d.positionX||d.positionY)e={},e.x=d.positionX||0,e.y=d.positionY||0,e.z=0;a.rewardMechanism.claimReward(c[b].asset,c[b].amount,e,d.itemRef)})})(d,c);ige.client.eventEmitter.on("build",function(c){var d=GameObjects.catalogLookup[c.unlocks];d&&d.enabled&&"none"!==d.dependency&&null===API.getUnlockedItem(c.unlocks)?
(a.unlockMarketDialogItem(b.getItemByID(c.unlocks)),c.callback(),a.showUnlockedItemMessage(c.unlocks)):(c.callback(),ige.client.fsm.enterState("select"))});"reloadGame"===ige.client.fsm.currentStateName()&&ige.client.fsm.enterState("select")},unlockMarketDialogItem:function(a){var c=ige.$("marketDialog");c.removeItemCover(a);c.bindItemAction(a);API.addUnlockedItem(a.id)},showUnlockedItemMessage:function(a){var c;c=GameObjects.catalogLookup[a];a=GameConfig.config.itemUnlockMessageString;a=a.replace("{itemName}",
c.name);ige.client.eventEmitter.emit("showMessage",{title:GameConfig.config.itemUnlockTitleString,message:"<img class='messageDialogUnlockImage' src='"+c.iconUrl+"'>"+("<span class='messageDialogUnlockSpan'>"+a+"</span>")})}});var Goals=IgeEventingClass.extend({classId:"Goals",init:function(a){this.igeQuests={}},createGoal:function(a,c){var b=this,d,e=[],h=[],g=[],p={},q=b.getGoal(a);if(c&&c.tasks)for(var t=0;t<c.tasks.length;t++)e[c.tasks[t].taskID]=c.tasks[t];p.goalTitle=q.Title;p.goalMessage=q.Congrats_Message;p.goalReward=q.Reward;p.tasks=[];d=new IgeQuest;for(var g=q.Tasks.split(","),x=function(a){return{taskID:g[t],count:parseInt(a.Task_Value),emitter:ige.client.eventEmitter,eventName:a.Task_Event,eventEvaluate:function(f){if("*"===
a.Target_Object||"__"===a.Target_Object.substr(0,2)&&a.Target_Object.substr(2)===f.id||a.Target_Object===f.type)return!0}}},t=0;t<g.length;t++){var w=b.getTask(g[t]),G=0,k=0;e[g[t]]&&(G=e[g[t]].value,k=Math.floor(100*e[g[t]].value/w.Task_Value));p.tasks.push({taskID:g[t],targetOBJ:w.Target_Object,title:w.Title,currentValue:G,totalValue:w.Task_Value,percent:k});e[g[t]]&&e[g[t]].value===parseInt(w.Task_Value)||(w=new x(w),h.push(w))}d.items(h).complete(function(){b.emitGoalAsComplete(a,q.Title,q.Congrats_Message,
q.Reward)}).start();for(t=0;t<g.length;t++)e[g[t]]&&(h=d._items.map(function(a){return a.taskID}).indexOf(g[t]),-1!==h&&(d._items[h]._eventCount=e[g[t]].value,d._eventCompleteCount+=e[g[t]].value));d.on("itemComplete",function(a){b.emit("itemComplete",{item:a})});d.on("eventComplete",function(a){b.emit("eventComplete",{item:a})});b.igeQuests[a]=d;return p},emitGoalAsComplete:function(a,c,b,d){this.emit("goalComplete",{goalID:a,title:c,message:b,reward:d})},loadGoal:function(a,c){var b=this.createGoal(a,
c),d=!0;c?d=!1:API.createGoal(a);this.emit("goalLoaded",{id:a,gameGoalObj:b,isNewGoal:d})},loadNextGoal:function(a){var c=this.getNextGoalID(a),b;c&&(b=this.createGoal(c),API.createGoal(c),this.emit("goalLoaded",{id:a,gameGoalObj:b,isNewGoal:!0}))},getTask:function(a){a=GameGoals.tasks.map(function(a){return a.Task_ID}).indexOf(a);return GameGoals.tasks[a]},getGoal:function(a){a=GameGoals.goals.map(function(a){return a.Goal_ID}).indexOf(a);return GameGoals.goals[a]},getNextGoalID:function(a){a=GameGoals.goals.map(function(a){return a.Goal_ID}).indexOf(a);
return GameGoals.goals[a+1]?GameGoals.goals[a+1].Goal_ID:null}});var LoginManager=IgeEventingClass.extend({classId:"LoginManager",init:function(a){window.signInCallback=function(a){a.code?$.ajax({url:"/api/login",contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify({code:a.code}),error:function(a,c,e){401===a.status?$("#processingContent").html("<div><p>Not authorized to log in!</p><p><button id='closeProcessingDialog'>Close</button></p></div>"):$("#processingContent").html("<div><p>There was an error contacting the server!<br />Please try again later.</p><p><button id='closeProcessingDialog'>Close</button></p></div>");
$("#closeProcessingDialog").on("click",function(){$("#processingDialog").dialog("close")})},success:function(a){dataLayer.push({userEmail:a.email});dataLayer.push({event:"userLogin"});ige.client.fsm.enterState("reloadGame")},processData:!1}):($("#processingContent").html("<div><p>There was an error contacting the server!<br />Please try again later.</p><p><button id='closeProcessingDialog'>Close</button></p></div>"),$("#closeProcessingDialog").on("click",function(){$("#processingDialog").dialog("close")}))};
gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:GameConfig.config.clientID,scope:"https://www.googleapis.com/auth/groups https://www.googleapis.com/auth/plus.me"})})},login:function(){auth2.grantOfflineAccess({redirect_uri:"postmessage"}).then(signInCallback)},logout:function(){auth2.signOut().then(function(){$.ajax({url:"/api/logout",error:function(a,c,b){$("#processingContent").html("<div><p>There was an error contacting the server!<br />Please try again later.</p><p><button id='closeProcessingDialog'>Close</button></p></div>");
$("#closeProcessingDialog").on("click",function(){$("#processingDialog").dialog("close")})},success:function(a){dataLayer.push({event:"userLogout"});ige.client.fsm.enterState("reloadGame")}})})}});var ProblemManager=IgeEventingClass.extend({classId:"ProblemManager",init:function(){this.currentProblemID},showProblem:function(a){ige.client.eventEmitter.emit("showMessage",{title:GameProblems.problemsLookup[a].title,message:GameProblems.problemsLookup[a].details,callback:function(){ige.client.eventEmitter.emit("loadGoal",{goalID:GameProblems.problemsLookup[a].goalID})}})},getGoalIDbyProblemID:function(a){return GameProblems.problemsLookup[a].goalID},getProblemIDbyGoalID:function(a){return GameProblems.goalsLookup[a].problemID}});var QueueManager=IgeEventingClass.extend({classId:"QueueManager",init:function(){this.queue=[]},addNewAction:function(a,c){this.queue.push({actionID:a,callback:c})},callNextPendingAction:function(){this.queue[0]&&(this.queue[0].callback(),this.queue.shift())},callActionbyID:function(a){var c=this.queue.map(function(a){return a.actionID}).indexOf(a);-1!==c?this.queue[c].callback():vlg.log.debug("cannot find any action for this ID: ",a)},isAnyActionPending:function(){return 0<this.queue.length?!0:!1}});var RewardMechanism=IgeEventingClass.extend({classId:"RewardMechanism",init:function(){var a=JSON.parse(GameConfig.config.rewardMechanismTextureList);this.uiScene=ige.$("uiScene");this.textureListLookup={};for(var c=0;c<a.length;c++)this.textureListLookup[a[c].name]=a[c]},claimReward:function(a,c,b,d){var e=this;_translateObj=b||{x:-e.uiScene._renderPos.x,y:-e.uiScene._renderPos.y,z:0};_translateObj.x+=e.uiScene._renderPos.x;_translateObj.y+=e.uiScene._renderPos.y;switch(a){case "coins":API.addCoins(parseInt(c));
break;case "cash":API.addCash(parseInt(c));break;case "water":API.addWater(parseInt(c))}e.showVillageDashFont(e.textureListLookup[a].mount,c,parseInt(e.textureListLookup[a].fontAnchorX),parseInt(e.textureListLookup[a].fontAnchorY));var h=(new AssetAnimation(a,e.textureListLookup[a].texture,e.textureListLookup[a].mount)).drawBounds(!0).width(50).height(60).translateTo(_translateObj.x,_translateObj.y,_translateObj.z).mount(e.uiScene);h.update=function(){AssetAnimation.prototype.update.call(this);null!==
d&&void 0!==d&&this.translateTo(d.screenPosition().x+e.uiScene._renderPos.x,d.screenPosition().y+e.uiScene._renderPos.y,_translateObj.z)};new IgeTimeout(function(){h.gotoTopNavBar()},1E3*parseInt(GameConfig.config.assetAnimationTimerDuration));h.mouseOver(function(){h.gotoTopNavBar()})},showVillageDashFont:function(a,c,b,d){var e=(new IgeFontEntity).texture(ige.client.textures.villagedashFont).text(c).width(200).translateTo(ige.$("uiScene")._renderPos.x+$("#"+a).position().left+b,ige.$("uiScene")._renderPos.y+
d,0).mount(ige.$("uiScene"));e._translate.tween().stepTo({y:ige.$("uiScene")._renderPos.y+50},500,"inOutSine").start();e.tween().properties({_opacity:0}).duration(2E3).afterTween(function(){e.destroy()}).start()}});var Tutorial=IgeEventingClass.extend({classId:"Tutorial",init:function(){var a=this,c=ige.$("tileMapTutorial");a.steps=[];a.currentStep="";a.currentBuildStep=1;a.currentGoalStep=1;a.isMoneyAdded=!1;a.tutorialViews=new TutorialViews;a.marketItems=$("<ul></ul>");a.tutorialObjects=[];a.tutorialArrow=$("<span id='tutorialArrowSpan'></span>").appendTo("#hudcontainer").insertAfter("#topToolbarTutorial");$("#tutorialArrowSpan").hide();a.tutorialArrow.image=$("<img id='tutorialArrowImage' src='"+ige.client.textures.tutorialArrow.url()+
"'>").appendTo("#tutorialArrowSpan").rotate({angle:40});a.skipButton=$("<span id='skipTutorial'>"+GameConfig.config.skipTutorialString+"</span>").appendTo("#hudcontainer").position({my:"right bottom",at:"right bottom",of:window}).click(function(){ga("send",  "Skip tutorial");a.gotoStep("finishTutorial")});a.skipButton.css("left",a.skipButton.position().left-40+"px");a.skipButton.css("top",a.skipButton.position().top-40+"px");a.items={item1:{name:GameConfig.config.tutorialItem1,mapX:15,mapY:5,marketX:-200,
marketY:-100},item2:{name:GameConfig.config.tutorialItem2,mapX:8,mapY:13,marketX:0,marketY:-100},item3:{name:GameConfig.config.tutorialItem3,mapX:8,mapY:18,marketX:200,marketY:-100},item4:{name:GameConfig.config.tutorialItem4,mapX:26,mapY:18,marketX:-200,marketY:100}};a.steps.initialStep={enter:function(){$("#tutorialDialog").dialog({appendTo:"#hudcontainer",resizable:!1,draggable:!0,dialogClass:"ui-dialog-no-titlebar",closeOnEscape:!1,width:500,height:"auto",modal:!1,autoOpen:!1,create:function(){$(this).closest("div.ui-dialog").find("button.ui-dialog-titlebar-close").click(function(b){a.gotoStep("finishTutorial");
b.preventDefault()})}});$("#tutorialDialog").dialog("open");$("#tutorialContent").html(a.tutorialViews.getViewByID("welcomeScreen").view);$("#dialogButton").on("click",function(){a.gotoStep("showmarketButton")})},exit:function(){$("#tutorialDialog").dialog("close")}};a.steps.showmarketButton={enter:function(){$("#marketButtonTutorial").show().click(function(){a.gotoStep("showMarketDialog")});a.setTutorialArrow("#hudcontainer","#marketButtonTutorial",40,"marginTop")},exit:function(){$("#marketButtonTutorial").unbind("click")}};
a.steps.showMarketDialog={enter:function(){var b,c,e,h,g;$("#tutorialDialog").dialog("open");b=a.items["item"+a.currentBuildStep].name;void 0===a.marketItems.find("#tutorialMarket"+b)[0]&&(a.newItem=$("<li class='tutorialMarketDialogItem' id='tutorialMarket"+b+"'></li>"),a.newItem.append($("<span class='tutorialMarketImage'></span>")),c=GameObjects.catalogLookup[b],e=$("<div class='tutorialMarketImage'></div>").hide().appendTo("body"),g=e.css("height").substr(0,e.css("height").indexOf("px")),h=ige.client.textures[b]._sizeX/
(ige.client.textures[b]._sizeY/g),e.remove(),a.newItem.find(".tutorialMarketImage").first().css("background-image","url("+c.textureUrl+")").css("width",h/ige.client.textures[b]._cellColumns+"px").css("background-size",h+"px "+g+"px").css("background-position-x",h/ige.client.textures[b]._cellColumns+"px"),a.marketItems.append(a.newItem));$("#tutorialContent").html(a.marketItems);$("#tutorialMarket"+a.items["item"+a.currentBuildStep].name).click(function(){a.gotoStep("placeHouse")});a.setTutorialArrow("body",
"#tutorialMarket"+a.items["item"+a.currentBuildStep].name,130,"marginLeft")},exit:function(){$("#tutorialDialog").dialog("close");a.newItem.unbind("click")}};a.steps.placeHouse={enter:function(){var b,d,e=GameObjects.catalogLookup[a.items["item"+a.currentBuildStep].name];$("#tutorialArrowSpan").hide();c.drawGrid(!0);c.highlightOccupied(!0);a.mapItemButton=(new ige.newClassInstance(a.items["item"+a.currentBuildStep].name)).id("tutorialTilemapItem2"+a.currentBuildStep).layer(1).mount(c).cell(e.cell).mouseOver(function(){}).mouseOut(function(){}).mouseMove(function(){}).mouseUp(function(){a.gotoStep("showSpeedProgressInfo")});
a.mapItemButton.translateToTile(a.items["item"+a.currentBuildStep].mapX+a.mapItemButton._tileAdjustX,a.items["item"+a.currentBuildStep].mapY+a.mapItemButton._tileAdjustY);b=a.mapItemButton.xTiles;d=a.mapItemButton.yTiles;b={id:ige.newIdHex(),classID:e.id,x:a.items["item"+a.currentBuildStep].mapX,y:a.items["item"+a.currentBuildStep].mapY,w:b,h:d,name:a.items["item"+a.currentBuildStep].name,buildStarted:Date.now(),buildCompleted:Date.now()};a.tutorialObjects.push(b);new IgeTimeout(function(){$("#tutorialArrowSpan").css("top",
a.mapItemButton.screenPosition().y);$("#tutorialArrowSpan").css("left",a.mapItemButton.screenPosition().x-100);$("#tutorialArrowSpan").show()},100)},exit:function(){var b=GameObjects.catalogLookup[a.items["item"+a.currentBuildStep].name];c.drawGrid(!1);c.highlightOccupied(!0);a.mapItemButton.cell(1).mouseUp(function(){});a.mapItemButton.buildProgressBar=(new IgeUiProgressBar).barBackColor("#f2b982").barColor("#69f22f").barBorderColor("#3a9bc5").min(0).max(100).progress(0).width(50).height(10).translateTo(0,
-40,0).mount(a.mapItemButton);a.mapItemButton.buildProgressTime=(new IgeFontEntity).colorOverlay("white").nativeFont(GameConfig.config.gameFont).nativeStroke(4).nativeStrokeColor("#000000").width(200).height(100).mount(a.mapItemButton).translateTo(0,-60,0).text(b.buildTime)}};a.steps.showSpeedProgressInfo={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialArrowSpan").hide();$("#tutorialContent").html(a.tutorialViews.getViewByID("speedProgressInfoScreen").view);$("#dialogButton").on("click",
function(){$("#tutorialDialog").dialog("close");a.gotoStep("buildHouse")})},exit:function(){a.mapItemButton.buildProgressBar.unMount();a.mapItemButton.buildProgressTime.unMount();a.mapItemButton.mouseUp(function(){});a.mapItemButton.destroy();a.mapItemButton=null}};a.steps.showSpeedProgress={enter:function(){var b=GameObjects.catalogLookup[a.items["item"+a.currentBuildStep].name];$("#tutorialDialog").dialog("open");$("#tutorialArrowSpan").hide();$("#tutorialContent").html(a.tutorialViews.getViewByID("speedProgressScreen").view);
4===a.currentBuildStep?$("#tutorialContent div p").append(" for "+b.buildTimeSpeedValue+" VBuck"+(1<b.buildTimeSpeedValue?"s":"")):$("#tutorialContent div p").append(" for FREE");$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");4!==a.currentBuildStep||a.isMoneyAdded?(4===a.currentBuildStep&&a.isMoneyAdded&&($("#cashbarProgressTutorial").progressbar("value",$("#cashbarProgressTutorial").text()-b.buildTimeSpeedValue),$("#cashbarProgressTutorial").text($("#cashbarProgressTutorial").text()-
b.buildTimeSpeedValue)),a.gotoStep("HouseIsBuilt")):a.gotoStep("showPaymentInfo")})},exit:function(){}};a.steps.buildHouse={enter:function(){var b=GameObjects.catalogLookup[a.items["item"+a.currentBuildStep].name];$("#tutorialArrowSpan").show();ige.$("tutorialTilemapItem"+a.currentBuildStep)&&(a.mapItemButton.destroy(),a.mapItemButton=null);a.mapItemButton=(new ige.newClassInstance(a.items["item"+a.currentBuildStep].name)).id("tutorialTilemapItem"+a.currentBuildStep).layer(1).mount(c).cell(1).mouseOver(function(){}).mouseOut(function(){}).mouseMove(function(){}).mouseUp(function(){a.gotoStep("showSpeedProgress")});
a.mapItemButton.translateToTile(a.items["item"+a.currentBuildStep].mapX+a.mapItemButton._tileAdjustX,a.items["item"+a.currentBuildStep].mapY+a.mapItemButton._tileAdjustY);a.mapItemButton.buildProgressBar=(new IgeUiProgressBar).barBackColor("#f2b982").barColor("#69f22f").barBorderColor("#3a9bc5").min(0).max(100).progress(0).width(50).height(10).translateTo(0,-40,0).mount(a.mapItemButton);a.mapItemButton.buildProgressTime=(new IgeFontEntity).colorOverlay("white").nativeFont(GameConfig.config.gameFont).nativeStroke(4).nativeStrokeColor("#000000").width(200).height(100).mount(a.mapItemButton).translateTo(0,
-60,0).text(b.buildTime);$("#tutorialArrowSpan").css("top",a.mapItemButton.screenPosition().y+ige.$("tileMapTutorial")._renderPos.y);$("#tutorialArrowSpan").css("left",a.mapItemButton.screenPosition().x-100)},exit:function(){a.mapItemButton.mouseUp(function(){})}};a.steps.HouseIsBuilt={enter:function(){a.mapItemButton.cell(GameObjects.catalogLookup[a.items["item"+a.currentBuildStep].name].cell);a.mapItemButton.buildProgressBar.unMount();a.mapItemButton.buildProgressTime.unMount();a.mapItemButton.mouseUp(function(){});
switch(a.currentBuildStep){case 1:$("#tutorialArrowSpan").hide();$("#tutorialDialog").dialog("open");$("#tutorialContent").html(a.tutorialViews.getViewByID("firstHomeBuiltScreen").view);$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showGoalButton")});break;case 2:a.gotoStep("showmarketButton");break;case 3:$("#tutorialArrowSpan").hide();$("#tutorialDialog").dialog("open");$("#tutorialContent").html(a.tutorialViews.getViewByID("fastForwardScreen").view);
$("#dialogButton").on("click",function(){a.fillScreenWithObjects(3);$("#tutorialDialog").dialog("close");a.gotoStep("showGoalScreen")});break;case 4:a.gotoStep("showGoalScreen")}a.currentBuildStep++},exit:function(){}};a.steps.showGoalButton={enter:function(){$("#goalButtonTutorial").show().click(function(){a.gotoStep("showGoalScreen")});a.setTutorialArrow("#hudcontainer","#goalButtonTutorial",40,"marginTop")},exit:function(){$("#goalButtonTutorial").unbind("click");$("#tutorialArrowSpan").hide()}};
a.steps.showGoalScreen={enter:function(){$("#tutorialArrowSpan").hide();switch(a.currentGoalStep){case 1:$("#tutorialContent").html(a.tutorialViews.getViewByID("newGoalFirstScreen").view);$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showmarketButton")});break;case 2:$("#tutorialContent").html(a.tutorialViews.getViewByID("newGoalSecondScreen").view);$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showGoalButton")});
break;case 3:$("#tutorialContent").html(a.tutorialViews.getViewByID("newGoalThirdScreen").view);$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showmarketButton")});break;case 4:$("#tutorialContent").html(a.tutorialViews.getViewByID("newGoalFourthScreen").view),$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showCoinButton")})}a.currentGoalStep++;$("#tutorialDialog").dialog("open")},exit:function(){$("#tutorialDialog").dialog("close");
$("#tutorialArrowSpan").hide()}};a.steps.showPaymentInfo={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialArrowSpan").hide();$("#tutorialContent").html(a.tutorialViews.getViewByID("notEnoughMoneyScreen").view);$("#dialogButton").on("click",function(){$("#tutorialDialog").dialog("close");a.gotoStep("showMoneyButton")})},exit:function(){}};a.steps.showMoneyButton={enter:function(){$("#cashbarTutorial").show().click(function(){a.gotoStep("showPaymentScreen")});a.setTutorialArrow("#hudcontainer",
"#cashbarTutorial",40,"marginTop")},exit:function(){$("#cashbarTutorial").unbind("click");$("#tutorialArrowSpan").hide()}};a.steps.showPaymentScreen={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialContent").html("<ul><li id='tutorialMoneyButton'>"+GameConfig.config.tutorialBuyCashString+"</li></ul>");$("#tutorialMoneyButton").click(function(){a.gotoStep("fillCreditCard")});a.setTutorialArrow("body","#tutorialMoneyButton",130,"marginLeft")},exit:function(){$("#tutorialMoneyButton").unbind("click")}};
a.steps.fillCreditCard={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialArrowSpan").hide();$("#tutorialContent").html(a.tutorialViews.getViewByID("creditCardScreen").view);$("#dialogButton").on("click",function(){a.isMoneyAdded=!0;$("#cashbarProgressTutorial").progressbar("value",500);$("#cashbarProgressTutorial").text(500);a.gotoStep("buildHouse")})},exit:function(){$("#tutorialDialog").dialog("close")}};a.steps.showCoinButton={enter:function(){$("#coinbarTutorial").show().click(function(){a.gotoStep("showAddCoinsScreen")});
a.setTutorialArrow("#hudcontainer","#coinbarTutorial",40,"marginTop")},exit:function(){$("#coinbarTutorial").unbind("click")}};a.steps.showAddCoinsScreen={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialContent").html("<ul><li id='tutorialCoinButton'>"+GameConfig.config.tutorialBuyCoinsString+"</li></ul>");$("#tutorialCoinButton").click(function(){$("#cashbarProgressTutorial").progressbar("value",$("#cashbarProgressTutorial").text()-1);$("#cashbarProgressTutorial").text($("#cashbarProgressTutorial").text()-
1);$("#coinbarProgressTutorial").progressbar("value",parseInt($("#coinbarProgressTutorial").text())+100);$("#coinbarProgressTutorial").text(parseInt($("#coinbarProgressTutorial").text())+100);a.gotoStep("showWaterButton")});a.setTutorialArrow("body","#tutorialCoinButton",130,"marginLeft")},exit:function(){$("#tutorialCoinButton").unbind("click");$("#tutorialDialog").dialog("close")}};a.steps.showWaterButton={enter:function(){$("#waterbarTutorial").show().click(function(){a.gotoStep("showAddWaterScreen")});
a.setTutorialArrow("#hudcontainer","#waterbarTutorial",40,"marginTop")},exit:function(){$("#waterbarTutorial").unbind("click")}};a.steps.showAddWaterScreen={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialContent").html("<ul><li id='tutorialWaterButton'>"+GameConfig.config.tutorialBuyWaterString+"</li></ul>");$("#tutorialWaterButton").click(function(){$("#cashbarProgressTutorial").progressbar("value",$("#cashbarProgressTutorial").text()-1);$("#cashbarProgressTutorial").text($("#cashbarProgressTutorial").text()-
1);$("#waterbarProgressTutorial").progressbar("value",parseInt($("#waterbarProgressTutorial").text())+100);$("#waterbarProgressTutorial").text(parseInt($("#waterbarProgressTutorial").text())+100);a.gotoStep("completeMessage")});a.setTutorialArrow("body","#tutorialWaterButton",130,"marginLeft")},exit:function(){$("#tutorialWaterButton").unbind("click")}};a.steps.completeMessage={enter:function(){$("#tutorialDialog").dialog("open");$("#tutorialArrowSpan").hide();$("#tutorialContent").html(a.tutorialViews.getViewByID("finishTutorial").view);
$("#dialogButton").on("click",function(){a.gotoStep("finishTutorial")})},exit:function(){$("#tutorialDialog").dialog("close")}};a.steps.finishTutorial={enter:function(){$("#tutorialDialog").dialog("close");$("#skipTutorial").remove();$("#tutorialArrowSpan").remove();ige.client.setGameBoardPostTutorial(a.tutorialObjects);ige.client.fsm.enterState("select")},exit:function(){}}},gotoStep:function(a){""!==this.currentStep&&this.steps[this.currentStep].exit();this.currentStep=a;this.steps[a].enter()},
fillScreenWithObjects:function(a){a=ige.$("tileMapTutorial");for(var c=0,b=0,d,e,h=1;8>=h;h++){var g=(new ige.newClassInstance(GameConfig.config.tutorialItem3)).layer(1).mount(a).mouseOver(function(){}).mouseOut(function(){}).mouseMove(function(){}).mouseUp(function(){});d=g.xTiles;e=g.yTiles;c+=d;4===h&&(c=0,b+=e);g.translateToTile(this.items.item3.mapX+g._tileAdjustX+c,this.items.item3.mapY+g._tileAdjustY+b);objinfo={id:ige.newIdHex(),classID:GameConfig.config.tutorialItem3,x:this.items.item3.mapX+
c,y:this.items.item3.mapY+b,w:d,h:e,name:this.items.item3.name,buildStarted:Date.now(),buildCompleted:Date.now()};this.tutorialObjects.push(objinfo)}b=c=0;for(h=1;4>=h;h++)g=(new ige.newClassInstance(GameConfig.config.tutorialItem2)).layer(1).mount(a).mouseOver(function(){}).mouseOut(function(){}).mouseMove(function(){}).mouseUp(function(){}),d=g.xTiles,e=g.yTiles,c+=d,g.translateToTile(this.items.item2.mapX+g._tileAdjustX+c,this.items.item2.mapY+g._tileAdjustY),objinfo={id:ige.newIdHex(),classID:GameConfig.config.tutorialItem2,
x:this.items.item2.mapX+c,y:this.items.item2.mapY,w:d,h:e,name:this.items.item2.name,buildStarted:Date.now(),buildCompleted:Date.now()},this.tutorialObjects.push(objinfo)},animatethis:function(a,c,b){var d=this,e={};e[b]="+=50px";$(a).animate(e,{duration:c,easing:"easeInOutSine",complete:function(){e[b]="-=50px";a.animate(e,{duration:c,easing:"easeInOutSine",complete:function(){d.animatethis(a,c,b)}})}})},setTutorialArrow:function(a,c,b,d){switch(a){case "#hudcontainer":$("#tutorialArrowSpan").appendTo("#hudcontainer").insertAfter("#topToolbarTutorial").css("position",
"absolute").show().position({my:"top center",at:"bottom center",of:c}).css("top","");break;case "body":$("#tutorialArrowSpan").appendTo("body").css("position","fixed").position({my:"right center",at:"left center",of:c}).show()}$("#tutorialArrowImage").stop().css("margin-top","0px").css("margin-left","0px").rotate({angle:b});this.animatethis($("#tutorialArrowImage"),500,d)}});var API={init:function(a){$.ajax({url:"/api/get_user",dataType:"json",success:function(c){API.user=c;ige.client.viewVillageID&&ige.client.viewVillageID!==API.user.key_id?ige.client.fsm.initialState("view"):("ok"===c.status?(ga("send",  "Online user"),dataLayer.push({userEmail:API.user.email}),API.loginStatus="online",history.replaceState({villageID:API.user.key_id},"load_village","?v="+API.user.key_id+location.hash)):"fail"===c.status?location.href=c.login_url:(API.loginStatus="offline",ga("send",  "Offline user"),
dataLayer.push({userEmail:"offline"}),null===localStorage.getItem("id")&&localStorage.setItem("id",ige.newIdHex()),API.user.id=localStorage.getItem("id")),API.loadState(a))}})},_buyCallback:function(){console.error("missing buy callback")},loadState:function(a){if("offline"===API.loginStatus){null===localStorage.getItem("state")&&localStorage.setItem("state",JSON.stringify(API.state));console.log("loaded state from local storage",localStorage.getItem("state"));var c=!API.state.objects;API.state=JSON.parse(localStorage.getItem("state"));
a(API.state.isTutorialShown);API._buyCallback();c&&API.firstReloadState();API.reloadState();API.state.isTutorialShown&&(ige.client.eventEmitter=ige.client.eventEmitter||new EventEmitter,ige.client.gameLogic=ige.client.gameLogic||new GameLogic);ige.client.isFirstLoadFinished=!0}else"online"===API.loginStatus&&$.ajax({url:"/api/get_state",dataType:"json",success:function(b){console.log("loaded state",b);var c=!API.state.objects;null!==localStorage.getItem("state")&&"true"===b.first?(API.state=JSON.parse(localStorage.getItem("state")),
API.state.first="false",API.saveState(),localStorage.removeItem("state"),localStorage.removeItem("id")):null===localStorage.getItem("state")&&"true"===b.first?(API.state=b,API.state.first="false",API.saveState()):API.state=b;a(API.state.isTutorialShown);API._buyCallback();c&&API.firstReloadState();API.reloadState();API.state.isTutorialShown&&(ige.client.eventEmitter=new EventEmitter,ige.client.gameLogic=new GameLogic);ige.client.isFirstLoadFinished=!0}})},reduceAssets:function(a){console.log("reduce assets",
a);var c={status:!0,coins:!0,cash:!0,water:!0};a.coins>API.state.coins&&(c.coins=!1);a.cash>API.state.cash&&(c.cash=!1);a.water&&a.water>API.state.water&&(c.water=!1);if(!c.coins||!c.cash||!c.water)return c.status=!1,c;a.water&&(ClientHelpers.guiAnimateWater(API.state.water,-a.water),API.state.water-=a.water);ClientHelpers.guiAnimateCoins(API.state.coins,-a.coins);ClientHelpers.guiAnimateCash(API.state.cash,-a.cash);API.state.cash-=a.cash;API.state.coins-=a.coins;API.saveState();return c},addCoins:function(a){ga("send",  "Add Coins");
ClientHelpers.guiAnimateCoins(API.state.coins,a);API.state.coins+=a;API.saveState();return!0},addCash:function(a){ga("send",  "Add Cash");ClientHelpers.guiAnimateCash(API.state.cash,a);API.state.cash+=a;API.saveState();return!0},addWater:function(a){ga("send",  "Add Cash");ClientHelpers.guiAnimateWater(API.state.water,a);API.state.water+=a;API.saveState();return!0},saveState:function(){"offline"===API.loginStatus?localStorage.setItem("state",JSON.stringify(API.state)):"online"===API.loginStatus&&
$.ajax({url:"/api/save_state",dataType:"json",method:"POST",data:{state:JSON.stringify(API.state),csrf:API.user.csrf}})},firstReloadState:function(){var a=API.state.objects||[],c=API.state.goals||[],b=!1;if("TRUE"===GameConfig.config.syncGameObjectDimensions)for(var d in a)a[d].w=GameObjects.catalogLookup[a[d].name].xTiles,a[d].h=GameObjects.catalogLookup[a[d].name].yTiles;for(d in a)void 0===a[d].id&&(a[d].id=ige.newIdHex(),b=!0),API.stateObjectsLookup[a[d].id]=a[d],ClientHelpers.addObject(a[d],
"tileMap1"),ClientHelpers.moveOutPlayer();for(d in c)API.stateGoalsLookup[c[d].goalID]=c[d];ClientHelpers.setPlayerPos();b&&API.saveState()},reloadState:function(){API.state.coins||(API.state.coins=0);API.state.cash||(API.state.cash=0);API.state.water||(API.state.water=0);ClientHelpers.guiSetCoins(API.state.coins);ClientHelpers.guiSetCash(API.state.cash);ClientHelpers.guiSetWater(API.state.water)},createObject:function(a){ga("send",  "Create object");console.log("ige create object",a);API.state.objects||
(API.state.objects=[]);var c=API.state.objects.push(a);API.stateObjectsLookup[a.id]=API.state.objects[c-1];API.saveState()},updateObject:function(a,c,b){ga("send",  "Update object");console.log("ige update object",a);API.stateObjectsLookup[a.id()].x=c;API.stateObjectsLookup[a.id()].y=b;API.saveState()},saveObjectBuiltDate:function(a,c){vlg.log.debug("ige update object",a);API.stateObjectsLookup[a.id()].buildCompleted=c;API.saveState()},resetBuildTimes:function(a,c){API.stateObjectsLookup[a.id()].buildStarted=
c;API.stateObjectsLookup[a.id()].buildCompleted=null;API.saveState()},saveObjectStateProperties:function(a,c){for(var b in c)c.hasOwnProperty(b)&&(API.stateObjectsLookup[a.id()][b]=c[b],console.log(API.stateObjectsLookup[a.id()][b]),console.log(c[b]));API.saveState()},setTutorialAsShown:function(){console.log("tutorial is shown");API.state.isTutorialShown=!0;API.saveState()},createGoal:function(a){ga("send",  "Create goal");console.log("ige create goal",a);API.state.goals||(API.state.goals=[]);
var c=API.state.goals.push({goalID:a});API.stateGoalsLookup[a]=API.state.goals[c-1];API.state.currentGoalID=a;API.saveState()},updateGoal:function(a,c,b){ga("send",  "Update goal");console.log("ige update goal",a,c,b);API.stateGoalsLookup[a].tasks||(API.stateGoalsLookup[a].tasks=[]);var d=API.stateGoalsLookup[a].tasks.map(function(a){return a.taskID}).indexOf(c);-1!==d?API.stateGoalsLookup[a].tasks[d].value=b:API.stateGoalsLookup[a].tasks.push({taskID:c,value:b});API.saveState()},setGoalAsComplete:function(a){ga("send",  "Complete goal");
console.log("goal is complete");API.stateGoalsLookup[a].isComplete=!0;API.saveState()},setGoalRewardsAsCollected:function(a){API.stateGoalsLookup[a].isRewardsCollected=!0;API.saveState()},setProblemAsShown:function(a){API.state.problems||(API.state.problems=[]);-1===API.state.problems.indexOf(a)&&API.state.problems.push(a);API.saveState()},addUnlockedItem:function(a){API.state.unlockedItems=API.state.unlockedItems||[];-1===API.state.unlockedItems.indexOf(a)&&(ga("send",  "Add unlocked item to state"),
API.state.unlockedItems.push(a),API.saveState())},getUnlockedItem:function(a){API.state.unlockedItems=API.state.unlockedItems||[];a=API.state.unlockedItems.indexOf(a);return-1===a?null:API.state.unlockedItems[a]},state:{coins:parseInt(GameConfig.config.startCoins),cash:parseInt(GameConfig.config.startCash),water:parseInt(GameConfig.config.startWater)},stateObjectsLookup:{},stateGoalsLookup:{},user:null,loginStatus:"offline"};var Buy={buy:function(a){ige.$("buyStatus").startTransaction();Buy.pay(a,function(c,b){dataLayer.push({assetBuyActionName:"Cash Buy"});dataLayer.push({event:"assetBuy"});Buy._addAssets(a);ige.$("buyStatus").transactionSuccess(c,b)},function(c,b){ige.$("buyStatus").transactionFailed(function(){location.href="pay.html?param="+Buy.createReason(a)+"&loginStatus="+API.loginStatus+"&userID="+API.user.id+"&amount="+c+"&vbucks="+b})})},createReason:function(a){var c=Math.random().toString(36).substring(7);
a=c+";"+window.btoa(JSON.stringify(a));var b=CryptoJS.HmacSHA1(a,API.user.csrf);document.cookie="continue_transaction="+c;return b.toString()+"-"+window.btoa(a)},pay:function(a,c,b){console.log("buy ",a);$.ajax({url:"/api/pay",data:{amount:Buy._getAmount(a),csrf:API.user.csrf,id:API.user.id,loginStatus:API.loginStatus},dataType:"json",type:"POST",success:function(d){console.log("pay -> ",d);"register"==d.status?location.href="pay.html?param="+Buy.createReason(a)+"&loginStatus="+API.loginStatus+"&userID="+
API.user.id+"&amount="+d.amount+"&vbucks="+d.vbucks:"ok"==d.status?c(d.amount,d.vbucks):b(d.amount,d.vbucks)}})},_addAssets:function(a){var c={coins:API.addCoins,cash:API.addCash},b=[],d;for(d in c){var e=a[d],e=parseInt(e,10);e!=e&&(e=0);0!=e&&(c[d](e),b.push(e+" "+d))}console.log("You have just purchased "+b.join(" and "))},_getAmount:function(a){if(!(0<=a.coins&&0<=a.cash))throw"error "+JSON.stringify(a);return JSON.stringify(a)},getQueryVariable:function(a,c){for(var b=a.split("&"),d=0;d<b.length;d++){var e=
b[d].split("=");if(decodeURIComponent(e[0])==c)return decodeURIComponent(e[1])}console.log("Query variable %s not found",c)}};
API._buyCallback=function(){var a=Buy.getQueryVariable(location.hash.slice(1),"pay");if(a){console.warn("pay callback ",a);var c=a.indexOf("-"),b=a.slice(0,c),a=window.atob(a.slice(c+1)),c=CryptoJS.HmacSHA1(a,API.user.csrf).toString();if(b!=c)console.error("CSRF validation error");else if(c=getCookie("continue_transaction")){document.cookie="continue_transaction="+Math.random().toString(36).substring(7);var d=a.indexOf(";"),e=a.slice(0,d),a=a.slice(d+1);e!=c?console.error("bad transaction id"):(console.log("transaction validated!",
e,b,a,window.atob(a)),b=JSON.parse(window.atob(a)),Buy.buy(b),location.hash="#")}else console.error("missing continue transaction cookie")}};var ClientHelpers={guiSetCoins:function(a){$("#coinbarProgress").progressbar("value",a);$("#coinbarProgress").text(a)},hideDialogs:function(){var a="goalDialog marketDialog editorMarketDialog cashBuyDialog coinBuyDialog newsFeedDialog shareMyVillageDialog processingDialog buyConfirmDialog feedBackDialog waterBuyDialog".split(" ");ige.client.slideRight.close();for(var c=0;c<a.length;c++)$("#"+a[c]).dialog(),$("#"+a[c]).dialog("close")},guiSetCash:function(a){$("#cashbarProgress").progressbar("value",
a);$("#cashbarProgress").text(a)},guiSetWater:function(a){$("#waterbarProgress").progressbar("value",a);$("#waterbarProgress").text(a)},guiAnimateCoins:function(a,c){$("#coinbarProgress").prop("number",a).animateNumber({number:a+c})},guiAnimateCash:function(a,c){$("#cashbarProgress").prop("number",a).animateNumber({number:a+c})},guiAnimateWater:function(a,c){$("#waterbarProgress").prop("number",a).animateNumber({number:a+c})},addObject:function(a,c){vlg.log.debug("add object",a.name);var b=new ige.newClassInstance(a.name);
b.id(a.id);b.currentState=a.currentState;b.currentSpecialEvent=a.currentSpecialEvent;b.mount(ige.$(c));vlg.log.debug("create",a,b);b.occupyTile(parseInt(a.x),parseInt(a.y),Math.ceil(parseFloat(a.w)),Math.ceil(parseFloat(a.h)));var d=parseInt(a.x)+b._tileAdjustX,e=parseInt(a.y)+b._tileAdjustY;b.translateToTile(d,e);b.data("tileX",parseInt(a.x)).data("tileY",parseInt(a.y)).data("tileWidth",parseInt(a.w)).data("tileHeight",parseInt(a.h));a.buildStarted&&!a.buildCompleted?(a.currentState||(b.currentState=
"building"),b._buildStarted=a.buildStarted,"view"===ige.client.fsm.currentStateName()?b.place(!0):b.place()):(a.currentState||(b.currentState="ready"),b.place(!0),b.setEndCell())},setPlayerPos:function(){var a=ige.$("bob");a.currentTile();for(var c=parseInt(GameConfig.config.villagerStartX),b=parseInt(GameConfig.config.villagerStartY);ige.$("tileMap1").isTileOccupied(c,b,1,1);)c++,b++;a.translateToTile(c,b)},moveOutPlayer:function(){var a=ige.$("bob").currentTile();ige.$("tileMap1").isTileOccupied(a.x,
a.y,1,1)&&ige.$("bob").walkToTile(a.x+1,a.y-1)},showMessage:function(a){this.messageTimeout&&(this.messageTimeout.cancel(),this.messageTimeout=null);$("#notificationMessage").text(a).stop().css("opacity",1).css("left",10).css("top",150).show().animate({top:"-=100px"},1E3,GameConfig.config.notificationMessageEasing);this.messageTimeout=new IgeTimeout(function(){$("#notificationMessage").animate({opacity:0},{duration:1E3,complete:function(){$("#notificationMessage").hide()}})},1E3*parseInt(GameConfig.config.message_fadeout))},
closeAllDialogsButThis:function(a){var c="marketDialog goalDialog cashBuyDialog coinBuyDialog shareMyVillageDialog feedBackDialog waterBuyDialog".split(" ");ige.client.slideRight.close();for(var b=0;b<c.length;b++)c[b]!==a&&($("#"+c[b]).dialog(),$("#"+c[b]).dialog("close"))},convertToPrice:function(a){for(var c,b={coins:0,cash:0,water:0},d=0;d<a.length;d++)switch(c=a[d],(c.match(/[a-zA-Z]/)||[]).pop()){case "c":b.coins=parseInt(c,10);break;case "b":b.cash=parseInt(c,10);break;case "w":b.water=parseInt(c,
10)}return b}};var GameObjects={gameObjectTextures:{},setupMarket:function(a){a.createPages(Math.ceil(GameObjects._marketCallbacks.length/a.itemCount));for(var c in GameObjects._marketCallbacks)GameObjects._marketCallbacks[c](a)},setupEditorMarket:function(a){var c=Math.ceil(GameObjects.catalog.length/parseInt(GameConfig.config.itemCount));a.createPages(c);for(var b in GameObjects.catalog)c=GameObjects.catalog[b],a.addItem({id:"editor"+c.id,classId:c.id,title:c.name,texture:ige.client.textures[c.id],coins:0,cash:0,
cell:c.cell,scale:c.scale,scaleValue:c.scaleValue})},_marketCallbacks:[],loadCatalog:function(a){GameObjects.catalog=a;GameObjects.catalogLookup={};for(var c in a){var b=a[c];GameObjects.createGameObjectClass(b.id,b);GameObjects.catalogLookup[b.id]=b}},createGameObjectClass:function(a,c){GameObjects.gameObjectTextures[a]=[c.textureUrl,c.cellCount||1,c.textureID];c.enabled&&GameObjects._marketCallbacks.push(function(b){b.addItem({id:a,classId:a,title:c.name,texture:ige.client.textures[a],coins:c.coins,
cash:c.cash,cell:c.cell,scale:c.scale,scaleValue:c.scaleValue,dependency:c.dependency,unlockValue:parseInt(c.unlockValue)})});window[a]=GameObject.extend({classId:a,init:function(){GameObject.prototype.init.call(this);var b=this;this.texture(ige.client.textures[a]).dimensionsFromCell().bounds3d(c.bounds3d[0],c.bounds3d[1],c.bounds3d[2]).anchor(c.anchor[0],c.anchor[1]);this.width(c.scaleValue*this.width());this.height(c.scaleValue*this.height());this.calcTileAdjust();this.cell(c.cell);this.type=c.type;
this.xTiles=parseInt(c.xTiles);this.yTiles=parseInt(c.yTiles);this.dependency=c.dependency;this.unlocks=c.unlocks;this.unlockValue=parseInt(c.unlockValue);this.mouseOverText=c.description;this.buildTime=c.buildTime;this.buildTimeMilliseconds=convertTimeFormatToMilliseconds(this.buildTime);this.buildTimeSpeedValue=parseInt(c.buildTimeSpeedValue);this.specialEvent=c.specialEvent;this.specialEvents=c.specialEvent.split(",");this.mouseOverPanel=$("#objectInfoPanelTemplate").clone().prop({id:"objectInfoPanel"+
b.id()});this.mouseOverPanel.find("h3").contents()[0].textContent=c.name;this.mouseOverPanel.find("p").first().html(this.mouseOverText);this.mouseOverPanel.find("img").first().attr("src",c.iconUrl);this.mouseOverPanel.find(".currentStateInactiveInfo").first().html(GameConfig.config.objectInactiveString);this.mouseOverPanel.find("h3 button").first().click(function(){b.hideMouseOverPanel()});this.mouseOverPanel.mouseover(function(){b.cancelTimeouts("Off")});this.mouseOverPanel.mouseout(function(){b.cancelTimeouts("Off");
b.mouseOverPanelOffTimeout=new IgeTimeout(function(){b.hideMouseOverPanel()},parseInt(GameConfig.config.mouseOverPanelOffTimeout))});this.mouseOverPanel.find(".currentStateAction").first().click(function(){"select"===ige.client.fsm.currentStateName()&&b.handleMouseClick()});$("#objectInfoContainer").append(this.mouseOverPanel);this.mouseDown(function(){"select"===ige.client.fsm.currentStateName()&&ige.input.stopPropagation()});this.mouseUp(function(){"select"===ige.client.fsm.currentStateName()&&
(ige.input.stopPropagation(),b.handleMouseClick())});this.mouseOver(function(){var a=this;if("select"===ige.client.fsm.currentStateName()||"view"===ige.client.fsm.currentStateName())this.layer(1).highlight(!0),"select"===ige.client.fsm.currentStateName()&&a.updateMouseOverPanelContents(),a.updateMouseOverPanelPosition(!0),ige.client.currentMouseOverPanelOwner&&ige.client.currentMouseOverPanelOwner!==a&&(ige.client.currentMouseOverPanelOwner.cancelTimeouts(),ige.client.currentMouseOverPanelOwner.hideMouseOverPanel()),
ige.client.currentMouseOverPanelOwner=a,a.cancelTimeouts("Off"),a.mouseOverPanelOnTimeout=new IgeTimeout(function(){a.showMouseOverPanel()},parseInt(GameConfig.config.mouseOverPanelOnTimeout))});this.mouseOut(function(){this.layer(0).highlight(!1);b.cancelTimeouts();b.mouseOverPanelOffTimeout=new IgeTimeout(function(){b.hideMouseOverPanel()},parseInt(GameConfig.config.mouseOverPanelOffTimeout))});this.mouseMove(function(){b.cancelTimeouts("Off");"select"!==ige.client.fsm.currentStateName()&&"view"!==
ige.client.fsm.currentStateName()||ige.input.stopPropagation()})},place:function(a){GameObject.prototype.place.call(this);a||(this._buildProgressBar=(new IgeUiProgressBar).barBackColor("#f2b982").barColor("#69f22f").barBorderColor("#3a9bc5").min(0).max(100).progress(0).width(50).height(10).translateTo(0,-40,0).mount(this),this._buildProgressTime=(new IgeFontEntity).colorOverlay("white").nativeFont(GameConfig.config.gameFont).nativeStroke(4).nativeStrokeColor("#000000").width(200).height(100).mount(this).translateTo(0,
-60,0).text(""))},update:function(){GameObject.prototype.update.call(this);this.updateMouseOverPanelPosition();this.specialEventNotifyElement&&(this.specialEventNotifyElement.css("top",this.screenPosition().y-100),this.specialEventNotifyElement.css("left",this.screenPosition().x-7));if(this._buildProgressBar){var a,c,e,h,g,p="";a=Math.floor(100/this.getCurrentStateFinishTime()*(Date.now()-this._buildStarted));c=this.getCurrentStateFinishTime()-(Date.now()-this._buildStarted);g=Math.floor(c/864E5);
h=Math.floor(c%864E5/36E5);e=Math.floor(c%36E5/6E4);c=Math.floor(c%6E4/1E3);0<g?(p+=g+"d",0<h?p+=h+"h":0<e?p+=e+"m":0<c&&(p+=c+"s")):0<h?(p+=h+"h",0<e?p+=e+"m":0<c&&(p+=c+"s")):p=0<e?p+(e+"m")+(c+"s"):p+(c+"s");this._buildProgressBar.progress(a);this._buildProgressTime.text(p);this.mouseOverPanel.find(".currentStateCountdown").first().html(p);100<=a?this.finishProgress():(a=this.getCurrentStateCellNo(a),0==a&&(a=1),this.cell(a))}},getCurrentStateFinishTime:function(){switch(this.currentState){case "building":return this.buildTimeMilliseconds;
case "waitingSpecialEvent":return convertTimeFormatToMilliseconds(SpecialEvents.events[this.getCurrentSpecialEvent()].time)}},getCurrentStateCellNo:function(a){switch(this.currentState){case "building":return Math.ceil(a/100*(c.builtCell-1));case "waitingSpecialEvent":var b=parseInt(SpecialEvents.events[this.getCurrentSpecialEvent()].startCell),e=parseInt(SpecialEvents.events[this.getCurrentSpecialEvent()].endCell);if(isNaN(b))return c.cell;isNaN(e)&&(e=c.cell);return Math.floor(a/100*(e-b))+b}},
getCurrentStateSpeedValue:function(a){switch(this.currentState){case "building":return this.buildTimeSpeedValue;case "waitingSpecialEvent":return parseInt(SpecialEvents.events[this.getCurrentSpecialEvent()].speedValue);case "ready":return-1}},getCurrentSpecialEvent:function(){if(null===this.currentSpecialEvent||void 0===this.currentSpecialEvent)this.currentSpecialEvent=this.specialEvents[0];return this.currentSpecialEvent},getNextSpecialEvent:function(){var a,c=this.getCurrentSpecialEvent();a=this.specialEvents.indexOf(c);
return 1===this.specialEvents.length?c:++a>=this.specialEvents.length?this.specialEvents[0]:this.specialEvents[a]},getPrevSpecialEvent:function(){var a,c=this.getCurrentSpecialEvent();a=this.specialEvents.indexOf(c);return 1===this.specialEvents.length?c:0>--a?this.specialEvents[this.specialEvents.length-1]:this.specialEvents[a]},finishProgress:function(){var b;API.saveObjectBuiltDate(this,Date.now());"building"===this.currentState?(ige.client.eventEmitter.emit("buildCompleted",{id:a,type:this.type}),
b=c.builtCell):"waitingSpecialEvent"===this.currentState&&(b=parseInt(SpecialEvents.events[this.getCurrentSpecialEvent()].endCell),isNaN(b)&&(b=c.cell),this.currentSpecialEvent=this.getNextSpecialEvent());this.currentState="ready";API.saveObjectStateProperties(this,{currentState:this.currentState,currentSpecialEvent:this.currentSpecialEvent});this._buildProgressBar.destroy();this._buildProgressBar=null;this._buildProgressTime.destroy();this._buildProgressTime=null;this.cell(b);this.notifySpecialEvent();
this.updateMouseOverPanelContents()},setEndCell:function(){var a;"None"!==this.specialEvent&&(a=parseInt(SpecialEvents.events[this.getPrevSpecialEvent()].endCell));isNaN(a)&&(a=c.cell);this.cell(a)},notifySpecialEvent:function(){"None"!==this.specialEvent&&"None"!==SpecialEvents.events[this.getCurrentSpecialEvent()].notifyIcon&&(this.specialEventNotifyElement=$("<span class='notifyIconWrapper'></span>").appendTo("#notifyIconContainer").css("top",this.screenPosition().y-100).css("left",this.screenPosition().x-
7),$("<img class='notifyIcon' src='"+ige.client.textures[SpecialEvents.events[this.getCurrentSpecialEvent()].notifyIcon].url()+"'>").appendTo(this.specialEventNotifyElement).animate({top:"+=50px"},1E3,SpecialEvents.events[this.getCurrentSpecialEvent()].notifyIconEasing))},removeNotifyIcon:function(){this.specialEventNotifyElement&&this.specialEventNotifyElement.remove()},speedProgress:function(){var a,c,e,h=this,g=null;e=this.getCurrentStateSpeedValue();-1===e?(a="Progress already finished!",g=!0):
(a="Speed progress for "+e+" VBuck"+(1<e?"s":"")+"?",c=function(){-1===h.getCurrentStateSpeedValue()?(new BuyConfirm("Progress already finished!",null,!0)).layer(1).show().mount(ige.$("uiScene")):API.reduceAssets({coins:0,cash:parseInt(e,10)}).status?(dataLayer.push({event:"gameObjectSpeedProgress"}),h.finishProgress()):(ga("send",  "Not enough money"),(new BuyConfirm(GameConfig.config.notEnoughCashString,function(){ige.$("cashDialog").show()})).layer(1).show().mount(ige.$("uiScene")))});(new BuyConfirm(a,
c,g)).layer(1).show().mount(ige.$("uiScene"))},showMouseOverPanel:function(){this.isMouseOverPanelOn=!0;this.mouseOverPanel.show(GameConfig.config.mouseOverPanelShowEffect,parseInt(GameConfig.config.mouseOverPanelShowDuration))},hideMouseOverPanel:function(){var a=this;a.mouseOverPanel.hide(GameConfig.config.mouseOverPanelHideEffect,parseInt(GameConfig.config.mouseOverPanelHideDuration),function(){a.isMouseOverPanelOn=!1})},cancelTimeouts:function(a){this.mouseOverPanelOnTimeout&&"Off"!==a&&(this.mouseOverPanelOnTimeout.cancel(),
this.mouseOverPanelOnTimeout=null);this.mouseOverPanelOffTimeout&&"On"!==a&&(this.mouseOverPanelOffTimeout.cancel(),this.mouseOverPanelOffTimeout=null)},handleMouseClick:function(){if("None"!==this.specialEvent&&API.stateObjectsLookup[this.id()].buildCompleted){this.currentSpecialEvent=this.getCurrentSpecialEvent();var a=SpecialEvents.events[this.currentSpecialEvent].cost.split(","),a=ClientHelpers.convertToPrice(a),a=API.reduceAssets({coins:parseInt(a.coins,10),cash:parseInt(a.cash,10),water:parseInt(a.water,
10)});if(a.status)dataLayer.push({gameObjectClickActionName:this.currentSpecialEvent}),dataLayer.push({event:"gameObjectClick"}),this._buildStarted=Date.now(),API.resetBuildTimes(this,this._buildStarted),this.currentState="waitingSpecialEvent",API.saveObjectStateProperties(this,{currentState:this.currentState,currentSpecialEvent:this.currentSpecialEvent}),this.place(),this.removeNotifyIcon(),ige.client.eventEmitter.emit(this.currentSpecialEvent,{id:this.classId(),type:this.type,positionX:this.screenPosition().x,
positionY:this.screenPosition().y-30,itemRef:this});else{ga("send",  "Not enough assets");var c="You don't have enough ";a.coins||(c+="Coins ");a.cash||(c+="VBucks ");a.water||(c+="Water");(new BuyConfirm(c,null,!0)).layer(1).show().mount(ige.$("uiScene"))}this.updateMouseOverPanelContents()}else API.stateObjectsLookup[this.id()].buildCompleted||(this.speedProgress(),this.updateMouseOverPanelContents())},updateMouseOverPanelContents:function(){var a,c,e;if("None"!==this.specialEvent&&API.stateObjectsLookup[this.id()].buildCompleted){this.currentSpecialEvent=
this.getCurrentSpecialEvent();a=SpecialEvents.events[this.currentSpecialEvent].cost.split(",");c=ClientHelpers.convertToPrice(a);e=SpecialEvents.events[this.currentSpecialEvent].displayName;a=SpecialEvents.events[this.currentSpecialEvent].description;if(0<c.coins||0<c.cash||0<c.water)e+=" for ";0<c.coins&&(e+=c.coins+"<img class='tooltipImage' src='assets/textures/ui/Coin1.png'> ");0<c.cash&&(e+=c.cash+"<img class='tooltipImage' src='assets/textures/ui/Banknotes.png'> ");0<c.water&&(e+=c.water+"<img class='tooltipImage' src='assets/textures/ui/Water-48.png'>");
this.mouseOverPanel.find(".currentStateName img").first().attr("src",ige.client.textures[SpecialEvents.events[this.getCurrentSpecialEvent()].notifyIcon].url());this.mouseOverPanel.find(".currentStateCountdown").first().html("Ready!").attr("title","").tooltip().tooltip("destroy").css("display","table-cell");this.mouseOverPanel.find(".currentStateAction").first().html(e).attr("title","").tooltip().tooltip("destroy").css("display","table-cell")}else API.stateObjectsLookup[this.id()].buildCompleted?(a=
GameConfig.config.comingSoonString,this.mouseOverPanel.find(".currentStateName img").first().attr("src","assets/textures/ui/Error-48.png"),this.mouseOverPanel.find(".currentStateCountdown").first().css("display","none"),this.mouseOverPanel.find(".currentStateAction").first().css("display","none"),this.mouseOverPanel.find(".currentStateInactiveInfo").first().css("display","table-cell")):(c="Waiting ",e="Click to speed progress ","building"===this.currentState?(this.mouseOverPanel.find(".currentStateName img").first().attr("src",
"assets/textures/ui/Under-Construction-48.png"),c+="on construction",e+="on construction",a=GameConfig.config.underConstructionString):"waitingSpecialEvent"===this.currentState&&(this.mouseOverPanel.find(".currentStateName img").first().attr("src",ige.client.textures[SpecialEvents.events[this.getCurrentSpecialEvent()].notifyIcon].url()),this.currentSpecialEvent=this.getCurrentSpecialEvent(),c+=SpecialEvents.events[this.currentSpecialEvent].speedText,e+=SpecialEvents.events[this.currentSpecialEvent].speedText,
a=SpecialEvents.events[this.currentSpecialEvent].description),this.mouseOverPanel.find(".currentStateCountdown").first().attr("title",c).tooltip().css("display","table-cell"),this.mouseOverPanel.find(".currentStateAction").first().html("<img src='assets/textures/ui/Fast-Forward-48.png' width='25' height='25'><br><span class='currentStateSpeedValue'>"+this.getCurrentStateSpeedValue()+"</span><img src='assets/textures/ui/Banknotes.png' width='15' height='15'>").attr("title",e).tooltip().css("display",
"table-cell"));this.mouseOverPanel.find(".currentStateName img").first().attr("title",a).tooltip()},updateMouseOverPanelPosition:function(a){if(!0===this.isMouseOverPanelOn||!0===a){a=this.screenPosition().y-this.mouseOverPanel.height()-this.height()/4;var b=this.screenPosition().x-this.mouseOverPanel.width()/2,c=this.mouseOverPanel.find(".arrow").first(),h,g;0>a?(a=this.screenPosition().y+this.height()/2,c.attr("class","arrow arrow-up"),h=a-20):(c.attr("class","arrow arrow-down"),h=a+this.mouseOverPanel.height());
0>b?b=0:this.screenPosition().x+this.mouseOverPanel.width()/2>$(window).width()&&(b=$(window).width()-this.mouseOverPanel.width());g=0>=b&&0>=this.screenPosition().x?10:this.screenPosition().x+this.mouseOverPanel.width()/2>=$(window).width()&&this.screenPosition().x>=$(window).width()?$(window).width()-50:this.screenPosition().x-20;this.mouseOverPanel.css("top",a);this.mouseOverPanel.css("left",b);c.css("top",h);c.css("left",g)}}})}};var SpanContainer=IgeUiElement.extend({classId:"SpanContainer",tick:function(a){var c=this.children(),b=0;for(a=0;a<c.length;a++){var d=c[a];d.left(b);b+=d.width()}}});function getParameterByName(a,c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=(new RegExp("[\\?&]"+c+"=([^&#]*)")).exec(a);return null===b?"":decodeURIComponent(b[1].replace(/\+/g," "))}function getCookie(a){var c=" "+document.cookie;a=c.indexOf(" "+a+"=");if(-1==a)c=null;else{a=c.indexOf("=",a)+1;var b=c.indexOf(";",a);-1==b&&(b=c.length);c=unescape(c.substring(a,b))}return c}
function convertTimeFormatToMilliseconds(a){var c=0,b,d=[];d.day=864E5;d.hour=36E5;d.minute=6E4;d.second=1E3;-1!==a.indexOf("d")&&(b=a.match(/\d+(?=d)/),c+=b*d.day);-1!==a.indexOf("h")&&(b=a.match(/\d+(?=h)/),c+=b*d.hour);-1!==a.indexOf("m")&&(b=a.match(/\d+(?=m)/),c+=b*d.minute);-1!==a.indexOf("s")&&(a=a.match(/\d+(?=s)/),c+=a*d.second);return c};var AssetAnimation=IgeEntity.extend({classId:"AssetAnimation",init:function(a,c,b){IgeEntity.prototype.init.call(this);var d=this;d.totalObjects=parseInt(GameConfig.config.assetAnimationTotalObjects);d.objects=[];d.tweenRefs=[];d._moveTo=b;a=function(a){var b=(new IgeEntity).layer(100).width(14).height(11).texture(ige.client.textures[c]).translateTo(-20+Math.floor(11*Math.random())+0,20+Math.floor(-9*Math.random())+5,0).mount(d);b.tweenRef=b._translate.tween().stepBy({x:20},400,"inOutSine").stepBy({x:-20},
400,"inOutSine").repeatMode(1,-1).startTime(ige._currentTime+100*a).start();d.tweenRefs.push(b.tweenRef);b.tweenRef=b._translate.tween().stepBy({y:-40},200,"outSine").stepBy({y:40},200,"inSine").repeatMode(1,-1).startTime(ige._currentTime+100*a).start();d.tweenRefs.push(b.tweenRef);return b};for(b=0;b<d.totalObjects;b++){var e=new a(b);d.objects[b]=e}},gotoTopNavBar:function(){for(var a=this,c=0;c<a.tweenRefs.length;c++)a.tweenRefs[c].stop();for(c=0;c<a.totalObjects;c++)(function(b){a.objects[b]._translate.tween().stepTo({x:-($("canvas").width()/
2+a.translate().x())+$("#"+a._moveTo).position().left,y:-($("canvas").height()/2+a.translate().y())},500,"inSine").afterTween(function(c){a.objects[b].hide()}).startTime(ige._currentTime+30*b).start()})(c)}});var BuyConfirm=Dialog.extend({classId:"BuyConfirm",init:function(a,c,b){Dialog.prototype.init.call(this);var d=this;ige.client.newBuyConfirm=d;$("#buyConfirmMessage").html(a);null!==b&&void 0!==b&&!0===b?($("#buyConfirmYes").hide(),$("#buyConfirmNo").hide(),$("#buyConfirmOK").click(function(){ga("send",  "Confirm dialog");$("#buyConfirmOK").unbind("click");d.closeMe();null!==c&&void 0!==c&&c()}).show()):($("#buyConfirmOK").hide(),$("#buyConfirmYes").click(function(){ga("send",  "Confirm buy");
$("#buyConfirmYes").unbind("click");$("#buyConfirmNo").unbind("click");d.closeMe();c()}).show(),$("#buyConfirmNo").click(function(){ga("send",  "Cancel buy");$("#buyConfirmYes").unbind("click");$("#buyConfirmNo").unbind("click");d.closeMe()}).show());this.closeButton.hide();this._underlay.hide()},show:function(){var a=this;ige.client.fsm.enterState("buyConfirmDialog",null,function(c){c||($("#buyConfirmDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,
autoOpen:!1,close:function(b,c){$("#buyConfirmYes").unbind("click");$("#buyConfirmNo").unbind("click");$("#buyConfirmOK").unbind("click");a.closeMe()}}),$("#buyConfirmDialog").dialog("open"),Dialog.prototype.show.call(a))});return this},hide:function(){$("#buyConfirmDialog").dialog({close:function(a,c){}});$("#buyConfirmDialog").dialog("close");Dialog.prototype.hide.call(this);return this}});var BuyStatus=Dialog.extend({classId:"BuyStatus",init:function(){Dialog.prototype.init.call(this);this.closeButton.hide();this._underlay.hide()},startTransaction:function(){this.infoDialog=(new BuyConfirm(GameConfig.config.buyingString,null,!0)).layer(1).show().mount(ige.$("uiScene"))},transactionSuccess:function(a,c){var b;dataLayer.push({event:"transactionSuccess"});this.infoDialog.closeMe();b=GameConfig.config.transactionSuccessString;b=b.replace(/\{amount\}/g,a);b=b.replace(/\{vbucks\}/g,c);(new BuyConfirm(b,
null,!0)).layer(1).show().mount(ige.$("uiScene"))},transactionFailed:function(a){dataLayer.push({event:"transactionFail"});this.infoDialog.closeMe();(new BuyConfirm(GameConfig.config.transactionFailString,a,!0)).layer(1).show().mount(ige.$("uiScene"))}});var CashDialog=Dialog.extend({classId:"CashDialog",init:function(){Dialog.prototype.init.call(this);var a,c,b;a=GameConfig.config.cashDialogBucks.split(",").map(parseFloat);c=GameConfig.config.cashDialogPays.split(",").map(parseFloat);for(var d=0;5>d;d++)b=$("#cashAssetList li").first().clone(),b.find(".assetAmount").first().text(a[d]+" VBucks for "),b.find(".assetPay").first().text(c[d]+"  USD"),function(d){b.click(function(){ige.input.stopPropagation();vlg.sfx.select.play();var b={cash:a[d],coins:0};
(new BuyConfirm("Buy "+a[d]+" VBucks for $"+c[d]+"?",function(){Buy.buy(b)})).layer(1).show().mount(ige.$("uiScene"))})}(d),$("#cashAssetList").append(b);$("#cashAssetList li").first().hide();this.closeButton.hide();this._underlay.hide()},show:function(){var a=this;ige.client.fsm.enterState("cashDialog",null,function(c){c||($("#cashBuyDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(b,c){a.closeMe()}}),$("#cashBuyDialog").dialog("open"),
Dialog.prototype.show.call(a))});return this},hide:function(){$("#cashBuyDialog").dialog({close:function(a,c){}});$("#cashBuyDialog").dialog("close");Dialog.prototype.hide.call(this);return this}});var CoinDialog=Dialog.extend({classId:"CoinDialog",init:function(){Dialog.prototype.init.call(this);var a,c,b;a=GameConfig.config.coinDialogCoins.split(",").map(parseFloat);c=GameConfig.config.coinDialogPays.split(",").map(parseFloat);for(var d=0;5>d;d++)b=$("#coinAssetList li").first().clone(),b.find(".assetAmount").first().text(a[d]+" Coins for "),b.find(".assetPay").first().text(c[d]+" VBuck"+(1<c[d]?"s":"")),function(d){b.click(function(){ige.input.stopPropagation();vlg.sfx.select.play();var b=
c[d],e="Buy "+a[d]+" coins for "+c[d]+" VBuck"+(1<c[d]?"s":"")+"?",p=function(){API.reduceAssets({coins:0,cash:parseInt(b,10)}).status?(dataLayer.push({assetBuyActionName:"Coin Buy"}),dataLayer.push({event:"assetBuy"}),API.addCoins(parseInt(a[d],10))):(ga("send",  "Not enough money"),ige.$("cashDialog").show())};b>API.state.cash&&(ga("send",  "Not enough money"),e=GameConfig.config.notEnoughCashString,p=function(){ige.$("cashDialog").show()});(new BuyConfirm(e,p)).layer(1).show().mount(ige.$("uiScene"))})}(d),
$("#coinAssetList").append(b);$("#coinAssetList li").first().hide();this.closeButton.hide();this._underlay.hide()},show:function(){var a=this;ige.client.fsm.enterState("coinDialog",null,function(c){c||($("#coinBuyDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(b,c){a.closeMe()}}),$("#coinBuyDialog").dialog("open"),Dialog.prototype.show.call(a))});return this},hide:function(){$("#coinBuyDialog").dialog({close:function(a,c){}});
$("#coinBuyDialog").dialog("close");Dialog.prototype.hide.call(this);return this}});var CoinParticle=IgeParticle.extend({classId:"CoinParticle",init:function(a){IgeParticle.prototype.init.call(this,a);this.texture(ige.client.textures.coin).dimensionsFromTexture()}});var Dialog=IgeUiElement.extend({classId:"Dialog",init:function(){IgeUiElement.prototype.init.call(this);var a=this;this.styleClass("dialog").addGroup("dialog");this._underlay=(new IgeUiElement).id("underlay_"+this.id()).layer(-1).styleClass("underlay").mouseDown(function(){ige.input.stopPropagation()}).mouseUp(function(){ige.input.stopPropagation();a.closeMe()}).mount(this);this.closeButton=(new IgeEntity).id("closeButton_"+this.id()).layer(2).texture(ige.client.textures.closeButton).dimensionsFromTexture().mouseDown(function(){ige.input.stopPropagation()}).mouseUp(function(){ige.input.stopPropagation();
a.closeMe()}).mount(this)},closeMe:function(){this.hide();void 0!==ige.client.isEditorOn&&!0===ige.client.isEditorOn?ige.client.fsm.enterState("editor"):ige.client.fsm.enterState("select")}});var EditorMarketDialog=Dialog.extend({classId:"EditorMarketDialog",init:function(){Dialog.prototype.init.call(this);EditorMarketDialog.prototype.isMarketSet=EditorMarketDialog.prototype.isMarketSet||!1;this.itemCount=parseInt(GameConfig.config.itemcount);this._pageRefs=[];this._items=[];this._pageItems=[];this._pageCount=0;this._activePageNo=1;$("#editorMarketDialogPageTemplate ul li").first().hide();this.closeButton.hide();this._underlay.hide()},createSinglePage:function(){var a;a=$("#editorMarketDialogPageTemplate").clone().prop({id:"editorMarketDialogPage"+
this._pageCount}).insertBefore("#editorMarketDialogPagination").hide();$("#editorMarketDialogPage"+this._pageCount+" li").remove();this._pageRefs["editorMarketDialogPage"+this._pageCount]=a},createPages:function(a){for(var c=this,b=0;b<a;b++)c._pageCount++,c.createSinglePage();c.pageTemplate=$("#editorMarketDialogPageTemplate");$("#editorMarketDialogPagination").jqPagination({max_page:a,paged:function(a){c.changeToPage(a)}});c._pageRefs["editorMarketDialogPage"+c._activePageNo].show()},changeToPage:function(a){this._pageRefs["editorMarketDialogPage"+
this._activePageNo].hide();this._activePageNo=a;this._pageRefs["editorMarketDialogPage"+a].show()},show:function(){var a=this;ige.client.fsm.enterState("editorMarketDialog",null,function(c){c||($("#editorMarketDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(b,c){a.closeMe()}}),$("#editorMarketDialog").dialog("open"),Dialog.prototype.show.call(a),vlg.sfx.select.play())});return this},hide:function(){var a=this;"editorMarketDialog"===
ige.client.fsm.currentStateName?ige.client.fsm.exitState(function(c){c||($("#editorMarketDialog").dialog(),$("#editorMarketDialog").dialog("close"),Dialog.prototype.hide.call(a))}):($("#editorMarketDialog").dialog(),$("#editorMarketDialog").dialog("close"),Dialog.prototype.hide.call(a));return this},addItem:function(a){var c=this,b=1,d,e,h,g,p;d=$("#editorMarketDialogPageTemplate ul li").first().clone();d.show().find(".marketItemTitle").first().text(a.title);e=GameObjects.catalogLookup[a.classId];
h=$("<div class='marketItemImage'></div>").hide().appendTo("body");p=h.css("height").substr(0,h.css("height").indexOf("px"));g=ige.client.textures[a.classId]._sizeX/(ige.client.textures[a.classId]._sizeY/p);h.remove();d.find(".marketItemImage").first().css("background-image","url("+e.textureUrl+")").css("background-size",g+"px "+p+"px").css("background-position-x",g/ige.client.textures[a.classId]._cellColumns+"px");d.click(function(){ige.input.stopPropagation();vlg.sfx.select.play();c.hide();ige.client.fsm.enterState("editorBuild",
{classId:a.classId,coins:a.coins,cash:a.cash})});for(this._items.push(a);this._pageItems[b]&&this._pageItems[b].length===this.itemCount;)b++;$("#editorMarketDialogPage"+b+" ul").append(d);this._pageItems[b]=this._pageItems[b]||[];this._pageItems[b].push(a);return d}});var EditorViews=IgeClass.extend({classId:"EditorViews",init:function(){this.viewsLookup=[];for(var a=0;a<this.views.length;a++)this.viewsLookup[this.views[a].id]=this.views[a]},views:[{id:"init",view:'<div><p><button id="newVillageButton">New</button></p><p><button id="loadVillagesButton">Load</button></p><p><button id="cancelEditorModeButton">Quit</button></p></div>'},{id:"new",view:'<div><p><form action="javascript:void(0);"><div><label style="display: inline-block;width: 220px;text-align: right;" for="newVillageTitle">Title:</label><input type="text" id="newVillageTitle" /></div><div id="newVillageErrorField" class="ui-state-error" style="display:none;font-size:14px;">Please fill in the "Title" field</div><div><label style="display: inline-block;width: 220px;text-align: right;" for="newVillageOrganization">Organization(optional):</label><input type="text" id="newVillageOrganization" /></div><div><label for="newVillageViewable">Viewable:</label><input type="checkbox" checked id="newVillageViewable"></input></div><div><button id="createNewVillageButton">Create</button></div><div><button id="cancelCreateNewVillageButton">Back</button></div></form></p></div>'},
{id:"load",view:'<table id="loadedVillagesTable" style="width:100%;"><tr><th>Title</th><th>Organization</th><th>Load</th><th>Edit</th><th>Delete</th><th>View</th><th>Share</th></tr></table><p><button id="cancelLoadVillageButton">Back</button></p>'},{id:"edit",view:'<div><p><form action="javascript:void(0);"><div><label style="display: inline-block;width: 220px;text-align: right;" for="newVillageTitle">Title:</label><input type="text" id="editVillageTitle" /></div><div id="editVillageErrorField" class="ui-state-error" style="display:none;font-size:14px;">Please fill in the "Title" field</div><div><label style="display: inline-block;width: 220px;text-align: right;" for="editVillageOrganization">Organization(optional):</label><input type="text" id="editVillageOrganization" /></div><div><label for="editVillageViewable">Viewable:</label><input type="checkbox" checked id="editVillageViewable"></input></div><div><button id="editVillageButton">Save</button></div><div><button id="cancelEditVillageButton">Cancel</button></div></form></p></div>'},
{id:"warnBeforeQuit",view:'<div><p>You have unsaved changes. Save before quit?</p><p><button id="yesWarningButton">Yes</button></p><p><button id="noWarningButton">No</button></p><p><button id="cancelWarningButton">Cancel</button></p></div>'},{id:"warnBeforeDelete",view:'<div><p>You can\'t undo delete! Are you sure to delete:</p><p id="deleteVillageTitle"></p><div><label style="display: inline-block;width: 220px;text-align: right;" for="deleteVillageTitleInput">Write the title here:</label><input type="text" id="deleteVillageTitleInput" /><div id="deleteVillageErrorField" class="ui-state-error" style="display:none;font-size:14px;">Please fill in the "Title" field</div></div><p><button id="yesDeleteButton">Delete</button></p><p><button id="cancelDeleteButton">Cancel</button></p></div>'},
{id:"share",view:'<div><p>Share Village:</p><p id="shareVillageTitle"></p><div><textarea id="shareTextArea" style="width:428px;"></textarea><div id="shareVillageErrorField" class="ui-state-error" style="display:none;font-size:14px;">Your browser doesn\'t support copying. Please copy manually</div><button id="copyClipboardButton">Copy to Clipboard</button></div><p><button id="cancelShareButton">Back</button></p></div>'}],getViewByID:function(a){return this.viewsLookup[a]}});var MarketDialog=Dialog.extend({classId:"MarketDialog",init:function(){Dialog.prototype.init.call(this);this.itemCount=parseInt(GameConfig.config.itemCount);this._pageRefs=[];this._items=[];this._pageItems=[];this._pageCount=0;this._activePageNo=1;$("#marketDialogPageTemplate ul li").first().hide();this.closeButton.hide();this._underlay.hide()},createSinglePage:function(){var a;a=$("#marketDialogPageTemplate").clone().prop({id:"marketDialogPage"+this._pageCount}).insertBefore("#marketDialogPagination").hide();
$("#marketDialogPage"+this._pageCount+" li").remove();this._pageRefs["marketDialogPage"+this._pageCount]=a},createPages:function(a){for(var c=this,b=0;b<a;b++)c._pageCount++,c.createSinglePage();c.pageTemplate=$("#marketDialogPageTemplate");$("#marketDialogPagination").jqPagination({max_page:a,paged:function(a){c.changeToPage(a)}});c._pageRefs["marketDialogPage"+c._activePageNo].show()},changeToPage:function(a){this._pageRefs["marketDialogPage"+this._activePageNo].hide();this._activePageNo=a;this._pageRefs["marketDialogPage"+
a].show()},show:function(){var a=this;ige.client.fsm.enterState("marketDialog",null,function(c){c||($("#marketDialog").dialog({resizable:!0,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(b,c){a.closeMe()}}),$("#marketDialog").dialog("open"),Dialog.prototype.show.call(a))});return this},hide:function(){$("#marketDialog").dialog({close:function(a,c){}});$("#marketDialog").dialog("close");Dialog.prototype.hide.call(this);return this},addItem:function(a){var c=
this,b=1,d,e;d=$("#marketDialogPageTemplate ul li").first().clone();d.show().find(".marketItemTitle").first().text(a.title);e=GameObjects.catalogLookup[a.id];$("<div class='marketItemImage'></div>").hide().appendTo("body");d.find(".marketItemImage").first().attr("src",e.iconUrl);0!=a.coins?d.find(".marketItemCoins").contents().last()[0].textContent=a.coins:d.find(".marketItemCoins").first().remove();0!=a.cash?d.find(".marketItemCash").contents().last()[0].textContent=a.cash:d.find(".marketItemCash").first().remove();
a.entity=d;a.unlockButton=d.find(".unlock").first();a.unlockprice=a.unlockButton.find(".unlockprice").first();a.unlockInfo=d.find(".marketItemInfo").first();"none"===a.dependency||0<=$.inArray(a.id,API.state.unlockedItems)?(c.removeItemCover(a),c.bindItemAction(a)):(d.addClass("locked"),a.unlockprice.text(a.unlockValue),a.unlockButton.click(function(b){b.stopPropagation();c.hide();c.unlockItemByCash(a)}),a.unlockInfo.attr("title","Unlocked by Building "+GameObjects.catalogLookup[a.dependency].name),
a.unlockInfo.tooltip({position:{my:"right center",at:"left center"}}));for(this._items.push(a);this._pageItems[b]&&this._pageItems[b].length===this.itemCount;)b++;$("#marketDialogPage"+b+" ul").append(d);this._pageItems[b]=this._pageItems[b]||[];this._pageItems[b].push(a);return d},unlockItemByCash:function(a){var c,b,d=this;b=a.unlockValue;c="Unlock "+a.title+" for "+b+" VBuck"+(1<b?"s":"")+"?";callBack=function(){API.reduceAssets({coins:0,cash:parseInt(b,10)}).status?(dataLayer.push({event:"unlockItemByCash"}),
d.removeItemCover(a),d.bindItemAction(a),ige.client.gameLogic.showUnlockedItemMessage(a.id),API.addUnlockedItem(a.id)):(ga("send",  "Not enough money"),(new BuyConfirm(GameConfig.config.notEnoughCashString,function(){ige.$("cashDialog").show()})).layer(1).show().mount(ige.$("uiScene")))};(new BuyConfirm(c,callBack)).layer(100).show().mount(ige.$("uiScene"))},removeItemCover:function(a){a.unlockButton&&(a.unlockButton.remove(),a.unlockButton=null,a.unlockInfo.remove(),a.unlockInfo=null,a.entity.removeClass("locked"))},
bindItemAction:function(a){void 0!==a.isActionBound&&null!==a.isActionBound||a.entity.click(function(){ige.input.stopPropagation();vlg.sfx.select.play();ige.client.fsm.enterState("build",{classId:a.classId,coins:a.coins,cash:a.cash})});a.isActionBound=!0},getItemByID:function(a){for(var c=0;c<this._items.length;c++)if(this._items[c].id==a)return this._items[c];return null}});var MessageDialog=Dialog.extend({classId:"MessageDialog",init:function(a,c,b){Dialog.prototype.init.call(this);var d=this;d.title=a;d.callback=b;$("#messageDialogMessage").html(c);$("#messageDialogOK").click(function(){$("#messageDialogOK").unbind("click");d.closeMe()}).show();this.closeButton.hide();this._underlay.hide()},show:function(){var a=this;$("#messageDialog").dialog({title:a.title,resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(c,
b){$("#messageDialogOK").unbind("click");a.closeMe()}});$("#messageDialog").dialog("open");Dialog.prototype.show.call(a);return this},hide:function(){$("#messageDialog").dialog({close:function(a,c){}});$("#messageDialog").dialog("close");Dialog.prototype.hide.call(this);return this}});var TutorialViews=IgeClass.extend({classId:"TutorialViews",init:function(){this.viewsLookup=[];for(var a=0;a<this.views.length;a++)this.viewsLookup[this.views[a].id]=this.views[a]},views:[{id:"welcomeScreen",view:"<div><p>"+GameConfig.config.welcomeScreen+'</p><button id="dialogButton">Play</button></div>'},{id:"speedProgressInfoScreen",view:"<div><p>"+GameConfig.config.speedProgressInfoScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"speedProgressScreen",view:"<div><p>"+GameConfig.config.speedProgressScreen+
'</p><button id="dialogButton">Yes</button></div>'},{id:"firstHomeBuiltScreen",view:"<div><p>"+GameConfig.config.firstHomeBuiltScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"fastForwardScreen",view:"<div><p>"+GameConfig.config.fastForwardScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"notEnoughMoneyScreen",view:"<div><p>"+GameConfig.config.notEnoughMoneyScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"creditCardScreen",view:"<div><p>"+
GameConfig.config.creditCardScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"newGoalFirstScreen",view:"<div><p>"+GameConfig.config.newGoalFirstScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"newGoalSecondScreen",view:"<div><p>"+GameConfig.config.newGoalSecondScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"newGoalThirdScreen",view:"<div><p>"+GameConfig.config.newGoalThirdScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"newGoalFourthScreen",
view:"<div><p>"+GameConfig.config.newGoalFourthScreen+'</p><button id="dialogButton">Continue</button></div>'},{id:"finishTutorial",view:"<div><p>"+GameConfig.config.finishTutorial+'</p><button id="dialogButton">Play</button></div>'}],getViewByID:function(a){return this.viewsLookup[a]}});var WaterDialog=Dialog.extend({classId:"WaterDialog",init:function(){Dialog.prototype.init.call(this);var a,c,b;a=GameConfig.config.waterDialogWater.split(",").map(parseFloat);c=GameConfig.config.waterDialogPays.split(",").map(parseFloat);for(var d=0;5>d;d++)b=$("#waterAssetList li").first().clone(),b.find(".assetAmount").first().text(a[d]+" Water for "),b.find(".assetPay").first().text(c[d]+" VBuck"+(1<c[d]?"s":"")),function(d){b.click(function(){ige.input.stopPropagation();vlg.sfx.select.play();
var b=c[d],e="Buy "+a[d]+" water for "+c[d]+" VBuck"+(1<c[d]?"s":"")+"?",p=function(){API.reduceAssets({coins:0,cash:parseInt(b,10)}).status?(dataLayer.push({assetBuyActionName:"Water Buy"}),dataLayer.push({event:"assetBuy"}),API.addWater(parseInt(a[d],10))):(ga("send",  "Not enough money"),ige.$("cashDialog").show())};b>API.state.cash&&(ga("send",  "Not enough money"),e=GameConfig.config.notEnoughCashString,p=function(){ige.$("cashDialog").show()});(new BuyConfirm(e,p)).layer(1).show().mount(ige.$("uiScene"))})}(d),
$("#waterAssetList").append(b);$("#waterAssetList li").first().hide();this.closeButton.hide();this._underlay.hide()},show:function(){var a=this;ige.client.fsm.enterState("waterDialog",null,function(c){c||($("#waterBuyDialog").dialog({resizable:!1,draggable:!0,closeOnEscape:!1,width:"auto",height:"auto",modal:!0,autoOpen:!1,close:function(b,c){a.closeMe()}}),$("#waterBuyDialog").dialog("open"),Dialog.prototype.show.call(a))});return this},hide:function(){$("#waterBuyDialog").dialog({close:function(a,
c){}});$("#waterBuyDialog").dialog("close");Dialog.prototype.hide.call(this);return this}});var CryptoJS=CryptoJS||function(a,c){var b={},d=b.lib={},e=function(){},h=d.Base={extend:function(a){e.prototype=this;var f=new e;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
g=d.WordArray=h.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=c?f:4*a.length},toString:function(a){return(a||q).stringify(this)},concat:function(a){var f=this.words,b=a.words,c=this.sigBytes;a=a.sigBytes;this.clamp();if(c%4)for(var d=0;d<a;d++)f[c+d>>>2]|=(b[d>>>2]>>>24-d%4*8&255)<<24-(c+d)%4*8;else if(65535<b.length)for(d=0;d<a;d+=4)f[c+d>>>2]=b[d>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var b=this.words,f=this.sigBytes;b[f>>>2]&=4294967295<<32-
f%4*8;b.length=a.ceil(f/4)},clone:function(){var a=h.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var f=[],c=0;c<b;c+=4)f.push(4294967296*a.random()|0);return new g.init(f,b)}}),p=b.enc={},q=p.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],c=0;c<a;c++){var d=f[c>>>2]>>>24-c%4*8&255;b.push((d>>>4).toString(16));b.push((d&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],c=0;c<f;c+=2)b[c>>>3]|=parseInt(a.substr(c,2),16)<<
24-c%8*4;return new g.init(b,f/2)}},t=p.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],c=0;c<a;c++)b.push(String.fromCharCode(f[c>>>2]>>>24-c%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],c=0;c<f;c++)b[c>>>2]|=(a.charCodeAt(c)&255)<<24-c%4*8;return new g.init(b,f)}},x=p.Utf8={stringify:function(a){try{return decodeURIComponent(escape(t.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return t.parse(unescape(encodeURIComponent(a)))}},
w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var f=this._data,c=f.words,d=f.sigBytes,e=this.blockSize,h=d/(4*e),h=b?a.ceil(h):a.max((h|0)-this._minBufferSize,0);b=h*e;d=a.min(4*b,d);if(b){for(var p=0;p<b;p+=e)this._doProcessBlock(c,p);p=c.splice(0,b);f.sigBytes-=d}return new g.init(p,d)},clone:function(){var a=h.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,b){return(new G.HMAC.init(a,
b)).finalize(f)}}});var G=b.algo={};return b}(Math);
(function(){var a=CryptoJS,c=a.lib,b=c.WordArray,d=c.Hasher,e=[],c=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],g=c[1],h=c[2],w=c[3],G=c[4],k=0;80>k;k++){if(16>k)e[k]=a[b+k]|0;else{var f=e[k-3]^e[k-8]^e[k-14]^e[k-16];e[k]=f<<1|f>>>31}f=(d<<5|d>>>27)+G+e[k];f=20>k?f+((g&h|~g&w)+1518500249):40>k?f+((g^h^w)+1859775393):60>k?f+((g&h|g&w|h&w)-1894007588):f+((g^h^
w)-899497514);G=w;w=h;h=g<<30|g>>>2;g=d;d=f}c[0]=c[0]+d|0;c[1]=c[1]+g|0;c[2]=c[2]+h|0;c[3]=c[3]+w|0;c[4]=c[4]+G|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(c);a.HmacSHA1=d._createHmacHelper(c)})();
(function(){var a=CryptoJS,c=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,d){a=this._hasher=new a.init;"string"==typeof d&&(d=c.parse(d));var b=a.blockSize,h=4*b;d.sigBytes>h&&(d=a.finalize(d));d.clamp();for(var g=this._oKey=d.clone(),p=this._iKey=d.clone(),q=g.words,t=p.words,x=0;x<b;x++)q[x]^=1549556828,t[x]^=909522486;g.sigBytes=p.sigBytes=h;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=
this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();/*
 howler.js v1.1.29
  howlerjs.com

  (c) 2013-2016, James Simpson of GoldFire Studios
  goldfirestudios.com

  MIT License
*/
(function(){var a={},c=null,b=!0,d=!1;try{"undefined"!==typeof AudioContext?c=new AudioContext:"undefined"!==typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!==typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"===typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){a=parseFloat(a);if(0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var f in this._howls)if(this._howls.hasOwnProperty(f)&&!1===this._howls[f]._webAudio)for(a=0;a<this._howls[f]._audioNode.length;a++)this._howls[f]._audioNode[a].volume=this._howls[f]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){this._setMuted(!0);return this},unmute:function(){this._setMuted(!1);return this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var f in this._howls)if(this._howls.hasOwnProperty(f)&&!1===this._howls[f]._webAudio)for(var c=0;c<this._howls[f]._audioNode.length;c++)this._howls[f]._audioNode[c].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var f=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=f;d.connect(c.destination);"undefined"===typeof d.start?
d.noteOn(0):d.start(0);setTimeout(function(){if(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1)},0)};window.addEventListener("touchend",b,!1);return a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!==typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};t.prototype={load:function(){var a=this,b=null;if(d)a.on("loaderror",Error("No audio support."));else{for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else if(g=a._urls[c],(e=/^data:audio\/([^;,]+);/i.exec(g))||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),e)e=e[1].toLowerCase();else{a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
return}if(p[e]){b=a._urls[c];break}}if(b){a._src=b;if(a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));
a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a}a.on("loaderror",Error("No codec support for selected audio sources."))}},urls:function(a){return a?(this.stop(),this._urls="string"===typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var f=this;"function"===typeof a&&(b=a);a&&"function"!==typeof a||(a="_default");if(!f._loaded)return f.on("load",function(){f.play(a,b)}),f;if(!f._sprite[a])return"function"===
typeof b&&b(),f;f._inactiveNode(function(d){d._sprite=a;var l=0<d._pos?d._pos:f._sprite[a][0]/1E3,m=0;f._webAudio?(m=f._sprite[a][1]/1E3-d._pos,0<d._pos&&(l=f._sprite[a][0]/1E3+l)):m=f._sprite[a][1]/1E3-(l-f._sprite[a][0]/1E3);var e=!(!f._loop&&!f._sprite[a][2]),g="string"===typeof b?b:Math.round(Date.now()*Math.random())+"",n;(function(){n=setTimeout(function(){!f._webAudio&&e&&f.stop(g).play(a,g);f._webAudio&&!e&&(f._nodeById(g).paused=!0,f._nodeById(g)._pos=0,f._clearEndTimer(g));f._webAudio||
e||f.stop(g);f.on("end",g)},m/f._rate*1E3);f._onendTimer.push({timer:n,id:g})})();if(f._webAudio){var h=f._sprite[a][0]/1E3,p=f._sprite[a][1]/1E3;d.id=g;d.paused=!1;k(f,[e,h,p],g);f._playStart=c.currentTime;d.gain.value=f._volume;"undefined"===typeof d.bufferSource.start?e?d.bufferSource.noteGrainOn(0,l,86400):d.bufferSource.noteGrainOn(0,l,m):e?d.bufferSource.start(0,l,86400):d.bufferSource.start(0,l,m)}else if(4===d.readyState||!d.readyState&&navigator.isCocoonJS)d.readyState=4,d.id=g,d.currentTime=
l,d.muted=q._muted||d.muted,d.volume=f._volume*q.volume(),setTimeout(function(){d.play()},0);else return f._clearEndTimer(g),function(){var c=a,l=b,m=function(){f.play(c,l);d.removeEventListener("canplaythrough",m,!1)};d.addEventListener("canplaythrough",m,!1)}(),f;f.on("play");"function"===typeof b&&b(g);return f});return f},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var f=a?b._nodeById(a):b._activeNode();if(f)if(f._pos=b.pos(null,
a),b._webAudio){if(!f.bufferSource||f.paused)return b;f.paused=!0;"undefined"===typeof f.bufferSource.stop?f.bufferSource.noteOff(0):f.bufferSource.stop(0)}else f.pause();b.on("pause");return b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var f=a?b._nodeById(a):b._activeNode();if(f)if(f._pos=0,b._webAudio){if(!f.bufferSource||f.paused)return b;f.paused=!0;"undefined"===typeof f.bufferSource.stop?f.bufferSource.noteOff(0):f.bufferSource.stop(0)}else isNaN(f.duration)||
(f.pause(),f.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var f=a?b._nodeById(a):b._activeNode();f&&(b._webAudio?f.gain.value=0:f.muted=!0);return b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var f=a?b._nodeById(a):b._activeNode();f&&(b._webAudio?f.gain.value=b._volume:f.muted=!1);return b},volume:function(a,b){var f=this;a=parseFloat(a);if(0<=a&&1>=a){f._volume=a;if(!f._loaded)return f.on("play",
function(){f.volume(a,b)}),f;var c=b?f._nodeById(b):f._activeNode();c&&(f._webAudio?c.gain.value=a:c.volume=a*q.volume());return f}return f._volume},loop:function(a){return"boolean"===typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"===typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var f=this;if(!f._loaded)return f.on("load",function(){f.pos(a)}),"number"===typeof a?f:f._pos||0;a=parseFloat(a);var d=b?f._nodeById(b):f._activeNode();if(d)return 0<=a?(f.pause(b),
d._pos=a,f.play(d._sprite,b),f):f._webAudio?d._pos+(c.currentTime-f._playStart):d.currentTime;if(0<=a)return f;for(d=0;d<f._audioNode.length;d++)if(f._audioNode[d].paused&&4===f._audioNode[d].readyState)return f._webAudio?f._audioNode[d]._pos:f._audioNode[d].currentTime},pos3d:function(a,b,c,d){var f=this;b="undefined"!==typeof b&&b?b:0;c="undefined"!==typeof c&&c?c:-.5;if(!f._loaded)return f.on("play",function(){f.pos3d(a,b,c,d)}),f;if(0<=a||0>a){if(f._webAudio){var l=d?f._nodeById(d):f._activeNode();
l&&(f._pos3d=[a,b,c],l.panner.setPosition(a,b,c),l.panner.panningModel=f._model||"HRTF")}}else return f._pos3d;return f},fade:function(a,b,c,d,e){var f=this,l=a>b?"down":"up",m=Math.abs(a-b)/.01,g=c/m;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var n=1;n<=m;n++)(function(){var a=Math.round(1E3*(f._volume+("up"===l?.01:-.01)*n))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},g*n)})()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},
fadeOut:function(a,b,c,d){var f=this;return f.fade(f._volume,a,b,function(){c&&c();f.pause(d);f.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],f=0;f<this._audioNode.length;f++)if(this._audioNode[f].id===a){b=this._audioNode[f];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}this._drainPool();return a},_inactiveNode:function(a){for(var b=null,f=0;f<this._audioNode.length;f++)if(this._audioNode[f].paused&&
4===this._audioNode[f].readyState){a(this._audioNode[f]);b=!0;break}this._drainPool();if(!b){var c;if(this._webAudio)c=this._setupAudioNode(),a(c);else{this.load();c=this._audioNode[this._audioNode.length-1];var d=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",e=function(){c.removeEventListener(d,e,!1);a(c)};c.addEventListener(d,e,!1)}}},_drainPool:function(){var a=0,b;for(b=0;b<this._audioNode.length;b++)this._audioNode[b].paused&&a++;for(b=this._audioNode.length-1;0<=b&&!(5>=a);b--)this._audioNode[b].paused&&
(this._webAudio&&this._audioNode[b].disconnect(0),a--,this._audioNode.splice(b,1))},_clearEndTimer:function(a){for(var b=-1,f=0;f<this._onendTimer.length;f++)if(this._onendTimer[f].id===a){b=f;break}if(a=this._onendTimer[b])clearTimeout(a.timer),this._onendTimer.splice(b,1)},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;a[b]="undefined"===typeof c.createGain?c.createGainNode():c.createGain();a[b].gain.value=this._volume;a[b].paused=!0;a[b]._pos=0;a[b].readyState=4;a[b].connect(e);
a[b].panner=c.createPanner();a[b].panner.panningModel=this._model||"equalpower";a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]);a[b].panner.connect(a[b]);return a[b]},on:function(a,b){var f=this["_on"+a];if("function"===typeof b)f.push(b);else for(var c=0;c<f.length;c++)b?f[c].call(this,b):f[c].call(this);return this},off:function(a,b){var f=this["_on"+a];if(b)for(var c=0;c<f.length;c++){if(b===f[c]){f.splice(c,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}};if(b)var x=function(b,c){if(c in a)b._duration=a[c].duration,G(b);else if(/^data:[^;]+;base64,/.test(c)){for(var f=atob(c.split(",")[1]),d=new Uint8Array(f.length),e=0;e<f.length;++e)d[e]=
f.charCodeAt(e);w(d.buffer,b,c)}else{var l=new XMLHttpRequest;l.open("GET",c,!0);l.responseType="arraybuffer";l.onload=function(){w(l.response,b,c)};l.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{l.send()}catch(H){l.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"===typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!==typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!==typeof window&&(window.Howler=q,window.Howl=t)})();!function(){var a={},c=null,b=!0,d=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!=typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"==typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){if(a=parseFloat(a),0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var f in this._howls)if(this._howls.hasOwnProperty(f)&&!1===this._howls[f]._webAudio)for(a=0;a<this._howls[f]._audioNode.length;a++)this._howls[f]._audioNode[a].volume=this._howls[f]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var f in this._howls)if(this._howls.hasOwnProperty(f)&&!1===this._howls[f]._webAudio)for(var c=0;c<this._howls[f]._audioNode.length;c++)this._howls[f]._audioNode[c].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var f=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=f;d.connect(c.destination);"undefined"==typeof d.start?
d.noteOn(0):d.start(0);setTimeout(function(){d.playbackState!==d.PLAYING_STATE&&d.playbackState!==d.FINISHED_STATE||(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1))},0)};return window.addEventListener("touchend",b,!1),a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!=typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};if(t.prototype={load:function(){var a=this,b=null;if(d)return void a.on("loaderror",Error("No audio support."));for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else{if(g=a._urls[c],e=/^data:audio\/([^;,]+);/i.exec(g),e||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),!e)return void a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
e=e[1].toLowerCase()}if(p[e]){b=a._urls[c];break}}if(!b)return void a.on("loaderror",Error("No codec support for selected audio sources."));if(a._src=b,a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a},urls:function(a){return a?(this.stop(),this._urls="string"==typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var f=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),f._loaded?f._sprite[a]?(f._inactiveNode(function(d){d._sprite=a;var e=
0<d._pos?d._pos:f._sprite[a][0]/1E3,l=0;f._webAudio?(l=f._sprite[a][1]/1E3-d._pos,0<d._pos&&(e=f._sprite[a][0]/1E3+e)):l=f._sprite[a][1]/1E3-(e-f._sprite[a][0]/1E3);var m,g=!(!f._loop&&!f._sprite[a][2]),h="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){m=setTimeout(function(){!f._webAudio&&g&&f.stop(h).play(a,h);f._webAudio&&!g&&(f._nodeById(h).paused=!0,f._nodeById(h)._pos=0,f._clearEndTimer(h));f._webAudio||g||f.stop(h);f.on("end",h)},l/f._rate*1E3);f._onendTimer.push({timer:m,
id:h})}(),f._webAudio){var n=f._sprite[a][0]/1E3,p=f._sprite[a][1]/1E3;d.id=h;d.paused=!1;k(f,[g,n,p],h);f._playStart=c.currentTime;d.gain.value=f._volume;"undefined"==typeof d.bufferSource.start?g?d.bufferSource.noteGrainOn(0,e,86400):d.bufferSource.noteGrainOn(0,e,l):g?d.bufferSource.start(0,e,86400):d.bufferSource.start(0,e,l)}else{if(4!==d.readyState&&(d.readyState||!navigator.isCocoonJS))return f._clearEndTimer(h),function(){var c=a,e=b,l=function(){f.play(c,e);d.removeEventListener("canplaythrough",
l,!1)};d.addEventListener("canplaythrough",l,!1)}(),f;d.readyState=4;d.id=h;d.currentTime=e;d.muted=q._muted||d.muted;d.volume=f._volume*q.volume();setTimeout(function(){d.play()},0)}return f.on("play"),"function"==typeof b&&b(h),f}),f):("function"==typeof b&&b(),f):(f.on("load",function(){f.play(a,b)}),f)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var f=a?b._nodeById(a):b._activeNode();if(f)if(f._pos=b.pos(null,a),b._webAudio){if(!f.bufferSource||
f.paused)return b;f.paused=!0;"undefined"==typeof f.bufferSource.stop?f.bufferSource.noteOff(0):f.bufferSource.stop(0)}else f.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var f=a?b._nodeById(a):b._activeNode();if(f)if(f._pos=0,b._webAudio){if(!f.bufferSource||f.paused)return b;f.paused=!0;"undefined"==typeof f.bufferSource.stop?f.bufferSource.noteOff(0):f.bufferSource.stop(0)}else isNaN(f.duration)||(f.pause(),
f.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var f=a?b._nodeById(a):b._activeNode();return f&&(b._webAudio?f.gain.value=0:f.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var f=a?b._nodeById(a):b._activeNode();return f&&(b._webAudio?f.gain.value=b._volume:f.muted=!1),b},volume:function(a,b){var f=this;if(a=parseFloat(a),0<=a&&1>=a){if(f._volume=a,!f._loaded)return f.on("play",
function(){f.volume(a,b)}),f;var c=b?f._nodeById(b):f._activeNode();return c&&(f._webAudio?c.gain.value=a:c.volume=a*q.volume()),f}return f._volume},loop:function(a){return"boolean"==typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"==typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var f=this;if(!f._loaded)return f.on("load",function(){f.pos(a)}),"number"==typeof a?f:f._pos||0;a=parseFloat(a);var d=b?f._nodeById(b):f._activeNode();if(d)return 0<=a?(f.pause(b),
d._pos=a,f.play(d._sprite,b),f):f._webAudio?d._pos+(c.currentTime-f._playStart):d.currentTime;if(0<=a)return f;for(d=0;d<f._audioNode.length;d++)if(f._audioNode[d].paused&&4===f._audioNode[d].readyState)return f._webAudio?f._audioNode[d]._pos:f._audioNode[d].currentTime},pos3d:function(a,b,c,d){var f=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!f._loaded)return f.on("play",function(){f.pos3d(a,b,c,d)}),f;if(!(0<=a||0>a))return f._pos3d;if(f._webAudio){var e=d?f._nodeById(d):
f._activeNode();e&&(f._pos3d=[a,b,c],e.panner.setPosition(a,b,c),e.panner.panningModel=f._model||"HRTF")}return f},fade:function(a,b,c,d,e){var f=this,l=a>b?"down":"up",m=Math.abs(a-b)/.01,g=c/m;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var h=1;m>=h;h++)!function(){var a=Math.round(1E3*(f._volume+("up"===l?.01:-.01)*h))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},g*h)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,
b,c,d){var f=this;return f.fade(f._volume,a,b,function(){c&&c();f.pause(d);f.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],f=0;f<this._audioNode.length;f++)if(this._audioNode[f].id===a){b=this._audioNode[f];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}return this._drainPool(),a},_inactiveNode:function(a){for(var b=null,f=0;f<this._audioNode.length;f++)if(this._audioNode[f].paused&&
4===this._audioNode[f].readyState){a(this._audioNode[f]);b=!0;break}if(this._drainPool(),!b){var c;if(this._webAudio)c=this._setupAudioNode(),a(c);else{this.load();c=this._audioNode[this._audioNode.length-1];var d=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",e=function(){c.removeEventListener(d,e,!1);a(c)};c.addEventListener(d,e,!1)}}},_drainPool:function(){var a,b=0;for(a=0;a<this._audioNode.length;a++)this._audioNode[a].paused&&b++;for(a=this._audioNode.length-1;0<=a&&!(5>=b);a--)this._audioNode[a].paused&&
(this._webAudio&&this._audioNode[a].disconnect(0),b--,this._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=-1,f=0;f<this._onendTimer.length;f++)if(this._onendTimer[f].id===a){b=f;break}(a=this._onendTimer[b])&&(clearTimeout(a.timer),this._onendTimer.splice(b,1))},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;return a[b]="undefined"==typeof c.createGain?c.createGainNode():c.createGain(),a[b].gain.value=this._volume,a[b].paused=!0,a[b]._pos=0,a[b].readyState=
4,a[b].connect(e),a[b].panner=c.createPanner(),a[b].panner.panningModel=this._model||"equalpower",a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]),a[b].panner.connect(a[b]),a[b]},on:function(a,b){var f=this["_on"+a];if("function"==typeof b)f.push(b);else for(var c=0;c<f.length;c++)b?f[c].call(this,b):f[c].call(this);return this},off:function(a,b){var f=this["_on"+a];if(b)for(var c=0;c<f.length;c++){if(b===f[c]){f.splice(c,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}},b)var x=function(b,c){if(c in a)return b._duration=a[c].duration,void G(b);if(/^data:[^;]+;base64,/.test(c)){for(var f=atob(c.split(",")[1]),d=new Uint8Array(f.length),e=0;e<f.length;++e)d[e]=
f.charCodeAt(e);w(d.buffer,b,c)}else{var l=new XMLHttpRequest;l.open("GET",c,!0);l.responseType="arraybuffer";l.onload=function(){w(l.response,b,c)};l.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{l.send()}catch(H){l.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!=typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!=typeof window&&(window.Howler=q,window.Howl=t)}();(function(a){var c={numberStep:function(b,c){var d=Math.floor(b);a(c.elem).text(d)}},b=function(a){var b=a.elem;b.nodeType&&b.parentNode&&(b=b._animateNumberSetter,b||(b=c.numberStep),b(a.now,a))};a.Tween&&a.Tween.propHooks?a.Tween.propHooks.number={set:b}:a.fx.step.number=b;a.animateNumber={numberStepFactories:{append:function(b){return function(c,d){var e=Math.floor(c);a(d.elem).prop("number",c).text(e+b)}},separator:function(b,c,h){b=b||" ";c=c||3;h=h||"";return function(d,e){var g=Math.floor(d).toString(),
p=a(e.elem);if(g.length>c){for(var x=g,w=c,G=x.split("").reverse(),g=[],k,f,l,m=0,n=Math.ceil(x.length/w);m<n;m++){k="";for(l=0;l<w;l++){f=m*w+l;if(f===x.length)break;k+=G[f]}g.push(k)}x=g.length-1;w=g[x].split("").reverse().join("");g[x]=parseInt(w,10).toString().split("").reverse().join("");g=g.join(b);g=g.split("").reverse().join("")}p.prop("number",d).text(g+h)}}}};a.fn.animateNumber=function(){for(var b=arguments[0],e=a.extend({},c,b),h=a(this),g=[e],p=1,q=arguments.length;p<q;p++)g.push(arguments[p]);
if(b.numberStep){var t=this.each(function(){this._animateNumberSetter=b.numberStep}),x=e.complete;e.complete=function(){t.each(function(){delete this._animateNumberSetter});x&&x.apply(this,arguments)}}return h.animate.apply(h,g)}})(jQuery);jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,c,b,d,e){return jQuery.easing[jQuery.easing.def](a,c,b,d,e)},easeInQuad:function(a,c,b,d,e){return d*(c/=e)*c+b},easeOutQuad:function(a,c,b,d,e){return-d*(c/=e)*(c-2)+b},easeInOutQuad:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c+b:-d/2*(--c*(c-2)-1)+b},easeInCubic:function(a,c,b,d,e){return d*(c/=e)*c*c+b},easeOutCubic:function(a,c,b,d,e){return d*((c=c/e-1)*c*c+1)+b},easeInOutCubic:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c+b:
d/2*((c-=2)*c*c+2)+b},easeInQuart:function(a,c,b,d,e){return d*(c/=e)*c*c*c+b},easeOutQuart:function(a,c,b,d,e){return-d*((c=c/e-1)*c*c*c-1)+b},easeInOutQuart:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c+b:-d/2*((c-=2)*c*c*c-2)+b},easeInQuint:function(a,c,b,d,e){return d*(c/=e)*c*c*c*c+b},easeOutQuint:function(a,c,b,d,e){return d*((c=c/e-1)*c*c*c*c+1)+b},easeInOutQuint:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c*c+b:d/2*((c-=2)*c*c*c*c+2)+b},easeInSine:function(a,c,b,d,e){return-d*Math.cos(c/
e*(Math.PI/2))+d+b},easeOutSine:function(a,c,b,d,e){return d*Math.sin(c/e*(Math.PI/2))+b},easeInOutSine:function(a,c,b,d,e){return-d/2*(Math.cos(Math.PI*c/e)-1)+b},easeInExpo:function(a,c,b,d,e){return 0==c?b:d*Math.pow(2,10*(c/e-1))+b},easeOutExpo:function(a,c,b,d,e){return c==e?b+d:d*(-Math.pow(2,-10*c/e)+1)+b},easeInOutExpo:function(a,c,b,d,e){return 0==c?b:c==e?b+d:1>(c/=e/2)?d/2*Math.pow(2,10*(c-1))+b:d/2*(-Math.pow(2,-10*--c)+2)+b},easeInCirc:function(a,c,b,d,e){return-d*(Math.sqrt(1-(c/=e)*
c)-1)+b},easeOutCirc:function(a,c,b,d,e){return d*Math.sqrt(1-(c=c/e-1)*c)+b},easeInOutCirc:function(a,c,b,d,e){return 1>(c/=e/2)?-d/2*(Math.sqrt(1-c*c)-1)+b:d/2*(Math.sqrt(1-(c-=2)*c)+1)+b},easeInElastic:function(a,c,b,d,e){a=0;var h=d;if(0==c)return b;if(1==(c/=e))return b+d;a||(a=.3*e);h<Math.abs(d)?(h=d,d=a/4):d=a/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*--c)*Math.sin(2*(c*e-d)*Math.PI/a))+b},easeOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(1==(c/=e))return b+d;h||
(h=.3*e);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*c)*Math.sin(2*(c*e-a)*Math.PI/h)+d+b},easeInOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(2==(c/=e/2))return b+d;h||(h=.3*e*1.5);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return 1>c?-.5*g*Math.pow(2,10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)+b:g*Math.pow(2,-10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)*.5+d+b},easeInBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*(c/=e)*c*((h+1)*
c-h)+b},easeOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*((c=c/e-1)*c*((h+1)*c+h)+1)+b},easeInOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return 1>(c/=e/2)?d/2*c*c*(((h*=1.525)+1)*c-h)+b:d/2*((c-=2)*c*(((h*=1.525)+1)*c+h)+2)+b},easeInBounce:function(a,c,b,d,e){return d-jQuery.easing.easeOutBounce(a,e-c,0,d,e)+b},easeOutBounce:function(a,c,b,d,e){return(c/=e)<1/2.75?7.5625*d*c*c+b:c<2/2.75?d*(7.5625*(c-=1.5/2.75)*c+.75)+b:c<2.5/2.75?d*(7.5625*(c-=2.25/2.75)*c+.9375)+b:d*(7.5625*
(c-=2.625/2.75)*c+.984375)+b},easeInOutBounce:function(a,c,b,d,e){return c<e/2?.5*jQuery.easing.easeInBounce(a,2*c,0,d,e)+b:.5*jQuery.easing.easeOutBounce(a,2*c-e,0,d,e)+.5*d+b}});/*
 FlexVerticalCenter.js 1.0

 Copyright 2011, Paul Sprangers http://paulsprangers.com
 Released under the WTFPL license
 http://sam.zoy.org/wtfpl/

 Date: Fri Oct 28 19:12:00 2011 +0100
*/
(function(a){a.fn.flexVerticalCenter=function(c){var b=a.extend({cssAttribute:"margin-top",verticalOffset:0,parentSelector:null,debounceTimeout:25,deferTilWindowLoad:!1},c||{});return this.each(function(){var c=a(this),e,h=function(){var a=b.parentSelector&&c.parents(b.parentSelector).length?c.parents(b.parentSelector).first().height():c.parent().height();c.css(b.cssAttribute,(a-c.height())/2+parseInt(b.verticalOffset));void 0!==b.complete&&b.complete()};a(window).resize(function(){clearTimeout(e);
e=setTimeout(h,b.debounceTimeout)});b.deferTilWindowLoad||h();a(window).load(function(){h()})})}})(jQuery);(function(a){function c(){return document[h?"webkit"===h?"webkitIsFullScreen":h+"FullScreen":"fullScreen"]}function b(){return document[h?h+"CancelFullScreen":"cancelFullScreen"]()}var d="undefined"!==typeof document.cancelFullScreen,e=["webkit","moz","o","ms","khtml"],h="",g=function(){},p;if(!d)for(p=0;h=e[p];p++)if("undefined"!==typeof document[h+"CancelFullScreen"]){d=!0;break}d?(a.fn.requestFullScreen=function(){return this.each(function(){return this[h?h+"RequestFullScreen":"requestFullScreen"]()})},
a.fn.fullScreenChange=function(b){var c=[h+"fullscreenchange"].concat([].slice.call(arguments,0)),d=a(this);return d.bind.apply(d,c)},a.FullScreen={isFullScreen:c,cancelFullScreen:b}):(a.fn.requestFullScreen=a.fn.fullScreenChange=g,a.FullScreen={isFullScreen:function(){return!1},cancelFullScreen:g})})(jQuery);/*
 jqPagination, a jQuery pagination plugin (obviously)
 Version: 1.4 (26th July 2013)

 Copyright (C) 2013 Ben Everard

 http://beneverard.github.com/jqPagination

 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.

*/
(function(a){a.jqPagination=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$input=d.$el.find("input");d.$el.data("jqPagination",d);d.init=function(){d.options=a.extend({},a.jqPagination.defaultOptions,b);null===d.options.max_page&&(void 0!==d.$input.data("max-page")?d.options.max_page=d.$input.data("max-page"):d.options.max_page=1);void 0!==d.$input.data("current-page")&&d.isNumber(d.$input.data("current-page"))&&(d.options.current_page=d.$input.data("current-page"));d.$input.removeAttr("readonly");
d.updateInput(!0);d.$input.on("focus.jqPagination mouseup.jqPagination",function(b){if("focus"===b.type){var c=parseInt(d.options.current_page,10);a(this).val(c).select()}if("mouseup"===b.type)return!1});d.$input.on("blur.jqPagination keydown.jqPagination",function(b){var c=a(this),e=parseInt(d.options.current_page,10);27===b.keyCode&&(c.val(e),c.blur());13===b.keyCode&&c.blur();"blur"===b.type&&d.setPage(c.val())});d.$el.on("click.jqPagination","a",function(b){var c=a(this);if(c.hasClass("disabled"))return!1;
b.metaKey||b.ctrlKey||(b.preventDefault(),d.setPage(c.data("action")))})};d.setPage=function(a,b){if(void 0===a)return d.options.current_page;var c=parseInt(d.options.current_page,10),e=parseInt(d.options.max_page,10);if(isNaN(parseInt(a,10)))switch(a){case "first":a=1;break;case "prev":case "previous":a=c-1;break;case "next":a=c+1;break;case "last":a=e}a=parseInt(a,10);if(isNaN(a)||1>a||a>e)return d.setInputValue(c),!1;d.options.current_page=a;d.$input.data("current-page",a);d.updateInput(b)};d.setMaxPage=
function(a,b){if(void 0===a)return d.options.max_page;if(!d.isNumber(a))return console.error("jqPagination: max_page is not a number"),!1;if(a<d.options.current_page)return console.error("jqPagination: max_page lower than current_page"),!1;d.options.max_page=a;d.$input.data("max-page",a);d.updateInput(b)};d.updateInput=function(a){var b=parseInt(d.options.current_page,10);d.setInputValue(b);d.setLinks(b);!0!==a&&d.options.paged(b)};d.setInputValue=function(a){var b=d.options.page_string,c=d.options.max_page,
b=b.replace("{current_page}",a).replace("{max_page}",c);d.$input.val(b)};d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.setLinks=function(a){a=d.options.link_string;var b=parseInt(d.options.current_page,10),c=parseInt(d.options.max_page,10);if(""!==a){var e=b-1;1>e&&(e=1);var q=b+1;q>c&&(q=c);d.$el.find("a.first").attr("href",a.replace("{page_number}","1"));d.$el.find("a.prev, a.previous").attr("href",a.replace("{page_number}",e));d.$el.find("a.next").attr("href",a.replace("{page_number}",
q));d.$el.find("a.last").attr("href",a.replace("{page_number}",c))}d.$el.find("a").removeClass("disabled");b===c&&d.$el.find(".next, .last").addClass("disabled");1===b&&d.$el.find(".previous, .first").addClass("disabled")};d.callMethod=function(b,c,g){switch(b.toLowerCase()){case "option":if(void 0===g&&"object"!==typeof c)return d.options[c];b={trigger:!0};var e=!1;a.isPlainObject(c)&&!g?a.extend(b,c):b[c]=g;g=!1===b.trigger;void 0!==b.current_page&&(e=d.setPage(b.current_page,g));void 0!==b.max_page&&
(e=d.setMaxPage(b.max_page,g));!1===e&&console.error("jqPagination: cannot get / set option "+c);return e;case "destroy":d.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+b+'" does not exist'),!1}};d.init()};a.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}};a.fn.jqPagination=function(){var c=a(this),b=Array.prototype.slice.call(arguments),
d=!1;if("string"===typeof b[0])return void 0===b[2]?d=c.first().data("jqPagination").callMethod(b[0],b[1]):c.each(function(){d=a(this).data("jqPagination").callMethod(b[0],b[1],b[2])}),d;this.each(function(){new a.jqPagination(this,b[0])})}})(jQuery);if(!console){var console={},func=function(){return!1};console.log=func;console.info=func;console.warn=func;console.error=func};(function(a){var c;try{c="string"==typeof a("body").css("background-position-x")}catch(b){c=!1}a._spritely={instances:{},animate:function(b){var c=a(b.el),e=c.attr("id");if(!a._spritely.instances[e])return this;b=a.extend(b,a._spritely.instances[e]||{});if("sprite"==b.type&&b.fps){b.play_frames&&!a._spritely.instances[e].remaining_frames?a._spritely.instances[e].remaining_frames=b.play_frames+1:b.do_once&&!a._spritely.instances[e].remaining_frames&&(a._spritely.instances[e].remaining_frames=b.no_of_frames);
var h,g=function(c){var d=b.width;if(!h){h=[];for(var g=total=0;g<b.no_of_frames;g++)h[h.length]=0-total,total+=d}if(0==a._spritely.instances[e].current_frame){if(b.on_first_frame)b.on_first_frame(c)}else if(a._spritely.instances[e].current_frame==h.length-1&&b.on_last_frame)b.on_last_frame(c);if(b.on_frame&&b.on_frame[a._spritely.instances[e].current_frame])b.on_frame[a._spritely.instances[e].current_frame](c);a._spritely.instances[e].current_frame=1==b.rewind?0>=a._spritely.instances[e].current_frame?
h.length-1:a._spritely.instances[e].current_frame-1:a._spritely.instances[e].current_frame>=h.length-1?0:a._spritely.instances[e].current_frame+1;d=a._spritely.getBgY(c);c.css("background-position",h[a._spritely.instances[e].current_frame]+"px "+d);if(b.bounce&&0<b.bounce[0]&&0<b.bounce[1]){var d=b.bounce[0],g=b.bounce[1],p=b.bounce[2];c.animate({top:"+="+d+"px",left:"-="+g+"px"},p).animate({top:"-="+d+"px",left:"+="+g+"px"},p)}};if(a._spritely.instances[e].remaining_frames&&0<a._spritely.instances[e].remaining_frames){a._spritely.instances[e].remaining_frames--;
if(0==a._spritely.instances[e].remaining_frames)return a._spritely.instances[e].remaining_frames=-1,delete a._spritely.instances[e].remaining_frames,this;g(c)}else-1!=a._spritely.instances[e].remaining_frames&&g(c)}else if("pan"==b.type&&!a._spritely.instances[e]._stopped){var g=b.speed||1,p=a._spritely.instances[e].l||parseInt(a._spritely.getBgX(c).replace("px",""),10)||0,q=a._spritely.instances[e].t||parseInt(a._spritely.getBgY(c).replace("px",""),10)||0;if(b.do_once&&!a._spritely.instances[e].remaining_frames||
0>=a._spritely.instances[e].remaining_frames){switch(b.dir){case "up":case "down":a._spritely.instances[e].remaining_frames=Math.floor((b.img_height||0)/g);break;case "left":case "right":a._spritely.instances[e].remaining_frames=Math.floor((b.img_width||0)/g)}a._spritely.instances[e].remaining_frames++}else b.do_once&&a._spritely.instances[e].remaining_frames--;switch(b.dir){case "up":g*=-1;case "down":a._spritely.instances[e].l||(a._spritely.instances[e].l=p);a._spritely.instances[e].t=q+g;b.img_height&&
(a._spritely.instances[e].t%=b.img_height);break;case "left":g*=-1;case "right":a._spritely.instances[e].t||(a._spritely.instances[e].t=q),a._spritely.instances[e].l=p+g,b.img_width&&(a._spritely.instances[e].l%=b.img_width)}g=a._spritely.instances[e].l.toString();g=-1==g.indexOf("%")?g+"px ":g+" ";p=a._spritely.instances[e].t.toString();p=-1==p.indexOf("%")?p+"px ":p+" ";a(c).css("background-position",g+p);if(b.do_once&&!a._spritely.instances[e].remaining_frames)return this}a._spritely.instances[e].options=
b;a._spritely.instances[e].timeout=window.setTimeout(function(){a._spritely.animate(b)},parseInt(1E3/b.fps))},randomIntBetween:function(a,c){return parseInt(rand_no=Math.floor((c-(a-1))*Math.random())+a)},getBgUseXY:c,getBgY:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-y")||"0":(a(b).css("background-position")||" ").split(" ")[1]},getBgX:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-x")||"0":(a(b).css("background-position")||" ").split(" ")[0]},
get_rel_pos:function(a,c){var b=a;if(0>a)for(;0>b;)b+=c;else for(;b>c;)b-=c;return b},_spStrip:function(a,c){for(;a.length;){var b,d,g=!1,p=!1;for(b=0;b<c.length;b++){var q=a.slice(0,1);d=a.slice(1);-1<c.indexOf(q)?a=d:g=!0}for(b=0;b<c.length;b++)q=a.slice(-1),d=a.slice(0,-1),-1<c.indexOf(q)?a=d:p=!0;if(g&&p)return a}return""}};a.fn.extend({spritely:function(b){var c=a(this),e=c.attr("id");b=a.extend({type:"sprite",do_once:!1,width:null,height:null,img_width:0,img_height:0,fps:12,no_of_frames:2,play_frames:0},
b||{});var h=new Image,g=a._spritely._spStrip(c.css("background-image")||"",'url("); ');a._spritely.instances[e]||(a._spritely.instances[e]=b.start_at_frame?{current_frame:b.start_at_frame-1}:{current_frame:-1});a._spritely.instances[e].type=b.type;a._spritely.instances[e].depth=b.depth;b.el=c;b.width=b.width||c.width()||100;b.height=b.height||c.height()||100;h.onload=function(){b.img_width=h.width;b.img_height=h.height;b.img=h;b.do_once?setTimeout(function(){a._spritely.animate(b)},0):setTimeout(function(){a._spritely.animate(b)},
parseInt(1E3/b.fps))};h.src=g;return this},sprite:function(b){b=a.extend({type:"sprite",bounce:[0,0,1E3]},b||{});return a(this).spritely(b)},pan:function(b){b=a.extend({type:"pan",dir:"left",continuous:!0,speed:1},b||{});return a(this).spritely(b)},flyToTap:function(b){b=a.extend({el_to_move:null,type:"moveToTap",ms:1E3,do_once:!0},b||{});b.el_to_move&&a(b.el_to_move).active();a._spritely.activeSprite&&(window.Touch?a(this)[0].ontouchstart=function(b){var c=a._spritely.activeSprite,d=b.touches[0];
b=d.pageY-c.height()/2;d=d.pageX-c.width()/2;c.animate({top:b+"px",left:d+"px"},1E3)}:a(this).click(function(b){var c=a._spritely.activeSprite;a(c).stop(!0);var d=c.width(),g=c.height();c.animate({top:b.pageY-g/2+"px",left:b.pageX-d/2+"px"},1E3)}));return this},isDraggable:function(b){if(!a(this).draggable)return this;b=a.extend({type:"isDraggable",start:null,stop:null,drag:null},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;a._spritely.instances[c].isDraggableOptions=b;
a(this).draggable({start:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!0;a(this).stop(!0);a._spritely.instances[b].isDraggableOptions.start&&a._spritely.instances[b].isDraggableOptions.start(this)},drag:b.drag,stop:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!1;a._spritely.instances[b].isDraggableOptions.stop&&a._spritely.instances[b].isDraggableOptions.stop(this)}});return this},active:function(){a._spritely.activeSprite=this;return this},
activeOnClick:function(){var b=a(this);window.Touch?b[0].ontouchstart=function(c){a._spritely.activeSprite=b}:b.click(function(c){a._spritely.activeSprite=b});return this},spRandom:function(b){b=a.extend({top:50,left:50,right:290,bottom:320,speed:4E3,pause:0},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;if(!a._spritely.instances[c].stop_random){var e=a._spritely.randomIntBetween,h=e(b.top,b.bottom),e=e(b.left,b.right);a("#"+c).animate({top:h+"px",left:e+"px"},b.speed)}window.setTimeout(function(){a("#"+
c).spRandom(b)},b.speed+b.pause);return this},makeAbsolute:function(){return this.each(function(){var b=a(this),c=b.position();b.css({position:"absolute",marginLeft:0,marginTop:0,top:c.top,left:c.left}).remove().appendTo("body")})},spSet:function(b,c){var d=a(this).attr("id");a._spritely.instances[d][b]=c;return this},spGet:function(b,c){var d=a(this).attr("id");return a._spritely.instances[d][b]},spStop:function(b){this.each(function(){var c=a(this),e=c.attr("id");a._spritely.instances[e].options.fps&&
(a._spritely.instances[e]._last_fps=a._spritely.instances[e].options.fps);"sprite"==a._spritely.instances[e].type&&c.spSet("fps",0);a._spritely.instances[e]._stopped=!0;if(a._spritely.instances[e]._stopped_f1=b)e=a._spritely.getBgY(a(this)),c.css("background-position","0 "+e)});return this},spStart:function(){a(this).each(function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._last_fps||12;"sprite"==a._spritely.instances[b].type&&a(this).spSet("fps",c);a._spritely.instances[b]._stopped=!1});
return this},spToggle:function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._stopped_f1||!1;a._spritely.instances[b]._stopped?a(this).spStart():a(this).spStop(c);return this},fps:function(b){a(this).each(function(){a(this).spSet("fps",b)});return this},goToFrame:function(b){var c=a(this).attr("id");a._spritely.instances&&a._spritely.instances[c]&&(a._spritely.instances[c].current_frame=b-1);return this},spSpeed:function(b){a(this).each(function(){a(this).spSet("speed",b)});return this},spRelSpeed:function(b){a(this).each(function(){var c=
a(this).spGet("depth")/100;a(this).spSet("speed",b*c)});return this},spChangeDir:function(b){a(this).each(function(){a(this).spSet("dir",b)});return this},spState:function(b){a(this).each(function(){var c=(b-1)*a(this).height()+"px",c=a._spritely.getBgX(a(this))+" -"+c;a(this).css("background-position",c)});return this},lockTo:function(b,c){a(this).each(function(){var d=a(this).attr("id");if(!a._spritely.instances[d])return this;a._spritely.instances[d].locked_el=a(this);a._spritely.instances[d].lock_to=
a(b);a._spritely.instances[d].lock_to_options=c;a._spritely.instances[d].interval=window.setInterval(function(){if(a._spritely.instances[d].lock_to){var b=a._spritely.instances[d].locked_el,c=a._spritely.instances[d].lock_to,e=a._spritely.instances[d].lock_to_options,q=e.bg_img_width;c.height();var t=a._spritely.getBgY(c),c=a._spritely.getBgX(c),c=parseInt(c)+parseInt(e.left),e=parseInt(t)+parseInt(e.top),c=a._spritely.get_rel_pos(c,q);a(b).css({top:e+"px",left:c+"px"})}},c.interval||20)});return this},
destroy:function(){a(this);var b=a(this).attr("id");a._spritely.instances[b]&&a._spritely.instances[b].timeout&&window.clearTimeout(a._spritely.instances[b].timeout);a._spritely.instances[b]&&a._spritely.instances[b].interval&&window.clearInterval(a._spritely.instances[b].interval);delete a._spritely.instances[b];return this}})})(jQuery);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){};(function(a){for(var c,b,d=document.getElementsByTagName("head")[0].style,e=["transformProperty","WebkitTransform","OTransform","msTransform","MozTransform"],h=0;h<e.length;h++)void 0!==d[e[h]]&&(c=e[h]);c&&(b=c.replace(/[tT]ransform/,"TransformOrigin"),"T"==b[0]&&(b[0]="t"));eval('IE = "v"=="\v"');jQuery.fn.extend({rotate:function(b){if(0!==this.length&&"undefined"!=typeof b){"number"==typeof b&&(b={angle:b});for(var c=[],d=0,e=this.length;d<e;d++){var g=this.get(d);if(g.Wilq32&&g.Wilq32.PhotoEffect)g.Wilq32.PhotoEffect._handleRotation(b);
else{var h=a.extend(!0,{},b),g=(new Wilq32.PhotoEffect(g,h))._rootObj;c.push(a(g))}}return c}},getRotateAngle:function(){for(var a=[],b=0,c=this.length;b<c;b++){var d=this.get(b);d.Wilq32&&d.Wilq32.PhotoEffect&&(a[b]=d.Wilq32.PhotoEffect._angle)}return a},stopRotate:function(){for(var a=0,b=this.length;a<b;a++){var c=this.get(a);c.Wilq32&&c.Wilq32.PhotoEffect&&clearTimeout(c.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return c?function(a,b){a.Wilq32={PhotoEffect:this};
this._img=this._rootObj=this._eventObj=a;this._handleRotation(b)}:function(a,b){this._img=a;this._onLoadDelegate=[b];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};a.parentNode.insertBefore(this._rootObj,a);if(a.complete)this._Loader();else{var c=this;jQuery(this._img).bind("load",function(){c._Loader()})}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(a){this._parameters=this._parameters||{};"number"!==
typeof this._angle&&(this._angle=0);"number"===typeof a.angle&&(this._angle=a.angle);this._parameters.animateTo="number"===typeof a.animateTo?a.animateTo:this._angle;this._parameters.step=a.step||this._parameters.step||null;this._parameters.easing=a.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration="duration"in a?a.duration:a.duration||this._parameters.duration||1E3;this._parameters.callback=a.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=
a.center||this._parameters.center||["50%","50%"];this._rotationCenterX="string"==typeof this._parameters.center[0]?parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._parameters.center[0];this._rotationCenterY="string"==typeof this._parameters.center[1]?parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._parameters.center[1];a.bind&&a.bind!=this._parameters.bind&&this._BindEvents(a.bind)},_emptyFunction:function(){},_defaultEasing:function(a,
b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},_handleRotation:function(a,b){c||this._img.complete||b?(this._setupParameters(a),this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()):this._onLoadDelegate.push(a)},_BindEvents:function(a){if(a&&this._eventObj){if(this._parameters.bind){var b=this._parameters.bind,c;for(c in b)b.hasOwnProperty(c)&&jQuery(this._eventObj).unbind(c,b[c])}this._parameters.bind=a;for(c in a)a.hasOwnProperty(c)&&jQuery(this._eventObj).bind(c,a[c])}},
_Loader:function(){return IE?function(){var a=this._img.width,b=this._img.height;this._imgWidth=a;this._imgHeight=b;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=b+"px";this._vimage.style.width=a+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=a;this._container.style.height=
b;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",a-1+","+(b-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=a+"px";this._rootObj.style.height=b+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;for(this._eventObj=this._rootObj;a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var a=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*a;this._height=3*a;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement("canvas");
this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;for(this._cnv=this._canvas.getContext("2d");a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var a=+new Date,b=a-this._animateStartTime>this._parameters.duration;if(b&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img)a=this._parameters.easing(0,a-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration),
this._rotate(~~(10*a)/10);this._parameters.step&&this._parameters.step(this._angle);var c=this;this._timer=setTimeout(function(){c._animate.call(c)},10)}this._parameters.callback&&b&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var a=Math.PI/180;return IE?function(a){this._angle=a;this._container.style.rotation=a%360+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=
-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:c?function(a){this._angle=a;this._img.style[c]="rotate("+a%360+"deg)";this._img.style[b]=this._parameters.center.join(" ")}:function(b){this._angle=b;b=b%360*a;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,
this._rotationCenterY);this._cnv.rotate(b);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(g){return function(a){return document.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())})(jQuery);(function(a,c){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():c.log4javascript=a()})(function(){function a(a){return"undefined"==typeof a}function c(){}function b(){}function d(a){return a&&a.toString?a.toString():String(a)}function e(a){return a.message?a.message:a.description?a.description:d(a)}function h(a){if(a){var b="Exception: "+e(a);try{if(a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName){var c=b,f,d=a.fileName,
l=Math.max(d.lastIndexOf("/"),d.lastIndexOf("\\"));f=d.substr(l+1);b=c+(" in file "+f)}}catch(ka){I.warn("Unable to obtain file and line information for error")}oa&&a.stack&&(b+="\r\nStack trace:\r\n"+a.stack);return b}return null}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function p(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}function q(a,b){for(var c=-1,f=0,d=a.length;f<d;f++)if(a[f]===b){c=f;break}return 0<=c?(a.splice(c,1),!0):!1}function t(a,b){for(var c=
0,f=a.length;c<f;c++)if(a[c]==b)return!0;return!1}function x(b,c){return a(b)?c:!!b}function w(b,c){return a(b)?c:String(b)}function G(b,c){if(a(b))return c;try{var f=parseInt(b,10);return isNaN(f)?c:f}catch(ha){return I.warn("Invalid int param "+b,ha),c}}function k(a,b){I.error(a,b);u.dispatchEvent("error",{message:a,exception:b})}function f(b,c){this.name=b;this.level=a(c)?v.INFO:c;this.start=new Date}function l(b){this.name=b;this.parent=null;this.children=[];var c=[],e=null,l="root"===this.name,
m="[null]"===this.name,r=null,g=!1;this.addChild=function(a){this.children.push(a);a.parent=this;a.invalidateAppenderCache()};var h=!0;this.getAdditivity=function(){return h};this.setAdditivity=function(a){var b=h!=a;h=a;b&&this.invalidateAppenderCache()};this.addAppender=function(a){m?k("Logger.addAppender: you may not add an appender to the null logger"):a instanceof u.Appender?t(c,a)||(c.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):k("Logger.addAppender: appender supplied ('"+
d(a)+"') is not a subclass of Appender")};this.removeAppender=function(a){q(c,a);a.setRemovedFromLogger(this);this.invalidateAppenderCache()};this.removeAllAppenders=function(){var a=c.length;if(0<a){for(var b=0;b<a;b++)c[b].setRemovedFromLogger(this);c.length=0;this.invalidateAppenderCache()}};this.getEffectiveAppenders=function(){if(null===r||g)r=(l||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders()).concat(c),g=!1;return r};this.invalidateAppenderCache=function(){g=!0;for(var a=0,b=
this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()};this.log=function(a,b){if(Q&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,f=b.length-1,d=b[f];1<b.length&&d instanceof Error&&(c=d,f--);for(var d=[],e=0;e<=f;e++)d[e]=b[e];c=new qa(this,new Date,a,d,c);this.callAppenders(c)}};this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,f=b.length;c<f;c++)b[c].doAppend(a)};this.setLevel=function(a){l&&null===a?k("Logger.setLevel: you cannot set the level of the root logger to null"):
a instanceof v?e=a:k("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")};this.getLevel=function(){return e};this.getEffectiveLevel=function(){for(var a=this;null!==a;a=a.parent){var b=a.getLevel();if(null!==b)return b}};this.group=function(a,b){if(Q)for(var c=this.getEffectiveAppenders(),f=0,d=c.length;f<d;f++)c[f].group(a,b)};this.groupEnd=function(){if(Q)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;b<c;b++)a[b].groupEnd()};var n={};this.time=
function(b,c){Q&&(a(b)?k("Logger.time: a name for the timer must be supplied"):!c||c instanceof v?n[b]=new f(b,c):k("Logger.time: level supplied to timer "+b+" is not an instance of log4javascript.Level"))};this.timeEnd=function(b){if(Q)if(a(b))k("Logger.timeEnd: a name for the timer must be supplied");else if(n[b]){var c=n[b],f=c.getElapsedTime();this.log(c.level,["Timer "+d(b)+" completed in "+f+"ms"]);delete n[b]}else I.warn("Logger.timeEnd: no timer found with name "+b)};this.assert=function(a){if(Q&&
!a){for(var b=[],c=1,f=arguments.length;c<f;c++)b.push(arguments[c]);b=0<b.length?b:["Assertion Failure"];b.push("\r\n");b.push(a);this.log(v.ERROR,b)}};this.toString=function(){return"Logger["+this.name+"]"}}function m(){this.customFields=[]}function n(){this.customFields=[]}function C(a){this.combineMessages=x(a,!0);this.customFields=[]}function B(a,b){this.readable=x(a,!1);this.combineMessages=x(b,!0);this.batchHeader=this.readable?"[\r\n":"[";this.batchFooter=this.readable?"]\r\n":"]";this.batchSeparator=
this.readable?",\r\n":",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?"\r\n":"";this.customFields=[]}function H(){this.setKeys();this.customFields=[];this.returnsPostData=!0}function ga(a,b,c){function f(a,b,c){function l(a){a=p(a);for(var b=1,f=a.length;b<f;b++)a[b]=c+a[b];return a.join("\r\n")}var m,r,g,n,D,k;c||(c="");if(null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return l(a);if("object"==
typeof a&&t(e,a)){try{D=d(a)}catch(ca){D="Error formatting property. Details: "+h(ca)}return D+" [already expanded]"}if(a instanceof Array&&0<b){e.push(a);D="[\r\n";r=b-1;g=c+"  ";n=[];m=0;for(b=a.length;m<b;m++)try{k=f(a[m],r,g),n.push(g+k)}catch(ca){n.push(g+"Error formatting array member. Details: "+h(ca)+"")}return D+=n.join(",\r\n")+"\r\n"+c+"]"}if("[object Date]"==Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&0<b){e.push(a);D="{\r\n";r=b-1;g=c+"  ";n=[];for(m in a)try{k=
f(a[m],r,g),n.push(g+m+": "+k)}catch(ca){n.push(g+m+": Error formatting property. Details: "+h(ca))}return D+=n.join(",\r\n")+"\r\n"+c+"}"}return l(d(a))}var e=[];return f(a,b,c)}function E(a){this.pattern=a?a:E.DEFAULT_CONVERSION_PATTERN;this.customFields=[]}function K(){}function F(){}function M(b,c){function f(a){return I?(k("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0}function d(){if(S&&Q){F=!0;var a;if(J)0<y.length?(a=y.shift(),r(l(a),
d)):(F=!1,p&&window.setTimeout(d,B));else{for(;a=y.shift();)r(l(a));F=!1;p&&window.setTimeout(d,B)}}}function e(){var a=!1;if(S&&Q){for(var a=n.getLayout().allowBatching()?q:1,b,c=[];b=ga.shift();)c.push(b),ga.length>=a&&(y.push(c),c=[]);0<c.length&&y.push(c);a=0<y.length;p=J=!1;d()}return a}function l(a){for(var b=[],c;c=a.shift();)b.push(n.getLayout().formatWithException(c));a=1==a.length?b.join(""):n.getLayout().batchHeader+b.join(n.getLayout().batchSeparator)+n.getLayout().batchFooter;E==n.defaults.contentType&&
(a=n.getLayout().returnsPostData?a:U(u)+"="+U(a),0<a.length&&(a+="&"),a+="layout="+U(n.getLayout().toString()));return a}function m(){k("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled");S=!1;t&&t("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled")}function r(f,d){try{var e=ra(m);if(S){e.onreadystatechange=function(){if(4==e.readyState){var c=e;a(c.status)||0===c.status||200<=c.status&&300>c.status||1223==c.status?(C&&C(e),d&&d(e)):(c="AjaxAppender.append: XMLHttpRequest request to URL "+
b+" returned status code "+e.status,k(c),t&&t(c));e.onreadystatechange=da;e=null}};e.open("POST",b,!0);c&&za&&(e.withCredentials=!0);try{for(var l=0,r;r=K[l++];)e.setRequestHeader(r.name,r.value);e.setRequestHeader("Content-Type",E)}catch(na){k("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");S=!1;t&&t("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");
return}e.send(f)}}catch(na){l="AjaxAppender.append: error sending log message to "+b,k(l,na),S=!1,t&&t(l+". Details: "+h(na))}}function g(){I=!0;if(v){var a=window.onbeforeunload;window.onbeforeunload=function(){a&&a();e()}}p&&window.setTimeout(d,B)}var n=this,S=!0;b||(k("AjaxAppender: URL must be specified in constructor"),S=!1);var p=this.defaults.timed,J=this.defaults.waitForResponse,q=this.defaults.batchSize,B=this.defaults.timerInterval,C=this.defaults.requestSuccessCallback,t=this.defaults.failCallback,
u=this.defaults.postVarName,v=this.defaults.sendAllOnUnload,E=this.defaults.contentType,H=null,ga=[],y=[],K=[],F=!1,I=!1;this.getSessionId=function(){return H};this.setSessionId=function(a){H=w(a,null);this.layout.setCustomField("sessionid",H)};this.setLayout=function(a){f("layout")&&(this.layout=a,null!==H&&this.setSessionId(H))};this.isTimed=function(){return p};this.setTimed=function(a){f("timed")&&(p=!!a)};this.getTimerInterval=function(){return B};this.setTimerInterval=function(a){f("timerInterval")&&
(B=G(a,B))};this.isWaitForResponse=function(){return J};this.setWaitForResponse=function(a){f("waitForResponse")&&(J=!!a)};this.getBatchSize=function(){return q};this.setBatchSize=function(a){f("batchSize")&&(q=G(a,q))};this.isSendAllOnUnload=function(){return v};this.setSendAllOnUnload=function(a){f("sendAllOnUnload")&&(v=x(a,v))};this.setRequestSuccessCallback=function(a){C="function"==typeof a?a:C};this.setFailCallback=function(a){t="function"==typeof a?a:t};this.getPostVarName=function(){return u};
this.setPostVarName=function(a){f("postVarName")&&(u=w(a,u))};this.getHeaders=function(){return K};this.addHeader=function(a,b){"content-type"==a.toLowerCase()?E=b:K.push({name:a,value:b})};this.sendAll=d;this.sendAllRemaining=e;this.append=function(a){if(S&&(I||g(),ga.push(a),a=this.getLayout().allowBatching()?q:1,ga.length>=a)){for(var b=[];a=ga.shift();)b.push(a);y.push(b);p||J&&(!J||F)||d()}}}function ba(a){try{return!!a.loaded}catch(J){return!1}}function W(a,b){if(a.length<b){for(var c=[],f=
Math.max(0,b-a.length),d=0;d<f;d++)c[d]=" ";a+=c.join("")}return a}Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length});Array.prototype.shift||(Array.prototype.shift=function(){if(0<this.length){for(var a=this[0],b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];--this.length;return a}});Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),f=this.slice(a,a+b);this.length=a;for(var d=
[],e=0,l=arguments.length;e<l;e++)d[e]=arguments[e];c=2<d.length?d.slice(2).concat(c):c;e=0;for(l=c.length;e<l;e++)this.push(c[e]);return f});c.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a;this.eventListeners={};a=0;for(var b=this.eventTypes.length;a<b;a++)this.eventListeners[this.eventTypes[a]]=[]}else k("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){"function"==
typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):k("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){"function"==typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),q(this.eventListeners[a],b)):k("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},
dispatchEvent:function(a,b){if(t(this.eventTypes,a))for(var c=this.eventListeners[a],f=0,d=c.length;f<d;f++)c[f](this,a,b);else k("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var Aa=new Date,Ba="log4javascript_"+Aa.getTime()+"_"+Math.floor(1E8*Math.random()),da=function(){},wa=!1;b.prototype=new c;var u=new b;u.version="1.4.13";u.edition="log4javascript";var U="undefined"!=typeof window.encodeURIComponent?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,
"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(a,b){var c="__apply__";"undefined"!=typeof a[c]&&(c+=String(Math.random()).substr(2));a[c]=this;for(var f=[],d=0,e=b.length;d<e;d++)f[d]="args["+d+"]";f="obj."+c+"("+f.join(",")+")";f=eval(f);delete a[c];return f});Function.prototype.call||(Function.prototype.call=function(a){for(var b=[],c=1,f=arguments.length;c<f;c++)b[c-1]=arguments[c];return this.apply(a,
b)});var I={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=!!a},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join("\r\n"))},warn:function(a,b){},error:function(a,b){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+="\r\n\r\nOriginal error: "+h(b));alert(c)}}};u.logLog=I;u.setEventTypes(["load",
"error"]);u.handleError=k;var Q=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);u.setEnabled=function(a){Q=!!a};u.isEnabled=function(){return Q};var ea=!0;u.setTimeStampsInMilliseconds=function(a){ea=!!a};u.isTimeStampsInMilliseconds=function(){return ea};u.evalInScope=function(a){return eval(a)};var oa=!1;u.setShowStackTraces=function(a){oa=!!a};var v=function(a,b){this.level=a;this.name=b};v.prototype={toString:function(){return this.name},equals:function(a){return this.level==
a.level},isGreaterOrEqual:function(a){return this.level>=a.level}};v.ALL=new v(Number.MIN_VALUE,"ALL");v.TRACE=new v(1E4,"TRACE");v.DEBUG=new v(2E4,"DEBUG");v.INFO=new v(3E4,"INFO");v.WARN=new v(4E4,"WARN");v.ERROR=new v(5E4,"ERROR");v.FATAL=new v(6E4,"FATAL");v.OFF=new v(Number.MAX_VALUE,"OFF");u.Level=v;f.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};l.prototype={trace:function(){this.log(v.TRACE,arguments)},debug:function(){this.log(v.DEBUG,arguments)},info:function(){this.log(v.INFO,
arguments)},warn:function(){this.log(v.WARN,arguments)},error:function(){this.log(v.ERROR,arguments)},fatal:function(){this.log(v.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(v.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(v.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(v.INFO)},isWarnEnabled:function(){return this.isEnabledFor(v.WARN)},isErrorEnabled:function(){return this.isEnabledFor(v.ERROR)},
isFatalEnabled:function(){return this.isEnabledFor(v.FATAL)}};l.prototype.trace.isEntryPoint=!0;l.prototype.debug.isEntryPoint=!0;l.prototype.info.isEntryPoint=!0;l.prototype.warn.isEntryPoint=!0;l.prototype.error.isEntryPoint=!0;l.prototype.fatal.isEntryPoint=!0;var aa={},Ia=[],Ca=v.DEBUG,Y=new l("root");Y.setLevel(Ca);u.getRootLogger=function(){return Y};u.getLogger=function(a){"string"!=typeof a&&(a="[anonymous]",I.warn("log4javascript.getLogger: non-string logger name "+d(a)+" supplied, returning anonymous logger"));
"root"==a&&k("log4javascript.getLogger: root logger may not be obtained by name");if(!aa[a]){var b=new l(a);aa[a]=b;Ia.push(a);var c=a.lastIndexOf(".");-1<c?(c=a.substring(0,c),c=u.getLogger(c)):c=Y;c.addChild(b)}return aa[a]};var fa=null;u.getDefaultLogger=function(){if(!fa){var a=u.getLogger("[default]"),b=new u.PopUpAppender;a.addAppender(b);fa=a}return fa};var Z=null;u.getNullLogger=function(){Z||(Z=new l("[null]"),Z.setLevel(v.OFF));return Z};u.resetConfiguration=function(){Y.setLevel(Ca);aa=
{}};var qa=function(a,b,c,f,d){this.logger=a;this.timeStamp=b;this.timeStampInMilliseconds=b.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1E3);this.milliseconds=this.timeStamp.getMilliseconds();this.level=c;this.messages=f;this.exception=d};qa.prototype={getThrowableStrRep:function(){return this.exception?h(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join("\r\n")},toString:function(){return"LoggingEvent["+
this.level+"]"}};u.LoggingEvent=qa;var R=function(){};R.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,
format:function(){k("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){k("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0;this.useTimeStampsInMilliseconds=!!a},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:ea},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?
a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]);a.exception&&c.push([this.exceptionKey,h(a.exception)]);if(this.hasCustomFields())for(var f=0,d=this.customFields.length;f<d;f++){var e=this.customFields[f].value;
"function"===typeof e&&(e=e(this,a));c.push([this.customFields[f].name,e])}return c},setKeys:function(a,b,c,f,d,e,l){this.loggerKey=w(a,this.defaults.loggerKey);this.timeStampKey=w(b,this.defaults.timeStampKey);this.levelKey=w(c,this.defaults.levelKey);this.messageKey=w(f,this.defaults.messageKey);this.exceptionKey=w(d,this.defaults.exceptionKey);this.urlKey=w(e,this.defaults.urlKey);this.millisecondsKey=w(l,this.defaults.millisecondsKey)},setCustomField:function(a,b){for(var c=!1,f=0,d=this.customFields.length;f<
d;f++)this.customFields[f].name===a&&(this.customFields[f].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return 0<this.customFields.length},formatWithException:function(a){var b=this.format(a);a.exception&&this.ignoresThrowable()&&(b+=a.getThrowableStrRep());return b},toString:function(){k("Layout.toString: all layouts must override this method")}};u.Layout=R;var y=function(){};y.prototype=new c;y.prototype.layout=new E;y.prototype.threshold=v.ALL;y.prototype.loggers=
[];y.prototype.doAppend=function(a){Q&&a.level.level>=this.threshold.level&&this.append(a)};y.prototype.append=function(a){};y.prototype.setLayout=function(a){a instanceof R?this.layout=a:k("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")};y.prototype.getLayout=function(){return this.layout};y.prototype.setThreshold=function(a){a instanceof v?this.threshold=a:k("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")};
y.prototype.getThreshold=function(){return this.threshold};y.prototype.setAddedToLogger=function(a){this.loggers.push(a)};y.prototype.setRemovedFromLogger=function(a){q(this.loggers,a)};y.prototype.group=da;y.prototype.groupEnd=da;y.prototype.toString=function(){k("Appender.toString: all appenders must override this method")};u.Appender=y;m.prototype=new R;m.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()};m.prototype.ignoresThrowable=function(){return!0};m.prototype.toString=
function(){return"SimpleLayout"};u.SimpleLayout=m;n.prototype=new R;n.prototype.format=function(a){return a.messages};n.prototype.ignoresThrowable=function(){return!0};n.prototype.formatWithException=function(a){var b=a.messages;return(a=a.exception)?b.concat([a]):b};n.prototype.toString=function(){return"NullLayout"};u.NullLayout=n;C.prototype=new R;C.prototype.isCombinedMessages=function(){return this.combineMessages};C.prototype.getContentType=function(){return"text/xml"};C.prototype.escapeCdata=
function(a){return a.replace(/\]\]>/,"]]\x3e]]&gt;<![CDATA[")};C.prototype.format=function(a){function b(a){a="string"===typeof a?a:d(a);return"<log4javascript:message><![CDATA["+c.escapeCdata(a)+"]]\x3e</log4javascript:message>"}var c=this,f,e,l='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';this.isTimeStampsInMilliseconds()||(l+=' milliseconds="'+a.milliseconds+'"');l+=' level="'+a.level.name+'">\r\n';if(this.combineMessages)l+=b(a.getCombinedMessages());
else{l+="<log4javascript:messages>\r\n";f=0;for(e=a.messages.length;f<e;f++)l+=b(a.messages[f])+"\r\n";l+="</log4javascript:messages>\r\n"}if(this.hasCustomFields())for(f=0,e=this.customFields.length;f<e;f++)l+='<log4javascript:customfield name="'+this.customFields[f].name+'"><![CDATA['+this.customFields[f].value.toString()+"]]\x3e</log4javascript:customfield>\r\n";a.exception&&(l+="<log4javascript:exception><![CDATA["+h(a.exception)+"]]\x3e</log4javascript:exception>\r\n");return l+"</log4javascript:event>\r\n\r\n"};
C.prototype.ignoresThrowable=function(){return!1};C.prototype.toString=function(){return"XmlLayout"};u.XmlLayout=C;B.prototype=new R;B.prototype.isReadable=function(){return this.readable};B.prototype.isCombinedMessages=function(){return this.combineMessages};B.prototype.format=function(a){function b(a,f,e){var l=typeof a;if(a instanceof Date)e=String(a.getTime());else if(e&&a instanceof Array){e="["+c.lineBreak;for(var l=0,m=a.length;l<m;l++){var g=f+c.tab;e+=g+b(a[l],g,!1);l<a.length-1&&(e+=",");
e+=c.lineBreak}e+=f+"]"}else e="number"!==l&&"boolean"!==l?'"'+d(a).replace(/\"/g,'\\"').replace(/\r\n|\r|\n/g,"\\r\\n")+'"':a;return e}var c=this;a=this.getDataValues(a,this.combineMessages);var f="{"+this.lineBreak,e,l;e=0;for(l=a.length-1;e<=l;e++)f+=this.tab+'"'+a[e][0]+'"'+this.colon+b(a[e][1],this.tab,!0),e<l&&(f+=","),f+=this.lineBreak;return f+="}"+this.lineBreak};B.prototype.ignoresThrowable=function(){return!1};B.prototype.toString=function(){return"JsonLayout"};B.prototype.getContentType=
function(){return"application/json"};u.JsonLayout=B;H.prototype=new R;H.prototype.allowBatching=function(){return!1};H.prototype.format=function(a){a=this.getDataValues(a);for(var b=[],c=0,f=a.length;c<f;c++){var d=a[c][1]instanceof Date?String(a[c][1].getTime()):a[c][1];b.push(U(a[c][0])+"="+U(d))}return b.join("&")};H.prototype.ignoresThrowable=function(a){return!1};H.prototype.toString=function(){return"HttpPostDataLayout"};u.HttpPostDataLayout=H;var P;(function(){var b=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,
c="January February March April May June July August September October November December".split(" "),f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d={G:0,y:3,M:4,w:2,W:2,D:2,d:2,F:2,E:1,a:0,H:2,k:2,K:2,h:2,m:2,s:2,S:2,Z:5},e=function(a,b,c){a=new Date(a,b,c,0,0,0);a.setMilliseconds(0);return a};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()};Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),
this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()};Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),a=new Date(a.getTime()-864E5*this.getDay());return e(a.getFullYear(),a.getMonth(),a.getDate())};Date.prototype.getWeekInYear=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),
f=e(this.getFullYear(),0,1),c=c.isBefore(f)?0:1+Math.floor(c.getTimeSince(f)/6048E5),f=7-f.getDay();f<b&&c--;return c};Date.prototype.getWeekInMonth=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),f=e(this.getFullYear(),this.getMonth(),1),c=c.isBefore(f)?0:1+Math.floor(c.getTimeSince(f)/6048E5),f=7-f.getDay();f>=b&&c++;return c};Date.prototype.getDayInYear=function(){var a=e(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/864E5)};P=function(a){this.formatString=
a};P.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a};P.prototype.getMinimalDaysInFirstWeek=function(){return a(this.minimalDaysInFirstWeek)?1:this.minimalDaysInFirstWeek};var l=function(a,b){for(;a.length<b;)a="0"+a;return a},m=function(a,b,c){return 4<=b?a:a.substr(0,Math.max(c,b))};P.prototype.format=function(a){for(var e="",g,r=this.formatString;g=b.exec(r);){var h=g[1],n=g[2],D=g[3],k=g[4];if(h)e="''"==h?e+"'":e+h.substring(1,h.length-1);else if(!D)if(k)e+=k;else if(n){h=
n.charAt(0);n=n.length;D="";switch(h){case "G":D="AD";break;case "y":D=a.getFullYear();break;case "M":D=a.getMonth();break;case "w":D=a.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case "W":D=a.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case "D":D=a.getDayInYear();break;case "d":D=a.getDate();break;case "F":D=1+Math.floor((a.getDate()-1)/7);break;case "E":D=f[a.getDay()];break;case "a":D=12<=a.getHours()?"PM":"AM";break;case "H":D=a.getHours();break;case "k":D=a.getHours()||24;
break;case "K":D=a.getHours()%12;break;case "h":D=a.getHours()%12||12;break;case "m":D=a.getMinutes();break;case "s":D=a.getSeconds();break;case "S":D=a.getMilliseconds();break;case "Z":D=a.getTimezoneOffset()}switch(d[h]){case 0:e+=m(D,n,2);break;case 1:e+=m(D,n,3);break;case 2:e+=l(""+D,n);break;case 3:e=3>=n?e+(""+D).substr(2,2):e+l(""+D,n);break;case 4:e=3<=n?e+m(c[D],n,n):e+l(""+(D+1),n);break;case 5:n=0<D?"-":"+",D=Math.abs(D),h=""+Math.floor(D/60),h=l(h,2),D=""+D%60,D=l(D,2),e+=n+h+D}}r=r.substr(g.index+
g[0].length)}return e}})();u.SimpleDateFormat=P;E.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";E.DEFAULT_CONVERSION_PATTERN="%m%n";E.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";E.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";E.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";E.prototype=new R;E.prototype.format=function(a){for(var b=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,c="",f,d=this.pattern;f=b.exec(d);){var e=f[0],l=f[1],m=f[2],g=f[3],r=f[5],h=f[6];if(h)c+=""+h;else{h="";switch(g){case "a":case "m":e=
0;r&&(e=parseInt(r,10),isNaN(e)&&(k("PatternLayout.format: invalid specifier '"+r+"' for conversion character '"+g+"' - should be a number"),e=0));for(var r="a"===g?a.messages[0]:a.messages,g=0,n=r.length;g<n;g++)0<g&&" "!==h.charAt(h.length-1)&&(h+=" "),h=0===e?h+r[g]:h+ga(r[g],e);break;case "c":h=a.logger.name;r&&(r=parseInt(r,10),e=a.logger.name.split("."),h=r>=e.length?h:e.slice(e.length-r).join("."));break;case "d":h=E.ISO8601_DATEFORMAT;r&&(h=r,"ISO8601"==h?h=E.ISO8601_DATEFORMAT:"ABSOLUTE"==
h?h=E.ABSOLUTETIME_DATEFORMAT:"DATE"==h&&(h=E.DATETIME_DATEFORMAT));h=(new P(h)).format(a.timeStamp);break;case "f":this.hasCustomFields()&&(h=0,r&&(h=parseInt(r,10),isNaN(h)?k("PatternLayout.format: invalid specifier '"+r+"' for conversion character 'f' - should be a number"):0===h?k("PatternLayout.format: invalid specifier '"+r+"' for conversion character 'f' - must be greater than zero"):h>this.customFields.length?k("PatternLayout.format: invalid specifier '"+r+"' for conversion character 'f' - there aren't that many custom fields"):
--h),h=this.customFields[h].value,"function"==typeof h&&(h=h(this,a)));break;case "n":h="\r\n";break;case "p":h=a.level.name;break;case "r":h=""+a.timeStamp.getDifference(Aa);break;case "%":h="%";break;default:h=e}m&&(m=parseInt(m.substr(1),10),r=h.length,m<r&&(h=h.substring(r-m,r)));if(l)if("-"==l.charAt(0))for(m=parseInt(l.substr(1),10);h.length<m;)h+=" ";else for(m=parseInt(l,10);h.length<m;)h=" "+h;c+=h}d=d.substr(f.index+f[0].length)}return c};E.prototype.ignoresThrowable=function(){return!0};
E.prototype.toString=function(){return"PatternLayout"};u.PatternLayout=E;K.prototype=new y;K.prototype.layout=new m;K.prototype.append=function(a){alert(this.getLayout().formatWithException(a))};K.prototype.toString=function(){return"AlertAppender"};u.AlertAppender=K;F.prototype=new u.Appender;F.prototype.layout=new n;F.prototype.threshold=v.DEBUG;F.prototype.append=function(a){var b=this,c=function(c){var f=b.getLayout().formatWithException(a);return"string"==typeof f?c?f:[f]:c?f.join(" "):f},f=
window.console;if(f&&f.log){var d;d=f.debug&&v.DEBUG.isGreaterOrEqual(a.level)?"debug":f.info&&v.INFO.equals(a.level)?"info":f.warn&&v.WARN.equals(a.level)?"warn":f.error&&a.level.isGreaterOrEqual(v.ERROR)?"error":"log";if("function"==typeof f[d].apply)f[d].apply(f,c(!1));else f[d](c(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(c(!0))};F.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)};F.prototype.groupEnd=function(){window.console&&
window.console.groupEnd&&window.console.groupEnd()};F.prototype.toString=function(){return"BrowserConsoleAppender"};u.BrowserConsoleAppender=F;var Da=function(){return new XMLHttpRequest},Ea=[Da,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],za=!1,ra=function(a){for(var b=null,c,f=0,d=Ea.length;f<d;f++){c=Ea[f];try{return b=c(),za=c==Da&&"withCredentials"in b,ra=c,b}catch(D){}}a?a():k("getXmlHttp: unable to obtain XMLHttpRequest object")};
M.prototype=new y;M.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1E3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};M.prototype.layout=new H;M.prototype.toString=function(){return"AjaxAppender"};u.AjaxAppender=M;var A;(function(){function b(a,b,c,f,d){this.create(!1,null,a,b,c,f,d,this.defaults.focusPopUp)}function c(a,b,c,f,d,e){this.create(!0,a,b,c,f,d,e,!1)}var f=[];A=function(){};
var d=1;A.prototype=new y;A.prototype.create=function(b,c,e,l,m,g,r,n){function D(a,b){this.loggingEvent=a;this.levelName=a.level.name;this.formattedMessage=b}function p(a,b){this.name=a;this.initiallyExpanded=b}function pa(){}var V=this,S=!1,la=!1,q=!1,J=!1,ia=[],B=!0,ua=d++;l=x(l,this.defaults.initiallyMinimized);e=x(e,this.defaults.lazyInit);m=x(m,this.defaults.useDocumentWrite);var ha=this.defaults.newestMessageAtTop,C=this.defaults.scrollToLatestMessage;g=g?g:this.defaults.width;r=r?r:this.defaults.height;
var ka=this.defaults.maxMessages,t=this.defaults.showCommandLine,va=this.defaults.commandLineObjectExpansionDepth,H=this.defaults.showHideButton,y=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var F,na,K,z,A,R=b?"InPageAppender":"PopUpAppender",M=function(a){return la?(k(R+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0},N=function(){return q&&B&&!J};this.isNewestMessageAtTop=function(){return ha};this.setNewestMessageAtTop=function(a){ha=
!!a;N()&&z().setNewestAtTop(ha)};this.isScrollToLatestMessage=function(){return C};this.setScrollToLatestMessage=function(a){C=!!a;N()&&z().setScrollToLatest(C)};this.getWidth=function(){return g};this.setWidth=function(a){M("width")&&(g=w(a,g))};this.getHeight=function(){return r};this.setHeight=function(a){M("height")&&(r=w(a,r))};this.getMaxMessages=function(){return ka};this.setMaxMessages=function(a){ka=G(a,ka);N()&&z().setMaxMessages(ka)};this.isShowCommandLine=function(){return t};this.setShowCommandLine=
function(a){t=!!a;N()&&z().setShowCommandLine(t)};this.isShowHideButton=function(){return H};this.setShowHideButton=function(a){H=!!a;N()&&z().setShowHideButton(H)};this.isShowCloseButton=function(){return y};this.setShowCloseButton=function(a){y=!!a;N()&&z().setShowCloseButton(y)};this.getCommandLineObjectExpansionDepth=function(){return va};this.setCommandLineObjectExpansionDepth=function(a){va=G(a,va)};var W=l;this.isInitiallyMinimized=function(){return l};this.setInitiallyMinimized=function(a){M("initiallyMinimized")&&
(W=l=!!a)};this.isUseDocumentWrite=function(){return m};this.setUseDocumentWrite=function(a){M("useDocumentWrite")&&(m=!!a)};D.prototype.append=function(){z().log(this.levelName,this.formattedMessage)};p.prototype.append=function(){z().group(this.name,this.initiallyExpanded)};pa.prototype.append=function(){z().groupEnd()};var P=function(){K();S?J&&xa&&na():F();K()&&U()};this.append=function(a){if(B){var b=V.getLayout().formatWithException(a);ia.push(new D(a,b));P()}};this.group=function(a,b){B&&(ia.push(new p(a,
b)),P())};this.groupEnd=function(){B&&(ia.push(new pa),P())};var U=function(){for(;0<ia.length;)ia.shift().append();n&&z().focus()};this.setAddedToLogger=function(a){this.loggers.push(a);Q&&!e&&F()};this.clear=function(){N()&&z().clearLog();ia.length=0};this.focus=function(){N()&&z().focus()};this.focusCommandLine=function(){N()&&z().focusCommandLine()};this.focusSearch=function(){N()&&z().focusSearch()};var L=window;this.getCommandWindow=function(){return L};this.setCommandWindow=function(a){L=a};
this.executeLastCommand=function(){N()&&z().evalLastCommand()};var aa=new E("%m");this.getCommandLayout=function(){return aa};this.setCommandLayout=function(a){aa=a};this.evalCommandAndAppend=function(b){var c={appendResult:!0,isError:!1},f="";try{var d,e;!L.eval&&L.execScript&&L.execScript("null");var l={};e=0;for(len=ja.length;e<len;e++)l[ja[e][0]]=ja[e][1];var m=[],g=function(a){m.push([a,L[a]])};g("appender");L.appender=V;g("commandReturnValue");L.commandReturnValue=c;g("commandLineFunctionsHash");
L.commandLineFunctionsHash=l;l=function(a){g(a);L[a]=function(){return this.commandLineFunctionsHash[a](V,arguments,c)}};e=0;for(len=ja.length;e<len;e++)l(ja[e][0]);L===window&&L.execScript?(g("evalExpr"),g("result"),window.evalExpr=b,L.execScript("window.result=eval(window.evalExpr);"),d=window.result):d=L.eval(b);f=a(d)?d:ga(d,va);e=0;for(len=m.length;e<len;e++)L[m[e][0]]=m[e][1]}catch(La){f="Error evaluating command: "+h(La),c.isError=!0}c.appendResult&&(b=">>> "+b,a(f)||(b+="\r\n"+f),f=new qa(null,
new Date,c.isError?v.ERROR:v.INFO,[b],null),b=this.getLayout(),this.setLayout(aa),this.append(f),this.setLayout(b))};var ja=f.concat([]);this.addCommandLineFunction=function(a,b){ja.push([a,b])};this.storeCommandHistory=function(a){a=a.join(",");var b=void 0,b=b?"; path="+b:"";document.cookie=escape("log4javascriptCommandHistory")+"="+escape(a)+""+b};var Y=function(a){var b=['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',
"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\x3c!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work --\x3e",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;\x3c/script>','\x3c!--[if IE]><script type="text/javascript">isIe = true\x3c/script><![endif]--\x3e','\x3c!--[if lt IE 7]><script type="text/javascript">isIePre7 = true\x3c/script><![endif]--\x3e',
'<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}",
"this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",
'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',
"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",
'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}',
'GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",
'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',
"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}",
"this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}",
"this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",
'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}',
'LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}',
'LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',
"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}',
'this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',
"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",
'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}',
'logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',
"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}",
"var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}",
"matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",
'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}",
"var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}",
"return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}",
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}",
"displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}",
"var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",
'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}',
'function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}',
'function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}",
"searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}",
"return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',
"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+",
"preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}",
"logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}",
"var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}",
"setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',
"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}",
"this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}',
'currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}',
'addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}",
"function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}',
'function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}',
'if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',
"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}',
'function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}',
'function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}",
"function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}",
"currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}",
"return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-',
'($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}",
"this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}",
"return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}",
"return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',
"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',
"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}",
"currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]\x3e","\x3c/script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}",
"</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>',
'<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>',
'<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />',
'<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>',
'<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>',
'<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>',
'<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />',
'<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />',
'<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];a.open();for(var c=0,f=b.length;c<f;c++)a.writeln(b[c]);a.close()};this.setEventTypes(["load","unload"]);var Z=function(){var a=z();a.setAppender(V);a.setNewestAtTop(ha);a.setScrollToLatest(C);a.setMaxMessages(ka);a.setShowCommandLine(t);a.setShowHideButton(H);a.setShowCloseButton(y);a.setMainWindow(window);var b;a:{b=escape("log4javascriptCommandHistory")+
"=";for(var c=document.cookie.split(";"),f=0,d=c.length;f<d;f++){for(var e=c[f];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b)){b=unescape(e.substring(b.length,e.length));break a}}b=null}b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length);V.dispatchEvent("load",{win:a})};this.unload=function(){I.debug("unload "+this+", caller: "+this.unload.caller);J||(I.debug("really doing unload "+this),J=!0,la=q=!1,V.dispatchEvent("unload",{}))};var Ha=function(a,
b,c,f){var d=setInterval(function(){try{J&&clearInterval(d),a(z())&&(clearInterval(d),c())}catch(sa){clearInterval(d),B=!1,k(f,sa)}},b)},da=function(){var a=document.domain!=location.hostname;if(m)a="";else{var b;a:{b=document.getElementsByTagName("script");for(var c=0,f=b.length;c<f;++c)if(-1!=b[c].src.indexOf("log4javascript")){f=b[c].src.lastIndexOf("/");b=-1==f?"":b[c].src.substr(0,f+1);break a}b=null}a=b+"console.html"+(a?"?log4javascript_domain="+escape(document.domain):"")}return a};if(b){var X=
null,ta=[];this.addCssProperty=function(a,b){M("cssProperties")&&ta.push([a,b])};var ea=!1,T,fa=Ba+"_InPageAppender_"+ua;this.hide=function(){S&&la&&(N()&&z().$("command").blur(),T.style.display="none",W=!0)};this.show=function(){S&&(la?(T.style.display="block",this.setShowCommandLine(t),W=!1):ea||na(!0))};this.isVisible=function(){return!W&&!J};this.close=function(a){J||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||
(T.parentNode.removeChild(T),this.unload())};A=function(){function a(){try{l||V.show(),Z(),q=!0,U()}catch(Ka){B=!1,k("InPageAppender.open: unable to create console iframe",Ka)}}function b(){try{var b=function(a){return ba(a)};m&&Y(z().document);ba(z())?a():Ha(b,100,a,"InPageAppender.open: unable to create console iframe")}catch(sa){B=!1,k("InPageAppender.open: unable to create console iframe",sa)}}W=!1;T=X.appendChild(document.createElement("div"));T.style.width=g;T.style.height=r;T.style.border=
"solid gray 1px";for(var c=0,f=ta.length;c<f;c++)T.style[ta[c][0]]=ta[c][1];c=m?"":" src='"+da()+"'";T.innerHTML="<iframe id='"+fa+"' name='"+fa+"' width='100%' height='100%' frameborder='0'"+c+" scrolling='no'></iframe>";J=!1;c=function(a){try{return!!a&&!!a.document}catch(sa){return!1}};c(z())?b():Ha(c,100,b,"InPageAppender.open: unable to create console iframe");la=!0};na=function(a){if(a||!l)a=function(){if(c)try{var a=document.getElementById(c);1==a.nodeType&&(X=a);A()}catch(Ja){k("InPageAppender.init: invalid container element '"+
c+"' supplied",Ja)}else X=document.createElement("div"),X.style.position="fixed",X.style.left="0",X.style.right="0",X.style.bottom="0",document.body.appendChild(X),V.addCssProperty("borderWidth","1px 0 0 0"),V.addCssProperty("zIndex",1E6),A()},wa&&c&&c.appendChild?(X=c,A()):wa?a():u.addEventListener("load",a),ea=!0};F=function(){na();S=!0};z=function(){var a=window.frames[fa];if(a)return a};K=function(){return B&&!J?(la&&!q&&z()&&ba(z())&&(q=!0),q):!1}}else{var ma=V.defaults.useOldPopUp,ya=V.defaults.complainAboutPopUpBlocking,
xa=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return ma};this.setUseOldPopUp=function(a){M("useOldPopUp")&&(ma=!!a)};this.isComplainAboutPopUpBlocking=function(){return ya};this.setComplainAboutPopUpBlocking=function(a){M("complainAboutPopUpBlocking")&&(ya=!!a)};this.isFocusPopUp=function(){return n};this.setFocusPopUp=function(a){n=!!a};this.isReopenWhenClosed=function(){return xa};this.setReopenWhenClosed=function(a){xa=!!a};this.close=function(){I.debug("close "+this);try{O.close(),
this.unload()}catch(Ma){}};this.hide=function(){I.debug("hide "+this);N()&&this.close()};this.show=function(){I.debug("show "+this);la||A()};this.isVisible=function(){return K()};var O;A=function(){function a(){z().setCloseIfOpenerCloses(!ma||!m);Z();q=!0;U();Ha(d,500,e,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+g+",height="+r+",status,resizable",c="";try{var f=window.frameElement;f&&(c="_"+f.tagName+"_"+(f.name||f.id||""))}catch(Fa){c="_inaccessibleParentFrame"}c=
"PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+ua+c;ma&&m||(c=c+"_"+Ba);var d=function(a){if(J)return!0;try{return!!a&&a.closed}catch(Na){}return!1},e=function(){J||V.unload()};try{O=window.open(da(),c,b),J=!1,la=!0,O&&O.document?m&&ma&&ba(O)?(O.mainPageReloaded(),a()):(m&&Y(O.document),b=function(a){return!!a&&ba(a)},ba(O)?a():Ha(b,100,a,"PopUpAppender.init: unable to create console window")):(B=!1,I.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),ya&&k("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging."))}catch(Fa){k("PopUpAppender.init: error creating pop-up",
Fa)}};na=function(){l||A()};F=function(){na();S=!0};z=function(){return O};K=function(){if(B&&!a(O)&&!J){if(O.closed||q&&a(O.closed))return V.unload(),I.debug("PopUpAppender: pop-up closed"),!1;!q&&ba(O)&&(q=!0)}return B&&q&&!J}}this.getConsoleWindow=z};A.addGlobalCommandLineFunction=function(a,b){f.push([a,b])};b.prototype=new A;b.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,
scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0};b.prototype.toString=function(){return"PopUpAppender"};u.PopUpAppender=b;c.prototype=new A;c.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,
showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0};c.prototype.toString=function(){return"InPageAppender"};u.InPageAppender=c;u.InlineAppender=c})();(function(){function a(d,e,l,m,r){function h(a){a=a.style.cssText.split(";");for(var b="",c=0,f=a.length;c<f;c++){var b=a[c].split(":"),d=[];/^\s*$/.test(b[0])||d.push(g(b[0]).toLowerCase()+":"+g(b[1]));b=d.join(";")}return b}"string"!=typeof l&&(l="");m=!!m;r=!!r;var n;if("undefined"!=typeof e&&!e||d.nodeType==b.DOCUMENT_FRAGMENT_NODE){e=
"";r=0;for(n=d.childNodes.length;r<n;r++)e+=a(d.childNodes[r],!0,l+"  ");return e}switch(d.nodeType){case b.ELEMENT_NODE:var D=d.tagName.toLowerCase();e=(m?"\r\n"+l:"")+"<";r=d.prefix?d.prefix:d.outerHTML&&(new RegExp("<([^:]+):"+d.tagName+"[^>]*>","i")).test(d.outerHTML)?RegExp.$1.toLowerCase():"";(m=!!r)&&(e+=r+":");e+=D;r=0;for(n=d.attributes.length;r<n;r++){var k=d.attributes[r];k.specified&&null!==k.nodeValue&&"style"!==k.nodeName.toLowerCase()&&"string"===typeof k.nodeValue&&0!==k.nodeName.indexOf("_moz")&&
(e+=" "+k.nodeName.toLowerCase()+'="',e+=k.nodeValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),e+='"')}d.style.cssText&&""!==h(d)&&(e+=' style="'+h(d)+'"');if(t(f,D)||m&&!d.hasChildNodes())e+="/>";else{e+=">";m=!(1===d.childNodes.length&&d.childNodes[0].nodeType===b.TEXT_NODE);k=t(c,D);r=0;for(n=d.childNodes.length;r<n;r++)e+=a(d.childNodes[r],!0,l+"  ",m,k);d="</"+D+">";e+=m?"\r\n"+l+d:d}return e;case b.TEXT_NODE:if(d.nodeType==b.TEXT_NODE&&/^[ \t\r\n]*$/.test(d.nodeValue))e=
"";else{if(r)e=d.nodeValue;else{d=p(g(d.nodeValue));e=[];r=0;for(n=d.length;r<n;r++)e[r]=g(d[r]);e=e.join("\r\n"+l)}m&&(e="\r\n"+l+e)}return e;case b.CDATA_SECTION_NODE:return"<![CDATA["+d.nodeValue+"]]\x3e\r\n";case b.DOCUMENT_NODE:e="";r=0;for(n=d.childNodes.length;r<n;r++)e+=a(d.childNodes[r],!0,l);return e;default:return""}}var b={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,
DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},c=["script","pre"],f="br img hr param link area input col base meta".split(" ");(function(){A.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])});A.addGlobalCommandLineFunction("dir",function(a,b,c){a=[];c=0;for(var f=b.length;c<f;c++){var l=c,m;m=void 0;var g=b[c],r=0;for(m in g)r=Math.max(d(m).length,r);var h=[];for(m in g){var n="  "+W(d(m),r+2),k;try{k=p(d(g[m])).join(W("\r\n",r+6))}catch(ca){k=
"[Error obtaining property. Details: "+e(ca)+"]"}h.push(n+k)}m=h.join("\r\n");a[l]=m}return a.join("\r\n\r\n")});A.addGlobalCommandLineFunction("dirxml",function(b,c,f){b=[];f=0;for(var d=c.length;f<d;f++)b[f]=a(c[f]);return b.join("\r\n\r\n")});A.addGlobalCommandLineFunction("cd",function(a,b,c){var f;0===b.length||""===b[0]?(f=window,b="Command line set to run in main window"):b[0].window==b[0]?(f=b[0],b="Command line set to run in frame '"+b[0].name+"'"):(f=window.frames[b[0]])?b="Command line set to run in frame '"+
b[0]+"'":(c.isError=!0,b="Frame '"+b[0]+"' does not exist",f=a.getCommandWindow());a.setCommandWindow(f);return b});A.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1;a.clear()});A.addGlobalCommandLineFunction("keys",function(a,b,c){a=[];for(var f in b[0])a.push(f);return a});A.addGlobalCommandLineFunction("values",function(a,b,c){a=[];for(var f in b[0])try{a.push(b[0][f])}catch(ia){I.warn("values(): Unable to obtain value for key "+f+". Details: "+e(ia))}return a});A.addGlobalCommandLineFunction("expansionDepth",
function(a,b,c){var f=parseInt(b[0],10);if(isNaN(f)||0>f)return c.isError=!0,""+b[0]+" is not a valid expansion depth";a.setCommandLineObjectExpansionDepth(f);return"Object expansion depth set to "+f})})()})();u.setDocumentReady=function(){wa=!0;u.dispatchEvent("load",{})};if(window.addEventListener)window.addEventListener("load",u.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",u.setDocumentReady);else{var Ga=window.onload;window.onload="function"!=typeof window.onload?
u.setDocumentReady:function(a){Ga&&Ga(a);u.setDocumentReady()}}return u},this);CryptoJS=CryptoJS||function(a,c){var b={},d=b.lib={},e=function(){},h=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
g=d.WordArray=h.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=c?b:4*a.length},toString:function(a){return(a||q).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-
c%4*8;b.length=a.ceil(c/4)},clone:function(){var a=h.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),p=b.enc={},q=p.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new g.init(c,b/2)}},t=p.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new g.init(c,b)}},x=p.Utf8={stringify:function(a){try{return decodeURIComponent(escape(t.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return t.parse(unescape(encodeURIComponent(a)))}},
w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,h=this.blockSize,k=e/(4*h),k=b?a.ceil(k):a.max((k|0)-this._minBufferSize,0);b=k*h;e=a.min(4*b,e);if(b){for(var p=0;p<b;p+=h)this._doProcessBlock(d,p);p=d.splice(0,b);c.sigBytes-=e}return new g.init(p,e)},clone:function(){var a=h.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new G.HMAC.init(a,
c)).finalize(b)}}});var G=b.algo={};return b}(Math);
(function(){var a=CryptoJS,c=a.lib,b=c.WordArray,d=c.Hasher,e=[],c=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],g=c[1],h=c[2],w=c[3],G=c[4],k=0;80>k;k++){if(16>k)e[k]=a[b+k]|0;else{var f=e[k-3]^e[k-8]^e[k-14]^e[k-16];e[k]=f<<1|f>>>31}f=(d<<5|d>>>27)+G+e[k];f=20>k?f+((g&h|~g&w)+1518500249):40>k?f+((g^h^w)+1859775393):60>k?f+((g&h|g&w|h&w)-1894007588):f+((g^h^
w)-899497514);G=w;w=h;h=g<<30|g>>>2;g=d;d=f}c[0]=c[0]+d|0;c[1]=c[1]+g|0;c[2]=c[2]+h|0;c[3]=c[3]+w|0;c[4]=c[4]+G|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(c);a.HmacSHA1=d._createHmacHelper(c)})();
(function(){var a=CryptoJS,c=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,d){a=this._hasher=new a.init;"string"==typeof d&&(d=c.parse(d));var b=a.blockSize,h=4*b;d.sigBytes>h&&(d=a.finalize(d));d.clamp();for(var g=this._oKey=d.clone(),p=this._iKey=d.clone(),q=g.words,t=p.words,x=0;x<b;x++)q[x]^=1549556828,t[x]^=909522486;g.sigBytes=p.sigBytes=h;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=
this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();
(function(a){for(var c,b,d=document.getElementsByTagName("head")[0].style,e=["transformProperty","WebkitTransform","OTransform","msTransform","MozTransform"],h=0;h<e.length;h++)void 0!==d[e[h]]&&(c=e[h]);c&&(b=c.replace(/[tT]ransform/,"TransformOrigin"),"T"==b[0]&&(b[0]="t"));eval('IE = "v"=="\v"');jQuery.fn.extend({rotate:function(b){if(0!==this.length&&"undefined"!=typeof b){"number"==typeof b&&(b={angle:b});for(var c=[],d=0,e=this.length;d<e;d++){var g=this.get(d);if(g.Wilq32&&g.Wilq32.PhotoEffect)g.Wilq32.PhotoEffect._handleRotation(b);
else{var h=a.extend(!0,{},b),g=(new Wilq32.PhotoEffect(g,h))._rootObj;c.push(a(g))}}return c}},getRotateAngle:function(){for(var a=[],b=0,c=this.length;b<c;b++){var d=this.get(b);d.Wilq32&&d.Wilq32.PhotoEffect&&(a[b]=d.Wilq32.PhotoEffect._angle)}return a},stopRotate:function(){for(var a=0,b=this.length;a<b;a++){var c=this.get(a);c.Wilq32&&c.Wilq32.PhotoEffect&&clearTimeout(c.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return c?function(a,b){a.Wilq32={PhotoEffect:this};
this._img=this._rootObj=this._eventObj=a;this._handleRotation(b)}:function(a,b){this._img=a;this._onLoadDelegate=[b];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};a.parentNode.insertBefore(this._rootObj,a);if(a.complete)this._Loader();else{var c=this;jQuery(this._img).bind("load",function(){c._Loader()})}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(a){this._parameters=this._parameters||{};"number"!==
typeof this._angle&&(this._angle=0);"number"===typeof a.angle&&(this._angle=a.angle);this._parameters.animateTo="number"===typeof a.animateTo?a.animateTo:this._angle;this._parameters.step=a.step||this._parameters.step||null;this._parameters.easing=a.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration="duration"in a?a.duration:a.duration||this._parameters.duration||1E3;this._parameters.callback=a.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=
a.center||this._parameters.center||["50%","50%"];this._rotationCenterX="string"==typeof this._parameters.center[0]?parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._parameters.center[0];this._rotationCenterY="string"==typeof this._parameters.center[1]?parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._parameters.center[1];a.bind&&a.bind!=this._parameters.bind&&this._BindEvents(a.bind)},_emptyFunction:function(){},_defaultEasing:function(a,
b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},_handleRotation:function(a,b){c||this._img.complete||b?(this._setupParameters(a),this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()):this._onLoadDelegate.push(a)},_BindEvents:function(a){if(a&&this._eventObj){if(this._parameters.bind){var b=this._parameters.bind,c;for(c in b)b.hasOwnProperty(c)&&jQuery(this._eventObj).unbind(c,b[c])}this._parameters.bind=a;for(c in a)a.hasOwnProperty(c)&&jQuery(this._eventObj).bind(c,a[c])}},
_Loader:function(){return IE?function(){var a=this._img.width,b=this._img.height;this._imgWidth=a;this._imgHeight=b;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=b+"px";this._vimage.style.width=a+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=a;this._container.style.height=
b;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",a-1+","+(b-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=a+"px";this._rootObj.style.height=b+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;for(this._eventObj=this._rootObj;a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var a=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*a;this._height=3*a;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement("canvas");
this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;for(this._cnv=this._canvas.getContext("2d");a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var a=+new Date,b=a-this._animateStartTime>this._parameters.duration;if(b&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img)a=this._parameters.easing(0,a-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration),
this._rotate(~~(10*a)/10);this._parameters.step&&this._parameters.step(this._angle);var c=this;this._timer=setTimeout(function(){c._animate.call(c)},10)}this._parameters.callback&&b&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var a=Math.PI/180;return IE?function(a){this._angle=a;this._container.style.rotation=a%360+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=
-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:c?function(a){this._angle=a;this._img.style[c]="rotate("+a%360+"deg)";this._img.style[b]=this._parameters.center.join(" ")}:function(b){this._angle=b;b=b%360*a;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,
this._rotationCenterY);this._cnv.rotate(b);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(g){return function(a){return document.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())})(jQuery);
(function(a){a.fn.flexVerticalCenter=function(c){var b=a.extend({cssAttribute:"margin-top",verticalOffset:0,parentSelector:null,debounceTimeout:25,deferTilWindowLoad:!1},c||{});return this.each(function(){var c=a(this),e,h=function(){var a=b.parentSelector&&c.parents(b.parentSelector).length?c.parents(b.parentSelector).first().height():c.parent().height();c.css(b.cssAttribute,(a-c.height())/2+parseInt(b.verticalOffset));void 0!==b.complete&&b.complete()};a(window).resize(function(){clearTimeout(e);
e=setTimeout(h,b.debounceTimeout)});b.deferTilWindowLoad||h();a(window).load(function(){h()})})}})(jQuery);
(function(a){var c;try{c="string"==typeof a("body").css("background-position-x")}catch(b){c=!1}a._spritely={instances:{},animate:function(b){var c=a(b.el),e=c.attr("id");if(!a._spritely.instances[e])return this;b=a.extend(b,a._spritely.instances[e]||{});if("sprite"==b.type&&b.fps){b.play_frames&&!a._spritely.instances[e].remaining_frames?a._spritely.instances[e].remaining_frames=b.play_frames+1:b.do_once&&!a._spritely.instances[e].remaining_frames&&(a._spritely.instances[e].remaining_frames=b.no_of_frames);
var h,g=function(c){var d=b.width;if(!h){h=[];for(var g=total=0;g<b.no_of_frames;g++)h[h.length]=0-total,total+=d}if(0==a._spritely.instances[e].current_frame){if(b.on_first_frame)b.on_first_frame(c)}else if(a._spritely.instances[e].current_frame==h.length-1&&b.on_last_frame)b.on_last_frame(c);if(b.on_frame&&b.on_frame[a._spritely.instances[e].current_frame])b.on_frame[a._spritely.instances[e].current_frame](c);a._spritely.instances[e].current_frame=1==b.rewind?0>=a._spritely.instances[e].current_frame?
h.length-1:a._spritely.instances[e].current_frame-1:a._spritely.instances[e].current_frame>=h.length-1?0:a._spritely.instances[e].current_frame+1;d=a._spritely.getBgY(c);c.css("background-position",h[a._spritely.instances[e].current_frame]+"px "+d);if(b.bounce&&0<b.bounce[0]&&0<b.bounce[1]){var d=b.bounce[0],g=b.bounce[1],p=b.bounce[2];c.animate({top:"+="+d+"px",left:"-="+g+"px"},p).animate({top:"-="+d+"px",left:"+="+g+"px"},p)}};if(a._spritely.instances[e].remaining_frames&&0<a._spritely.instances[e].remaining_frames){a._spritely.instances[e].remaining_frames--;
if(0==a._spritely.instances[e].remaining_frames)return a._spritely.instances[e].remaining_frames=-1,delete a._spritely.instances[e].remaining_frames,this;g(c)}else-1!=a._spritely.instances[e].remaining_frames&&g(c)}else if("pan"==b.type&&!a._spritely.instances[e]._stopped){var g=b.speed||1,p=a._spritely.instances[e].l||parseInt(a._spritely.getBgX(c).replace("px",""),10)||0,q=a._spritely.instances[e].t||parseInt(a._spritely.getBgY(c).replace("px",""),10)||0;if(b.do_once&&!a._spritely.instances[e].remaining_frames||
0>=a._spritely.instances[e].remaining_frames){switch(b.dir){case "up":case "down":a._spritely.instances[e].remaining_frames=Math.floor((b.img_height||0)/g);break;case "left":case "right":a._spritely.instances[e].remaining_frames=Math.floor((b.img_width||0)/g)}a._spritely.instances[e].remaining_frames++}else b.do_once&&a._spritely.instances[e].remaining_frames--;switch(b.dir){case "up":g*=-1;case "down":a._spritely.instances[e].l||(a._spritely.instances[e].l=p);a._spritely.instances[e].t=q+g;b.img_height&&
(a._spritely.instances[e].t%=b.img_height);break;case "left":g*=-1;case "right":a._spritely.instances[e].t||(a._spritely.instances[e].t=q),a._spritely.instances[e].l=p+g,b.img_width&&(a._spritely.instances[e].l%=b.img_width)}g=a._spritely.instances[e].l.toString();g=-1==g.indexOf("%")?g+"px ":g+" ";p=a._spritely.instances[e].t.toString();p=-1==p.indexOf("%")?p+"px ":p+" ";a(c).css("background-position",g+p);if(b.do_once&&!a._spritely.instances[e].remaining_frames)return this}a._spritely.instances[e].options=
b;a._spritely.instances[e].timeout=window.setTimeout(function(){a._spritely.animate(b)},parseInt(1E3/b.fps))},randomIntBetween:function(a,c){return parseInt(rand_no=Math.floor((c-(a-1))*Math.random())+a)},getBgUseXY:c,getBgY:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-y")||"0":(a(b).css("background-position")||" ").split(" ")[1]},getBgX:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-x")||"0":(a(b).css("background-position")||" ").split(" ")[0]},
get_rel_pos:function(a,c){var b=a;if(0>a)for(;0>b;)b+=c;else for(;b>c;)b-=c;return b},_spStrip:function(a,c){for(;a.length;){var b,d,g=!1,p=!1;for(b=0;b<c.length;b++){var q=a.slice(0,1);d=a.slice(1);-1<c.indexOf(q)?a=d:g=!0}for(b=0;b<c.length;b++)q=a.slice(-1),d=a.slice(0,-1),-1<c.indexOf(q)?a=d:p=!0;if(g&&p)return a}return""}};a.fn.extend({spritely:function(b){var c=a(this),e=c.attr("id");b=a.extend({type:"sprite",do_once:!1,width:null,height:null,img_width:0,img_height:0,fps:12,no_of_frames:2,play_frames:0},
b||{});var h=new Image,g=a._spritely._spStrip(c.css("background-image")||"",'url("); ');a._spritely.instances[e]||(a._spritely.instances[e]=b.start_at_frame?{current_frame:b.start_at_frame-1}:{current_frame:-1});a._spritely.instances[e].type=b.type;a._spritely.instances[e].depth=b.depth;b.el=c;b.width=b.width||c.width()||100;b.height=b.height||c.height()||100;h.onload=function(){b.img_width=h.width;b.img_height=h.height;b.img=h;b.do_once?setTimeout(function(){a._spritely.animate(b)},0):setTimeout(function(){a._spritely.animate(b)},
parseInt(1E3/b.fps))};h.src=g;return this},sprite:function(b){b=a.extend({type:"sprite",bounce:[0,0,1E3]},b||{});return a(this).spritely(b)},pan:function(b){b=a.extend({type:"pan",dir:"left",continuous:!0,speed:1},b||{});return a(this).spritely(b)},flyToTap:function(b){b=a.extend({el_to_move:null,type:"moveToTap",ms:1E3,do_once:!0},b||{});b.el_to_move&&a(b.el_to_move).active();a._spritely.activeSprite&&(window.Touch?a(this)[0].ontouchstart=function(b){var c=a._spritely.activeSprite,d=b.touches[0];
b=d.pageY-c.height()/2;d=d.pageX-c.width()/2;c.animate({top:b+"px",left:d+"px"},1E3)}:a(this).click(function(b){var c=a._spritely.activeSprite;a(c).stop(!0);var d=c.width(),g=c.height();c.animate({top:b.pageY-g/2+"px",left:b.pageX-d/2+"px"},1E3)}));return this},isDraggable:function(b){if(!a(this).draggable)return this;b=a.extend({type:"isDraggable",start:null,stop:null,drag:null},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;a._spritely.instances[c].isDraggableOptions=b;
a(this).draggable({start:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!0;a(this).stop(!0);a._spritely.instances[b].isDraggableOptions.start&&a._spritely.instances[b].isDraggableOptions.start(this)},drag:b.drag,stop:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!1;a._spritely.instances[b].isDraggableOptions.stop&&a._spritely.instances[b].isDraggableOptions.stop(this)}});return this},active:function(){a._spritely.activeSprite=this;return this},
activeOnClick:function(){var b=a(this);window.Touch?b[0].ontouchstart=function(c){a._spritely.activeSprite=b}:b.click(function(c){a._spritely.activeSprite=b});return this},spRandom:function(b){b=a.extend({top:50,left:50,right:290,bottom:320,speed:4E3,pause:0},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;if(!a._spritely.instances[c].stop_random){var e=a._spritely.randomIntBetween,h=e(b.top,b.bottom),e=e(b.left,b.right);a("#"+c).animate({top:h+"px",left:e+"px"},b.speed)}window.setTimeout(function(){a("#"+
c).spRandom(b)},b.speed+b.pause);return this},makeAbsolute:function(){return this.each(function(){var b=a(this),c=b.position();b.css({position:"absolute",marginLeft:0,marginTop:0,top:c.top,left:c.left}).remove().appendTo("body")})},spSet:function(b,c){var d=a(this).attr("id");a._spritely.instances[d][b]=c;return this},spGet:function(b,c){var d=a(this).attr("id");return a._spritely.instances[d][b]},spStop:function(b){this.each(function(){var c=a(this),e=c.attr("id");a._spritely.instances[e].options.fps&&
(a._spritely.instances[e]._last_fps=a._spritely.instances[e].options.fps);"sprite"==a._spritely.instances[e].type&&c.spSet("fps",0);a._spritely.instances[e]._stopped=!0;if(a._spritely.instances[e]._stopped_f1=b)e=a._spritely.getBgY(a(this)),c.css("background-position","0 "+e)});return this},spStart:function(){a(this).each(function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._last_fps||12;"sprite"==a._spritely.instances[b].type&&a(this).spSet("fps",c);a._spritely.instances[b]._stopped=!1});
return this},spToggle:function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._stopped_f1||!1;a._spritely.instances[b]._stopped?a(this).spStart():a(this).spStop(c);return this},fps:function(b){a(this).each(function(){a(this).spSet("fps",b)});return this},goToFrame:function(b){var c=a(this).attr("id");a._spritely.instances&&a._spritely.instances[c]&&(a._spritely.instances[c].current_frame=b-1);return this},spSpeed:function(b){a(this).each(function(){a(this).spSet("speed",b)});return this},spRelSpeed:function(b){a(this).each(function(){var c=
a(this).spGet("depth")/100;a(this).spSet("speed",b*c)});return this},spChangeDir:function(b){a(this).each(function(){a(this).spSet("dir",b)});return this},spState:function(b){a(this).each(function(){var c=(b-1)*a(this).height()+"px",c=a._spritely.getBgX(a(this))+" -"+c;a(this).css("background-position",c)});return this},lockTo:function(b,c){a(this).each(function(){var d=a(this).attr("id");if(!a._spritely.instances[d])return this;a._spritely.instances[d].locked_el=a(this);a._spritely.instances[d].lock_to=
a(b);a._spritely.instances[d].lock_to_options=c;a._spritely.instances[d].interval=window.setInterval(function(){if(a._spritely.instances[d].lock_to){var b=a._spritely.instances[d].locked_el,c=a._spritely.instances[d].lock_to,e=a._spritely.instances[d].lock_to_options,q=e.bg_img_width;c.height();var t=a._spritely.getBgY(c),c=a._spritely.getBgX(c),c=parseInt(c)+parseInt(e.left),e=parseInt(t)+parseInt(e.top),c=a._spritely.get_rel_pos(c,q);a(b).css({top:e+"px",left:c+"px"})}},c.interval||20)});return this},
destroy:function(){a(this);var b=a(this).attr("id");a._spritely.instances[b]&&a._spritely.instances[b].timeout&&window.clearTimeout(a._spritely.instances[b].timeout);a._spritely.instances[b]&&a._spritely.instances[b].interval&&window.clearInterval(a._spritely.instances[b].interval);delete a._spritely.instances[b];return this}})})(jQuery);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}
function soundinit(){vlg.sfx={};vlg.music={};vlg.muted=!1;vlg.isSFXOn=!0;vlg.isMusicOn=!0;(function(a){Howl.prototype.play=function(c,b){"SFX"===this.audioType&&!vlg.isSFXOn||"MUSIC"===this.audioType&&!vlg.isMusicOn||a.call(this,c,b);return this}})(Howl.prototype.play);void 0!==GameConfig.config.defaultClickSound?(console.log("using sounds from GameConfig loaded from config sheet."),console.log("defaultClickSound",GameConfig.config.defaultClickSound),vlg.sfx.select=new Howl({urls:[GameConfig.config.defaultClickSound],
volume:1}),vlg.sfx.build=new Howl({urls:[GameConfig.config.defaultBuildSound],volume:.6}),vlg.sfx.cancel=new Howl({urls:[GameConfig.config.defaultCancelSound],volume:.8}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!0,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}),vlg.sfx.select.audioType="SFX",vlg.sfx.build.audioType="SFX",vlg.sfx.cancel.audioType="SFX",vlg.music.welcome.audioType=
"Music",vlg.music.levelfull1.audioType="Music"):(console.log("using sounds urls hardcoded in usehowler.js"),vlg.sfx.select=new Howl({urls:["/client/assets/audio/click.mp3"],volume:1}),vlg.sfx.cancel=new Howl({urls:["/client/assets/audio/cancel.mp3"],volume:.9}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!1,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}))}
function afterplay(a){vlg.log.info("Played ",a)}
function bindSounds(){vlg.log.info("binding sound");$("#goalButton").click(function(a){vlg.log.debug("#goalButton click   .",a)});$("#topToolbar").click(function(a){vlg.log.info("toptoolbar click",a)});$("#topToolbar").children().click(function(a){vlg.log.debug(" toolbar children click .",a);vlg.sfx.select.play(afterplay)});$(".ui-dialog-titlebar-close").click(function(){vlg.log.debug("binding cancel sound to cancel buttons.");vlg.sfx.cancel.play()})}
function toggleSound(){vlg.log.info("toggling Sound ",vlg.muted);vlg.muted?(Howler.unmute(),vlg.muted=!1):(Howler.mute(),vlg.muted=!0);vlg.log.info("now ",vlg.muted);return vlg.muted}function toggleMusic(){vlg.isMusicOn?vlg.music.levelfull1.volume(1):vlg.music.levelfull1.volume(0)}vlg.soundinit=soundinit;vlg.bindSounds=bindSounds;vlg.toggleSound=toggleSound;
$(document).ready(function(){vlg.log.info("Enabling sound and mute");$("#volume").click(function(){vlg.toggleSound();$("#volume").find("img").toggle()});vlg.log.debug("#volume",$("#volume"));vlg.log.debug("#volume kids",$("#volume").children());vlg.log.debug("toogleSound ",vlg.toggleSound)});
(function(){var a={},c=null,b=!0,d=!1;try{"undefined"!==typeof AudioContext?c=new AudioContext:"undefined"!==typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!==typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"===typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){a=parseFloat(a);if(0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){this._setMuted(!0);return this},unmute:function(){this._setMuted(!1);return this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var f=0;f<this._howls[c]._audioNode.length;f++)this._howls[c]._audioNode[f].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var f=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=f;d.connect(c.destination);"undefined"===typeof d.start?
d.noteOn(0):d.start(0);setTimeout(function(){if(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1)},0)};window.addEventListener("touchend",b,!1);return a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!==typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};t.prototype={load:function(){var a=this,b=null;if(d)a.on("loaderror",Error("No audio support."));else{for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else if(g=a._urls[c],(e=/^data:audio\/([^;,]+);/i.exec(g))||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),e)e=e[1].toLowerCase();else{a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
return}if(p[e]){b=a._urls[c];break}}if(b){a._src=b;if(a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));
a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a}a.on("loaderror",Error("No codec support for selected audio sources."))}},urls:function(a){return a?(this.stop(),this._urls="string"===typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var f=this;"function"===typeof a&&(b=a);a&&"function"!==typeof a||(a="_default");if(!f._loaded)return f.on("load",function(){f.play(a,b)}),f;if(!f._sprite[a])return"function"===
typeof b&&b(),f;f._inactiveNode(function(d){d._sprite=a;var e=0<d._pos?d._pos:f._sprite[a][0]/1E3,l=0;f._webAudio?(l=f._sprite[a][1]/1E3-d._pos,0<d._pos&&(e=f._sprite[a][0]/1E3+e)):l=f._sprite[a][1]/1E3-(e-f._sprite[a][0]/1E3);var m=!(!f._loop&&!f._sprite[a][2]),g="string"===typeof b?b:Math.round(Date.now()*Math.random())+"",h;(function(){h=setTimeout(function(){!f._webAudio&&m&&f.stop(g).play(a,g);f._webAudio&&!m&&(f._nodeById(g).paused=!0,f._nodeById(g)._pos=0,f._clearEndTimer(g));f._webAudio||
m||f.stop(g);f.on("end",g)},l/f._rate*1E3);f._onendTimer.push({timer:h,id:g})})();if(f._webAudio){var n=f._sprite[a][0]/1E3,p=f._sprite[a][1]/1E3;d.id=g;d.paused=!1;k(f,[m,n,p],g);f._playStart=c.currentTime;d.gain.value=f._volume;"undefined"===typeof d.bufferSource.start?m?d.bufferSource.noteGrainOn(0,e,86400):d.bufferSource.noteGrainOn(0,e,l):m?d.bufferSource.start(0,e,86400):d.bufferSource.start(0,e,l)}else if(4===d.readyState||!d.readyState&&navigator.isCocoonJS)d.readyState=4,d.id=g,d.currentTime=
e,d.muted=q._muted||d.muted,d.volume=f._volume*q.volume(),setTimeout(function(){d.play()},0);else return f._clearEndTimer(g),function(){var c=a,e=b,l=function(){f.play(c,e);d.removeEventListener("canplaythrough",l,!1)};d.addEventListener("canplaythrough",l,!1)}(),f;f.on("play");"function"===typeof b&&b(g);return f});return f},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,
a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();b.on("pause");return b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||
(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=0:c.muted=!0);return b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1);return b},volume:function(a,b){var c=this;a=parseFloat(a);if(0<=a&&1>=a){c._volume=a;if(!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var f=b?c._nodeById(b):c._activeNode();f&&(c._webAudio?f.gain.value=a:f.volume=a*q.volume());return c}return c._volume},loop:function(a){return"boolean"===typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"===typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var f=this;if(!f._loaded)return f.on("load",function(){f.pos(a)}),"number"===typeof a?f:f._pos||0;a=parseFloat(a);var d=b?f._nodeById(b):f._activeNode();if(d)return 0<=a?(f.pause(b),
d._pos=a,f.play(d._sprite,b),f):f._webAudio?d._pos+(c.currentTime-f._playStart):d.currentTime;if(0<=a)return f;for(d=0;d<f._audioNode.length;d++)if(f._audioNode[d].paused&&4===f._audioNode[d].readyState)return f._webAudio?f._audioNode[d]._pos:f._audioNode[d].currentTime},pos3d:function(a,b,c,d){var f=this;b="undefined"!==typeof b&&b?b:0;c="undefined"!==typeof c&&c?c:-.5;if(!f._loaded)return f.on("play",function(){f.pos3d(a,b,c,d)}),f;if(0<=a||0>a){if(f._webAudio){var e=d?f._nodeById(d):f._activeNode();
e&&(f._pos3d=[a,b,c],e.panner.setPosition(a,b,c),e.panner.panningModel=f._model||"HRTF")}}else return f._pos3d;return f},fade:function(a,b,c,d,e){var f=this,l=a>b?"down":"up",m=Math.abs(a-b)/.01,g=c/m;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var h=1;h<=m;h++)(function(){var a=Math.round(1E3*(f._volume+("up"===l?.01:-.01)*h))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},g*h)})()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},
fadeOut:function(a,b,c,d){var f=this;return f.fade(f._volume,a,b,function(){c&&c();f.pause(d);f.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}this._drainPool();return a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}this._drainPool();if(!b){var f;if(this._webAudio)f=this._setupAudioNode(),a(f);else{this.load();f=this._audioNode[this._audioNode.length-1];var d=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",e=function(){f.removeEventListener(d,e,!1);a(f)};f.addEventListener(d,e,!1)}}},_drainPool:function(){var a=0,b;for(b=0;b<this._audioNode.length;b++)this._audioNode[b].paused&&a++;for(b=this._audioNode.length-1;0<=b&&!(5>=a);b--)this._audioNode[b].paused&&
(this._webAudio&&this._audioNode[b].disconnect(0),a--,this._audioNode.splice(b,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}if(a=this._onendTimer[b])clearTimeout(a.timer),this._onendTimer.splice(b,1)},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;a[b]="undefined"===typeof c.createGain?c.createGainNode():c.createGain();a[b].gain.value=this._volume;a[b].paused=!0;a[b]._pos=0;a[b].readyState=4;a[b].connect(e);
a[b].panner=c.createPanner();a[b].panner.panningModel=this._model||"equalpower";a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]);a[b].panner.connect(a[b]);return a[b]},on:function(a,b){var c=this["_on"+a];if("function"===typeof b)c.push(b);else for(var f=0;f<c.length;f++)b?c[f].call(this,b):c[f].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var f=0;f<c.length;f++){if(b===c[f]){c.splice(f,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}};if(b)var x=function(b,c){if(c in a)b._duration=a[c].duration,G(b);else if(/^data:[^;]+;base64,/.test(c)){for(var f=atob(c.split(",")[1]),d=new Uint8Array(f.length),e=0;e<f.length;++e)d[e]=
f.charCodeAt(e);w(d.buffer,b,c)}else{var l=new XMLHttpRequest;l.open("GET",c,!0);l.responseType="arraybuffer";l.onload=function(){w(l.response,b,c)};l.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{l.send()}catch(H){l.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"===typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!==typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!==typeof window&&(window.Howler=q,window.Howl=t)})();
(function(a){var c={numberStep:function(b,c){var d=Math.floor(b);a(c.elem).text(d)}},b=function(a){var b=a.elem;b.nodeType&&b.parentNode&&(b=b._animateNumberSetter,b||(b=c.numberStep),b(a.now,a))};a.Tween&&a.Tween.propHooks?a.Tween.propHooks.number={set:b}:a.fx.step.number=b;a.animateNumber={numberStepFactories:{append:function(b){return function(c,d){var e=Math.floor(c);a(d.elem).prop("number",c).text(e+b)}},separator:function(b,c,h){b=b||" ";c=c||3;h=h||"";return function(d,e){var g=Math.floor(d).toString(),
p=a(e.elem);if(g.length>c){for(var x=g,w=c,G=x.split("").reverse(),g=[],k,f,l,m=0,n=Math.ceil(x.length/w);m<n;m++){k="";for(l=0;l<w;l++){f=m*w+l;if(f===x.length)break;k+=G[f]}g.push(k)}x=g.length-1;w=g[x].split("").reverse().join("");g[x]=parseInt(w,10).toString().split("").reverse().join("");g=g.join(b);g=g.split("").reverse().join("")}p.prop("number",d).text(g+h)}}}};a.fn.animateNumber=function(){for(var b=arguments[0],e=a.extend({},c,b),h=a(this),g=[e],p=1,q=arguments.length;p<q;p++)g.push(arguments[p]);
if(b.numberStep){var t=this.each(function(){this._animateNumberSetter=b.numberStep}),x=e.complete;e.complete=function(){t.each(function(){delete this._animateNumberSetter});x&&x.apply(this,arguments)}}return h.animate.apply(h,g)}})(jQuery);
(function(a){function c(){return document[h?"webkit"===h?"webkitIsFullScreen":h+"FullScreen":"fullScreen"]}function b(){return document[h?h+"CancelFullScreen":"cancelFullScreen"]()}var d="undefined"!==typeof document.cancelFullScreen,e=["webkit","moz","o","ms","khtml"],h="",g=function(){},p;if(!d)for(p=0;h=e[p];p++)if("undefined"!==typeof document[h+"CancelFullScreen"]){d=!0;break}d?(a.fn.requestFullScreen=function(){return this.each(function(){return this[h?h+"RequestFullScreen":"requestFullScreen"]()})},
a.fn.fullScreenChange=function(b){var c=[h+"fullscreenchange"].concat([].slice.call(arguments,0)),d=a(this);return d.bind.apply(d,c)},a.FullScreen={isFullScreen:c,cancelFullScreen:b}):(a.fn.requestFullScreen=a.fn.fullScreenChange=g,a.FullScreen={isFullScreen:function(){return!1},cancelFullScreen:g})})(jQuery);
(function(a,c){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():c.log4javascript=a()})(function(){function a(a){return"undefined"==typeof a}function c(){}function b(){}function d(a){return a&&a.toString?a.toString():String(a)}function e(a){return a.message?a.message:a.description?a.description:d(a)}function h(a){if(a){var b="Exception: "+e(a);try{if(a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName){var c=b,f,d=a.fileName,
l=Math.max(d.lastIndexOf("/"),d.lastIndexOf("\\"));f=d.substr(l+1);b=c+(" in file "+f)}}catch(ka){I.warn("Unable to obtain file and line information for error")}oa&&a.stack&&(b+="\r\nStack trace:\r\n"+a.stack);return b}return null}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function p(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}function q(a,b){for(var c=-1,f=0,d=a.length;f<d;f++)if(a[f]===b){c=f;break}return 0<=c?(a.splice(c,1),!0):!1}function t(a,b){for(var c=
0,f=a.length;c<f;c++)if(a[c]==b)return!0;return!1}function x(b,c){return a(b)?c:!!b}function w(b,c){return a(b)?c:String(b)}function G(b,c){if(a(b))return c;try{var f=parseInt(b,10);return isNaN(f)?c:f}catch(ha){return I.warn("Invalid int param "+b,ha),c}}function k(a,b){I.error(a,b);u.dispatchEvent("error",{message:a,exception:b})}function f(b,c){this.name=b;this.level=a(c)?v.INFO:c;this.start=new Date}function l(b){this.name=b;this.parent=null;this.children=[];var c=[],e=null,l="root"===this.name,
m="[null]"===this.name,g=null,r=!1;this.addChild=function(a){this.children.push(a);a.parent=this;a.invalidateAppenderCache()};var h=!0;this.getAdditivity=function(){return h};this.setAdditivity=function(a){var b=h!=a;h=a;b&&this.invalidateAppenderCache()};this.addAppender=function(a){m?k("Logger.addAppender: you may not add an appender to the null logger"):a instanceof u.Appender?t(c,a)||(c.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):k("Logger.addAppender: appender supplied ('"+
d(a)+"') is not a subclass of Appender")};this.removeAppender=function(a){q(c,a);a.setRemovedFromLogger(this);this.invalidateAppenderCache()};this.removeAllAppenders=function(){var a=c.length;if(0<a){for(var b=0;b<a;b++)c[b].setRemovedFromLogger(this);c.length=0;this.invalidateAppenderCache()}};this.getEffectiveAppenders=function(){if(null===g||r)g=(l||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders()).concat(c),r=!1;return g};this.invalidateAppenderCache=function(){r=!0;for(var a=0,b=
this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()};this.log=function(a,b){if(Q&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,f=b.length-1,d=b[f];1<b.length&&d instanceof Error&&(c=d,f--);for(var d=[],e=0;e<=f;e++)d[e]=b[e];c=new qa(this,new Date,a,d,c);this.callAppenders(c)}};this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,f=b.length;c<f;c++)b[c].doAppend(a)};this.setLevel=function(a){l&&null===a?k("Logger.setLevel: you cannot set the level of the root logger to null"):
a instanceof v?e=a:k("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")};this.getLevel=function(){return e};this.getEffectiveLevel=function(){for(var a=this;null!==a;a=a.parent){var b=a.getLevel();if(null!==b)return b}};this.group=function(a,b){if(Q)for(var c=this.getEffectiveAppenders(),f=0,d=c.length;f<d;f++)c[f].group(a,b)};this.groupEnd=function(){if(Q)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;b<c;b++)a[b].groupEnd()};var n={};this.time=
function(b,c){Q&&(a(b)?k("Logger.time: a name for the timer must be supplied"):!c||c instanceof v?n[b]=new f(b,c):k("Logger.time: level supplied to timer "+b+" is not an instance of log4javascript.Level"))};this.timeEnd=function(b){if(Q)if(a(b))k("Logger.timeEnd: a name for the timer must be supplied");else if(n[b]){var c=n[b],f=c.getElapsedTime();this.log(c.level,["Timer "+d(b)+" completed in "+f+"ms"]);delete n[b]}else I.warn("Logger.timeEnd: no timer found with name "+b)};this.assert=function(a){if(Q&&
!a){for(var b=[],c=1,f=arguments.length;c<f;c++)b.push(arguments[c]);b=0<b.length?b:["Assertion Failure"];b.push("\r\n");b.push(a);this.log(v.ERROR,b)}};this.toString=function(){return"Logger["+this.name+"]"}}function m(){this.customFields=[]}function n(){this.customFields=[]}function C(a){this.combineMessages=x(a,!0);this.customFields=[]}function B(a,b){this.readable=x(a,!1);this.combineMessages=x(b,!0);this.batchHeader=this.readable?"[\r\n":"[";this.batchFooter=this.readable?"]\r\n":"]";this.batchSeparator=
this.readable?",\r\n":",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?"\r\n":"";this.customFields=[]}function H(){this.setKeys();this.customFields=[];this.returnsPostData=!0}function ga(a,b,c){function f(a,b,c){function l(a){a=p(a);for(var b=1,f=a.length;b<f;b++)a[b]=c+a[b];return a.join("\r\n")}var m,g,r,n,k,D;c||(c="");if(null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return l(a);if("object"==
typeof a&&t(e,a)){try{k=d(a)}catch(ca){k="Error formatting property. Details: "+h(ca)}return k+" [already expanded]"}if(a instanceof Array&&0<b){e.push(a);k="[\r\n";g=b-1;r=c+"  ";n=[];m=0;for(b=a.length;m<b;m++)try{D=f(a[m],g,r),n.push(r+D)}catch(ca){n.push(r+"Error formatting array member. Details: "+h(ca)+"")}return k+=n.join(",\r\n")+"\r\n"+c+"]"}if("[object Date]"==Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&0<b){e.push(a);k="{\r\n";g=b-1;r=c+"  ";n=[];for(m in a)try{D=
f(a[m],g,r),n.push(r+m+": "+D)}catch(ca){n.push(r+m+": Error formatting property. Details: "+h(ca))}return k+=n.join(",\r\n")+"\r\n"+c+"}"}return l(d(a))}var e=[];return f(a,b,c)}function E(a){this.pattern=a?a:E.DEFAULT_CONVERSION_PATTERN;this.customFields=[]}function K(){}function F(){}function M(b,c){function f(a){return I?(k("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0}function d(){if(p&&Q){A=!0;var a;if(q)0<F.length?(a=F.shift(),g(l(a),
d)):(A=!1,J&&window.setTimeout(d,C));else{for(;a=F.shift();)g(l(a));A=!1;J&&window.setTimeout(d,C)}}}function e(){var a=!1;if(p&&Q){for(var a=n.getLayout().allowBatching()?B:1,b,c=[];b=ga.shift();)c.push(b),ga.length>=a&&(F.push(c),c=[]);0<c.length&&F.push(c);a=0<F.length;J=q=!1;d()}return a}function l(a){for(var b=[],c;c=a.shift();)b.push(n.getLayout().formatWithException(c));a=1==a.length?b.join(""):n.getLayout().batchHeader+b.join(n.getLayout().batchSeparator)+n.getLayout().batchFooter;H==n.defaults.contentType&&
(a=n.getLayout().returnsPostData?a:U(v)+"="+U(a),0<a.length&&(a+="&"),a+="layout="+U(n.getLayout().toString()));return a}function m(){k("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled");p=!1;u&&u("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled")}function g(f,d){try{var e=ra(m);if(p){e.onreadystatechange=function(){if(4==e.readyState){var c=e;a(c.status)||0===c.status||200<=c.status&&300>c.status||1223==c.status?(t&&t(e),d&&d(e)):(c="AjaxAppender.append: XMLHttpRequest request to URL "+
b+" returned status code "+e.status,k(c),u&&u(c));e.onreadystatechange=da;e=null}};e.open("POST",b,!0);c&&za&&(e.withCredentials=!0);try{for(var l=0,g;g=K[l++];)e.setRequestHeader(g.name,g.value);e.setRequestHeader("Content-Type",H)}catch(na){k("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");p=!1;u&&u("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");
return}e.send(f)}}catch(na){l="AjaxAppender.append: error sending log message to "+b,k(l,na),p=!1,u&&u(l+". Details: "+h(na))}}function r(){I=!0;if(E){var a=window.onbeforeunload;window.onbeforeunload=function(){a&&a();e()}}J&&window.setTimeout(d,C)}var n=this,p=!0;b||(k("AjaxAppender: URL must be specified in constructor"),p=!1);var J=this.defaults.timed,q=this.defaults.waitForResponse,B=this.defaults.batchSize,C=this.defaults.timerInterval,t=this.defaults.requestSuccessCallback,u=this.defaults.failCallback,
v=this.defaults.postVarName,E=this.defaults.sendAllOnUnload,H=this.defaults.contentType,y=null,ga=[],F=[],K=[],A=!1,I=!1;this.getSessionId=function(){return y};this.setSessionId=function(a){y=w(a,null);this.layout.setCustomField("sessionid",y)};this.setLayout=function(a){f("layout")&&(this.layout=a,null!==y&&this.setSessionId(y))};this.isTimed=function(){return J};this.setTimed=function(a){f("timed")&&(J=!!a)};this.getTimerInterval=function(){return C};this.setTimerInterval=function(a){f("timerInterval")&&
(C=G(a,C))};this.isWaitForResponse=function(){return q};this.setWaitForResponse=function(a){f("waitForResponse")&&(q=!!a)};this.getBatchSize=function(){return B};this.setBatchSize=function(a){f("batchSize")&&(B=G(a,B))};this.isSendAllOnUnload=function(){return E};this.setSendAllOnUnload=function(a){f("sendAllOnUnload")&&(E=x(a,E))};this.setRequestSuccessCallback=function(a){t="function"==typeof a?a:t};this.setFailCallback=function(a){u="function"==typeof a?a:u};this.getPostVarName=function(){return v};
this.setPostVarName=function(a){f("postVarName")&&(v=w(a,v))};this.getHeaders=function(){return K};this.addHeader=function(a,b){"content-type"==a.toLowerCase()?H=b:K.push({name:a,value:b})};this.sendAll=d;this.sendAllRemaining=e;this.append=function(a){if(p&&(I||r(),ga.push(a),a=this.getLayout().allowBatching()?B:1,ga.length>=a)){for(var b=[];a=ga.shift();)b.push(a);F.push(b);J||q&&(!q||A)||d()}}}function ba(a){try{return!!a.loaded}catch(J){return!1}}function W(a,b){if(a.length<b){for(var c=[],f=
Math.max(0,b-a.length),d=0;d<f;d++)c[d]=" ";a+=c.join("")}return a}Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length});Array.prototype.shift||(Array.prototype.shift=function(){if(0<this.length){for(var a=this[0],b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];--this.length;return a}});Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),f=this.slice(a,a+b);this.length=a;for(var d=
[],e=0,l=arguments.length;e<l;e++)d[e]=arguments[e];c=2<d.length?d.slice(2).concat(c):c;e=0;for(l=c.length;e<l;e++)this.push(c[e]);return f});c.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a;this.eventListeners={};a=0;for(var b=this.eventTypes.length;a<b;a++)this.eventListeners[this.eventTypes[a]]=[]}else k("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){"function"==
typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):k("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){"function"==typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),q(this.eventListeners[a],b)):k("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},
dispatchEvent:function(a,b){if(t(this.eventTypes,a))for(var c=this.eventListeners[a],f=0,d=c.length;f<d;f++)c[f](this,a,b);else k("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var Aa=new Date,Ba="log4javascript_"+Aa.getTime()+"_"+Math.floor(1E8*Math.random()),da=function(){},wa=!1;b.prototype=new c;var u=new b;u.version="1.4.13";u.edition="log4javascript";var U="undefined"!=typeof window.encodeURIComponent?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,
"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(a,b){var c="__apply__";"undefined"!=typeof a[c]&&(c+=String(Math.random()).substr(2));a[c]=this;for(var f=[],d=0,e=b.length;d<e;d++)f[d]="args["+d+"]";f="obj."+c+"("+f.join(",")+")";f=eval(f);delete a[c];return f});Function.prototype.call||(Function.prototype.call=function(a){for(var b=[],c=1,f=arguments.length;c<f;c++)b[c-1]=arguments[c];return this.apply(a,
b)});var I={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=!!a},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join("\r\n"))},warn:function(a,b){},error:function(a,b){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+="\r\n\r\nOriginal error: "+h(b));alert(c)}}};u.logLog=I;u.setEventTypes(["load",
"error"]);u.handleError=k;var Q=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);u.setEnabled=function(a){Q=!!a};u.isEnabled=function(){return Q};var ea=!0;u.setTimeStampsInMilliseconds=function(a){ea=!!a};u.isTimeStampsInMilliseconds=function(){return ea};u.evalInScope=function(a){return eval(a)};var oa=!1;u.setShowStackTraces=function(a){oa=!!a};var v=function(a,b){this.level=a;this.name=b};v.prototype={toString:function(){return this.name},equals:function(a){return this.level==
a.level},isGreaterOrEqual:function(a){return this.level>=a.level}};v.ALL=new v(Number.MIN_VALUE,"ALL");v.TRACE=new v(1E4,"TRACE");v.DEBUG=new v(2E4,"DEBUG");v.INFO=new v(3E4,"INFO");v.WARN=new v(4E4,"WARN");v.ERROR=new v(5E4,"ERROR");v.FATAL=new v(6E4,"FATAL");v.OFF=new v(Number.MAX_VALUE,"OFF");u.Level=v;f.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};l.prototype={trace:function(){this.log(v.TRACE,arguments)},debug:function(){this.log(v.DEBUG,arguments)},info:function(){this.log(v.INFO,
arguments)},warn:function(){this.log(v.WARN,arguments)},error:function(){this.log(v.ERROR,arguments)},fatal:function(){this.log(v.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(v.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(v.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(v.INFO)},isWarnEnabled:function(){return this.isEnabledFor(v.WARN)},isErrorEnabled:function(){return this.isEnabledFor(v.ERROR)},
isFatalEnabled:function(){return this.isEnabledFor(v.FATAL)}};l.prototype.trace.isEntryPoint=!0;l.prototype.debug.isEntryPoint=!0;l.prototype.info.isEntryPoint=!0;l.prototype.warn.isEntryPoint=!0;l.prototype.error.isEntryPoint=!0;l.prototype.fatal.isEntryPoint=!0;var aa={},Ia=[],Ca=v.DEBUG,Y=new l("root");Y.setLevel(Ca);u.getRootLogger=function(){return Y};u.getLogger=function(a){"string"!=typeof a&&(a="[anonymous]",I.warn("log4javascript.getLogger: non-string logger name "+d(a)+" supplied, returning anonymous logger"));
"root"==a&&k("log4javascript.getLogger: root logger may not be obtained by name");if(!aa[a]){var b=new l(a);aa[a]=b;Ia.push(a);var c=a.lastIndexOf(".");-1<c?(c=a.substring(0,c),c=u.getLogger(c)):c=Y;c.addChild(b)}return aa[a]};var fa=null;u.getDefaultLogger=function(){if(!fa){var a=u.getLogger("[default]"),b=new u.PopUpAppender;a.addAppender(b);fa=a}return fa};var Z=null;u.getNullLogger=function(){Z||(Z=new l("[null]"),Z.setLevel(v.OFF));return Z};u.resetConfiguration=function(){Y.setLevel(Ca);aa=
{}};var qa=function(a,b,c,f,d){this.logger=a;this.timeStamp=b;this.timeStampInMilliseconds=b.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1E3);this.milliseconds=this.timeStamp.getMilliseconds();this.level=c;this.messages=f;this.exception=d};qa.prototype={getThrowableStrRep:function(){return this.exception?h(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join("\r\n")},toString:function(){return"LoggingEvent["+
this.level+"]"}};u.LoggingEvent=qa;var R=function(){};R.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,
format:function(){k("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){k("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0;this.useTimeStampsInMilliseconds=!!a},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:ea},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?
a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]);a.exception&&c.push([this.exceptionKey,h(a.exception)]);if(this.hasCustomFields())for(var f=0,d=this.customFields.length;f<d;f++){var e=this.customFields[f].value;
"function"===typeof e&&(e=e(this,a));c.push([this.customFields[f].name,e])}return c},setKeys:function(a,b,c,f,d,e,l){this.loggerKey=w(a,this.defaults.loggerKey);this.timeStampKey=w(b,this.defaults.timeStampKey);this.levelKey=w(c,this.defaults.levelKey);this.messageKey=w(f,this.defaults.messageKey);this.exceptionKey=w(d,this.defaults.exceptionKey);this.urlKey=w(e,this.defaults.urlKey);this.millisecondsKey=w(l,this.defaults.millisecondsKey)},setCustomField:function(a,b){for(var c=!1,f=0,d=this.customFields.length;f<
d;f++)this.customFields[f].name===a&&(this.customFields[f].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return 0<this.customFields.length},formatWithException:function(a){var b=this.format(a);a.exception&&this.ignoresThrowable()&&(b+=a.getThrowableStrRep());return b},toString:function(){k("Layout.toString: all layouts must override this method")}};u.Layout=R;var y=function(){};y.prototype=new c;y.prototype.layout=new E;y.prototype.threshold=v.ALL;y.prototype.loggers=
[];y.prototype.doAppend=function(a){Q&&a.level.level>=this.threshold.level&&this.append(a)};y.prototype.append=function(a){};y.prototype.setLayout=function(a){a instanceof R?this.layout=a:k("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")};y.prototype.getLayout=function(){return this.layout};y.prototype.setThreshold=function(a){a instanceof v?this.threshold=a:k("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")};
y.prototype.getThreshold=function(){return this.threshold};y.prototype.setAddedToLogger=function(a){this.loggers.push(a)};y.prototype.setRemovedFromLogger=function(a){q(this.loggers,a)};y.prototype.group=da;y.prototype.groupEnd=da;y.prototype.toString=function(){k("Appender.toString: all appenders must override this method")};u.Appender=y;m.prototype=new R;m.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()};m.prototype.ignoresThrowable=function(){return!0};m.prototype.toString=
function(){return"SimpleLayout"};u.SimpleLayout=m;n.prototype=new R;n.prototype.format=function(a){return a.messages};n.prototype.ignoresThrowable=function(){return!0};n.prototype.formatWithException=function(a){var b=a.messages;return(a=a.exception)?b.concat([a]):b};n.prototype.toString=function(){return"NullLayout"};u.NullLayout=n;C.prototype=new R;C.prototype.isCombinedMessages=function(){return this.combineMessages};C.prototype.getContentType=function(){return"text/xml"};C.prototype.escapeCdata=
function(a){return a.replace(/\]\]>/,"]]\x3e]]&gt;<![CDATA[")};C.prototype.format=function(a){function b(a){a="string"===typeof a?a:d(a);return"<log4javascript:message><![CDATA["+c.escapeCdata(a)+"]]\x3e</log4javascript:message>"}var c=this,f,e,l='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';this.isTimeStampsInMilliseconds()||(l+=' milliseconds="'+a.milliseconds+'"');l+=' level="'+a.level.name+'">\r\n';if(this.combineMessages)l+=b(a.getCombinedMessages());
else{l+="<log4javascript:messages>\r\n";f=0;for(e=a.messages.length;f<e;f++)l+=b(a.messages[f])+"\r\n";l+="</log4javascript:messages>\r\n"}if(this.hasCustomFields())for(f=0,e=this.customFields.length;f<e;f++)l+='<log4javascript:customfield name="'+this.customFields[f].name+'"><![CDATA['+this.customFields[f].value.toString()+"]]\x3e</log4javascript:customfield>\r\n";a.exception&&(l+="<log4javascript:exception><![CDATA["+h(a.exception)+"]]\x3e</log4javascript:exception>\r\n");return l+"</log4javascript:event>\r\n\r\n"};
C.prototype.ignoresThrowable=function(){return!1};C.prototype.toString=function(){return"XmlLayout"};u.XmlLayout=C;B.prototype=new R;B.prototype.isReadable=function(){return this.readable};B.prototype.isCombinedMessages=function(){return this.combineMessages};B.prototype.format=function(a){function b(a,f,e){var l=typeof a;if(a instanceof Date)e=String(a.getTime());else if(e&&a instanceof Array){e="["+c.lineBreak;for(var l=0,m=a.length;l<m;l++){var g=f+c.tab;e+=g+b(a[l],g,!1);l<a.length-1&&(e+=",");
e+=c.lineBreak}e+=f+"]"}else e="number"!==l&&"boolean"!==l?'"'+d(a).replace(/\"/g,'\\"').replace(/\r\n|\r|\n/g,"\\r\\n")+'"':a;return e}var c=this;a=this.getDataValues(a,this.combineMessages);var f="{"+this.lineBreak,e,l;e=0;for(l=a.length-1;e<=l;e++)f+=this.tab+'"'+a[e][0]+'"'+this.colon+b(a[e][1],this.tab,!0),e<l&&(f+=","),f+=this.lineBreak;return f+="}"+this.lineBreak};B.prototype.ignoresThrowable=function(){return!1};B.prototype.toString=function(){return"JsonLayout"};B.prototype.getContentType=
function(){return"application/json"};u.JsonLayout=B;H.prototype=new R;H.prototype.allowBatching=function(){return!1};H.prototype.format=function(a){a=this.getDataValues(a);for(var b=[],c=0,f=a.length;c<f;c++){var d=a[c][1]instanceof Date?String(a[c][1].getTime()):a[c][1];b.push(U(a[c][0])+"="+U(d))}return b.join("&")};H.prototype.ignoresThrowable=function(a){return!1};H.prototype.toString=function(){return"HttpPostDataLayout"};u.HttpPostDataLayout=H;var P;(function(){var b=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,
c="January February March April May June July August September October November December".split(" "),f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d={G:0,y:3,M:4,w:2,W:2,D:2,d:2,F:2,E:1,a:0,H:2,k:2,K:2,h:2,m:2,s:2,S:2,Z:5},e=function(a,b,c){a=new Date(a,b,c,0,0,0);a.setMilliseconds(0);return a};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()};Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),
this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()};Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),a=new Date(a.getTime()-864E5*this.getDay());return e(a.getFullYear(),a.getMonth(),a.getDate())};Date.prototype.getWeekInYear=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),
f=e(this.getFullYear(),0,1),c=c.isBefore(f)?0:1+Math.floor(c.getTimeSince(f)/6048E5),f=7-f.getDay();f<b&&c--;return c};Date.prototype.getWeekInMonth=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),f=e(this.getFullYear(),this.getMonth(),1),c=c.isBefore(f)?0:1+Math.floor(c.getTimeSince(f)/6048E5),f=7-f.getDay();f>=b&&c++;return c};Date.prototype.getDayInYear=function(){var a=e(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/864E5)};P=function(a){this.formatString=
a};P.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a};P.prototype.getMinimalDaysInFirstWeek=function(){return a(this.minimalDaysInFirstWeek)?1:this.minimalDaysInFirstWeek};var l=function(a,b){for(;a.length<b;)a="0"+a;return a},m=function(a,b,c){return 4<=b?a:a.substr(0,Math.max(c,b))};P.prototype.format=function(a){for(var e="",g,h=this.formatString;g=b.exec(h);){var r=g[1],n=g[2],k=g[3],D=g[4];if(r)e="''"==r?e+"'":e+r.substring(1,r.length-1);else if(!k)if(D)e+=D;else if(n){r=
n.charAt(0);n=n.length;k="";switch(r){case "G":k="AD";break;case "y":k=a.getFullYear();break;case "M":k=a.getMonth();break;case "w":k=a.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case "W":k=a.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case "D":k=a.getDayInYear();break;case "d":k=a.getDate();break;case "F":k=1+Math.floor((a.getDate()-1)/7);break;case "E":k=f[a.getDay()];break;case "a":k=12<=a.getHours()?"PM":"AM";break;case "H":k=a.getHours();break;case "k":k=a.getHours()||24;
break;case "K":k=a.getHours()%12;break;case "h":k=a.getHours()%12||12;break;case "m":k=a.getMinutes();break;case "s":k=a.getSeconds();break;case "S":k=a.getMilliseconds();break;case "Z":k=a.getTimezoneOffset()}switch(d[r]){case 0:e+=m(k,n,2);break;case 1:e+=m(k,n,3);break;case 2:e+=l(""+k,n);break;case 3:e=3>=n?e+(""+k).substr(2,2):e+l(""+k,n);break;case 4:e=3<=n?e+m(c[k],n,n):e+l(""+(k+1),n);break;case 5:n=0<k?"-":"+",k=Math.abs(k),r=""+Math.floor(k/60),r=l(r,2),k=""+k%60,k=l(k,2),e+=n+r+k}}h=h.substr(g.index+
g[0].length)}return e}})();u.SimpleDateFormat=P;E.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";E.DEFAULT_CONVERSION_PATTERN="%m%n";E.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";E.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";E.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";E.prototype=new R;E.prototype.format=function(a){for(var b=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,c="",f,d=this.pattern;f=b.exec(d);){var e=f[0],l=f[1],m=f[2],g=f[3],h=f[5],n=f[6];if(n)c+=""+n;else{n="";switch(g){case "a":case "m":e=
0;h&&(e=parseInt(h,10),isNaN(e)&&(k("PatternLayout.format: invalid specifier '"+h+"' for conversion character '"+g+"' - should be a number"),e=0));for(var h="a"===g?a.messages[0]:a.messages,g=0,r=h.length;g<r;g++)0<g&&" "!==n.charAt(n.length-1)&&(n+=" "),n=0===e?n+h[g]:n+ga(h[g],e);break;case "c":n=a.logger.name;h&&(h=parseInt(h,10),e=a.logger.name.split("."),n=h>=e.length?n:e.slice(e.length-h).join("."));break;case "d":n=E.ISO8601_DATEFORMAT;h&&(n=h,"ISO8601"==n?n=E.ISO8601_DATEFORMAT:"ABSOLUTE"==
n?n=E.ABSOLUTETIME_DATEFORMAT:"DATE"==n&&(n=E.DATETIME_DATEFORMAT));n=(new P(n)).format(a.timeStamp);break;case "f":this.hasCustomFields()&&(n=0,h&&(n=parseInt(h,10),isNaN(n)?k("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - should be a number"):0===n?k("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - must be greater than zero"):n>this.customFields.length?k("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - there aren't that many custom fields"):
--n),n=this.customFields[n].value,"function"==typeof n&&(n=n(this,a)));break;case "n":n="\r\n";break;case "p":n=a.level.name;break;case "r":n=""+a.timeStamp.getDifference(Aa);break;case "%":n="%";break;default:n=e}m&&(m=parseInt(m.substr(1),10),h=n.length,m<h&&(n=n.substring(h-m,h)));if(l)if("-"==l.charAt(0))for(m=parseInt(l.substr(1),10);n.length<m;)n+=" ";else for(m=parseInt(l,10);n.length<m;)n=" "+n;c+=n}d=d.substr(f.index+f[0].length)}return c};E.prototype.ignoresThrowable=function(){return!0};
E.prototype.toString=function(){return"PatternLayout"};u.PatternLayout=E;K.prototype=new y;K.prototype.layout=new m;K.prototype.append=function(a){alert(this.getLayout().formatWithException(a))};K.prototype.toString=function(){return"AlertAppender"};u.AlertAppender=K;F.prototype=new u.Appender;F.prototype.layout=new n;F.prototype.threshold=v.DEBUG;F.prototype.append=function(a){var b=this,c=function(c){var f=b.getLayout().formatWithException(a);return"string"==typeof f?c?f:[f]:c?f.join(" "):f},f=
window.console;if(f&&f.log){var d;d=f.debug&&v.DEBUG.isGreaterOrEqual(a.level)?"debug":f.info&&v.INFO.equals(a.level)?"info":f.warn&&v.WARN.equals(a.level)?"warn":f.error&&a.level.isGreaterOrEqual(v.ERROR)?"error":"log";if("function"==typeof f[d].apply)f[d].apply(f,c(!1));else f[d](c(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(c(!0))};F.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)};F.prototype.groupEnd=function(){window.console&&
window.console.groupEnd&&window.console.groupEnd()};F.prototype.toString=function(){return"BrowserConsoleAppender"};u.BrowserConsoleAppender=F;var Da=function(){return new XMLHttpRequest},Ea=[Da,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],za=!1,ra=function(a){for(var b=null,c,f=0,d=Ea.length;f<d;f++){c=Ea[f];try{return b=c(),za=c==Da&&"withCredentials"in b,ra=c,b}catch(D){}}a?a():k("getXmlHttp: unable to obtain XMLHttpRequest object")};
M.prototype=new y;M.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1E3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};M.prototype.layout=new H;M.prototype.toString=function(){return"AjaxAppender"};u.AjaxAppender=M;var A;(function(){function b(a,b,c,f,d){this.create(!1,null,a,b,c,f,d,this.defaults.focusPopUp)}function c(a,b,c,f,d,e){this.create(!0,a,b,c,f,d,e,!1)}var f=[];A=function(){};
var d=1;A.prototype=new y;A.prototype.create=function(b,c,e,l,m,g,n,r){function D(a,b){this.loggingEvent=a;this.levelName=a.level.name;this.formattedMessage=b}function p(a,b){this.name=a;this.initiallyExpanded=b}function q(){}var V=this,pa=!1,J=!1,S=!1,B=!1,la=[],C=!0,ia=d++;l=x(l,this.defaults.initiallyMinimized);e=x(e,this.defaults.lazyInit);m=x(m,this.defaults.useDocumentWrite);var t=this.defaults.newestMessageAtTop,ha=this.defaults.scrollToLatestMessage;g=g?g:this.defaults.width;n=n?n:this.defaults.height;
var ua=this.defaults.maxMessages,ka=this.defaults.showCommandLine,va=this.defaults.commandLineObjectExpansionDepth,H=this.defaults.showHideButton,y=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var F,K,A,z,M,R=b?"InPageAppender":"PopUpAppender",W=function(a){return J?(k(R+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0},N=function(){return S&&C&&!B};this.isNewestMessageAtTop=function(){return t};this.setNewestMessageAtTop=function(a){t=
!!a;N()&&z().setNewestAtTop(t)};this.isScrollToLatestMessage=function(){return ha};this.setScrollToLatestMessage=function(a){ha=!!a;N()&&z().setScrollToLatest(ha)};this.getWidth=function(){return g};this.setWidth=function(a){W("width")&&(g=w(a,g))};this.getHeight=function(){return n};this.setHeight=function(a){W("height")&&(n=w(a,n))};this.getMaxMessages=function(){return ua};this.setMaxMessages=function(a){ua=G(a,ua);N()&&z().setMaxMessages(ua)};this.isShowCommandLine=function(){return ka};this.setShowCommandLine=
function(a){ka=!!a;N()&&z().setShowCommandLine(ka)};this.isShowHideButton=function(){return H};this.setShowHideButton=function(a){H=!!a;N()&&z().setShowHideButton(H)};this.isShowCloseButton=function(){return y};this.setShowCloseButton=function(a){y=!!a;N()&&z().setShowCloseButton(y)};this.getCommandLineObjectExpansionDepth=function(){return va};this.setCommandLineObjectExpansionDepth=function(a){va=G(a,va)};var P=l;this.isInitiallyMinimized=function(){return l};this.setInitiallyMinimized=function(a){W("initiallyMinimized")&&
(P=l=!!a)};this.isUseDocumentWrite=function(){return m};this.setUseDocumentWrite=function(a){W("useDocumentWrite")&&(m=!!a)};D.prototype.append=function(){z().log(this.levelName,this.formattedMessage)};p.prototype.append=function(){z().group(this.name,this.initiallyExpanded)};q.prototype.append=function(){z().groupEnd()};var U=function(){A();pa?B&&xa&&K():F();A()&&aa()};this.append=function(a){if(C){var b=V.getLayout().formatWithException(a);la.push(new D(a,b));U()}};this.group=function(a,b){C&&(la.push(new p(a,
b)),U())};this.groupEnd=function(){C&&(la.push(new q),U())};var aa=function(){for(;0<la.length;)la.shift().append();r&&z().focus()};this.setAddedToLogger=function(a){this.loggers.push(a);Q&&!e&&F()};this.clear=function(){N()&&z().clearLog();la.length=0};this.focus=function(){N()&&z().focus()};this.focusCommandLine=function(){N()&&z().focusCommandLine()};this.focusSearch=function(){N()&&z().focusSearch()};var L=window;this.getCommandWindow=function(){return L};this.setCommandWindow=function(a){L=a};
this.executeLastCommand=function(){N()&&z().evalLastCommand()};var Y=new E("%m");this.getCommandLayout=function(){return Y};this.setCommandLayout=function(a){Y=a};this.evalCommandAndAppend=function(b){var c={appendResult:!0,isError:!1},f="";try{var d,e;!L.eval&&L.execScript&&L.execScript("null");var l={};e=0;for(len=ja.length;e<len;e++)l[ja[e][0]]=ja[e][1];var m=[],g=function(a){m.push([a,L[a]])};g("appender");L.appender=V;g("commandReturnValue");L.commandReturnValue=c;g("commandLineFunctionsHash");
L.commandLineFunctionsHash=l;l=function(a){g(a);L[a]=function(){return this.commandLineFunctionsHash[a](V,arguments,c)}};e=0;for(len=ja.length;e<len;e++)l(ja[e][0]);L===window&&L.execScript?(g("evalExpr"),g("result"),window.evalExpr=b,L.execScript("window.result=eval(window.evalExpr);"),d=window.result):d=L.eval(b);f=a(d)?d:ga(d,va);e=0;for(len=m.length;e<len;e++)L[m[e][0]]=m[e][1]}catch(La){f="Error evaluating command: "+h(La),c.isError=!0}c.appendResult&&(b=">>> "+b,a(f)||(b+="\r\n"+f),f=new qa(null,
new Date,c.isError?v.ERROR:v.INFO,[b],null),b=this.getLayout(),this.setLayout(Y),this.append(f),this.setLayout(b))};var ja=f.concat([]);this.addCommandLineFunction=function(a,b){ja.push([a,b])};this.storeCommandHistory=function(a){a=a.join(",");var b=void 0,b=b?"; path="+b:"";document.cookie=escape("log4javascriptCommandHistory")+"="+escape(a)+""+b};var Z=function(a){var b=['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',
"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\x3c!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work --\x3e",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;\x3c/script>','\x3c!--[if IE]><script type="text/javascript">isIe = true\x3c/script><![endif]--\x3e','\x3c!--[if lt IE 7]><script type="text/javascript">isIePre7 = true\x3c/script><![endif]--\x3e',
'<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}",
"this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",
'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',
"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",
'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}',
'GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",
'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',
"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}",
"this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}",
"this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",
'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}',
'LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}',
'LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',
"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}',
'this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',
"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",
'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}',
'logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',
"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}",
"var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}",
"matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",
'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}",
"var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}",
"return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}",
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}",
"displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}",
"var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",
'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}',
'function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}',
'function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}",
"searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}",
"return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',
"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+",
"preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}",
"logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}",
"var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}",
"setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',
"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}",
"this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}',
'currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}',
'addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}",
"function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}',
'function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}',
'if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',
"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}',
'function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}',
'function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}",
"function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}",
"currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}",
"return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-',
'($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}",
"this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}",
"return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}",
"return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',
"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',
"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}",
"currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]\x3e","\x3c/script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}",
"</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>',
'<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>',
'<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />',
'<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>',
'<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>',
'<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>',
'<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />',
'<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />',
'<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];a.open();for(var c=0,f=b.length;c<f;c++)a.writeln(b[c]);a.close()};this.setEventTypes(["load","unload"]);var fa=function(){var a=z();a.setAppender(V);a.setNewestAtTop(t);a.setScrollToLatest(ha);a.setMaxMessages(ua);a.setShowCommandLine(ka);a.setShowHideButton(H);a.setShowCloseButton(y);a.setMainWindow(window);var b;a:{b=escape("log4javascriptCommandHistory")+
"=";for(var c=document.cookie.split(";"),f=0,d=c.length;f<d;f++){for(var e=c[f];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b)){b=unescape(e.substring(b.length,e.length));break a}}b=null}b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length);V.dispatchEvent("load",{win:a})};this.unload=function(){I.debug("unload "+this+", caller: "+this.unload.caller);B||(I.debug("really doing unload "+this),B=!0,J=S=!1,V.dispatchEvent("unload",{}))};var Ha=function(a,b,
c,f){var d=setInterval(function(){try{B&&clearInterval(d),a(z())&&(clearInterval(d),c())}catch(sa){clearInterval(d),C=!1,k(f,sa)}},b)},da=function(){var a=document.domain!=location.hostname;if(m)a="";else{var b;a:{b=document.getElementsByTagName("script");for(var c=0,f=b.length;c<f;++c)if(-1!=b[c].src.indexOf("log4javascript")){f=b[c].src.lastIndexOf("/");b=-1==f?"":b[c].src.substr(0,f+1);break a}b=null}a=b+"console.html"+(a?"?log4javascript_domain="+escape(document.domain):"")}return a};if(b){var X=
null,ta=[];this.addCssProperty=function(a,b){W("cssProperties")&&ta.push([a,b])};var ea=!1,T,oa=Ba+"_InPageAppender_"+ia;this.hide=function(){pa&&J&&(N()&&z().$("command").blur(),T.style.display="none",P=!0)};this.show=function(){pa&&(J?(T.style.display="block",this.setShowCommandLine(ka),P=!1):ea||K(!0))};this.isVisible=function(){return!P&&!B};this.close=function(a){B||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||
(T.parentNode.removeChild(T),this.unload())};M=function(){function a(){try{l||V.show(),fa(),S=!0,aa()}catch(Ka){C=!1,k("InPageAppender.open: unable to create console iframe",Ka)}}function b(){try{var b=function(a){return ba(a)};m&&Z(z().document);ba(z())?a():Ha(b,100,a,"InPageAppender.open: unable to create console iframe")}catch(sa){C=!1,k("InPageAppender.open: unable to create console iframe",sa)}}P=!1;T=X.appendChild(document.createElement("div"));T.style.width=g;T.style.height=n;T.style.border=
"solid gray 1px";for(var c=0,f=ta.length;c<f;c++)T.style[ta[c][0]]=ta[c][1];c=m?"":" src='"+da()+"'";T.innerHTML="<iframe id='"+oa+"' name='"+oa+"' width='100%' height='100%' frameborder='0'"+c+" scrolling='no'></iframe>";B=!1;c=function(a){try{return!!a&&!!a.document}catch(sa){return!1}};c(z())?b():Ha(c,100,b,"InPageAppender.open: unable to create console iframe");J=!0};K=function(a){if(a||!l)a=function(){if(c)try{var a=document.getElementById(c);1==a.nodeType&&(X=a);M()}catch(Ja){k("InPageAppender.init: invalid container element '"+
c+"' supplied",Ja)}else X=document.createElement("div"),X.style.position="fixed",X.style.left="0",X.style.right="0",X.style.bottom="0",document.body.appendChild(X),V.addCssProperty("borderWidth","1px 0 0 0"),V.addCssProperty("zIndex",1E6),M()},wa&&c&&c.appendChild?(X=c,M()):wa?a():u.addEventListener("load",a),ea=!0};F=function(){K();pa=!0};z=function(){var a=window.frames[oa];if(a)return a};A=function(){return C&&!B?(J&&!S&&z()&&ba(z())&&(S=!0),S):!1}}else{var ma=V.defaults.useOldPopUp,ya=V.defaults.complainAboutPopUpBlocking,
xa=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return ma};this.setUseOldPopUp=function(a){W("useOldPopUp")&&(ma=!!a)};this.isComplainAboutPopUpBlocking=function(){return ya};this.setComplainAboutPopUpBlocking=function(a){W("complainAboutPopUpBlocking")&&(ya=!!a)};this.isFocusPopUp=function(){return r};this.setFocusPopUp=function(a){r=!!a};this.isReopenWhenClosed=function(){return xa};this.setReopenWhenClosed=function(a){xa=!!a};this.close=function(){I.debug("close "+this);try{O.close(),
this.unload()}catch(Ma){}};this.hide=function(){I.debug("hide "+this);N()&&this.close()};this.show=function(){I.debug("show "+this);J||M()};this.isVisible=function(){return A()};var O;M=function(){function a(){z().setCloseIfOpenerCloses(!ma||!m);fa();S=!0;aa();Ha(d,500,e,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+g+",height="+n+",status,resizable",c="";try{var f=window.frameElement;f&&(c="_"+f.tagName+"_"+(f.name||f.id||""))}catch(Fa){c="_inaccessibleParentFrame"}c=
"PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+ia+c;ma&&m||(c=c+"_"+Ba);var d=function(a){if(B)return!0;try{return!!a&&a.closed}catch(Na){}return!1},e=function(){B||V.unload()};try{O=window.open(da(),c,b),B=!1,J=!0,O&&O.document?m&&ma&&ba(O)?(O.mainPageReloaded(),a()):(m&&Z(O.document),b=function(a){return!!a&&ba(a)},ba(O)?a():Ha(b,100,a,"PopUpAppender.init: unable to create console window")):(C=!1,I.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),ya&&k("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging."))}catch(Fa){k("PopUpAppender.init: error creating pop-up",
Fa)}};K=function(){l||M()};F=function(){K();pa=!0};z=function(){return O};A=function(){if(C&&!a(O)&&!B){if(O.closed||S&&a(O.closed))return V.unload(),I.debug("PopUpAppender: pop-up closed"),!1;!S&&ba(O)&&(S=!0)}return C&&S&&!B}}this.getConsoleWindow=z};A.addGlobalCommandLineFunction=function(a,b){f.push([a,b])};b.prototype=new A;b.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,
scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0};b.prototype.toString=function(){return"PopUpAppender"};u.PopUpAppender=b;c.prototype=new A;c.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,
showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0};c.prototype.toString=function(){return"InPageAppender"};u.InPageAppender=c;u.InlineAppender=c})();(function(){function a(d,e,l,m,h){function n(a){a=a.style.cssText.split(";");for(var b="",c=0,f=a.length;c<f;c++){var b=a[c].split(":"),d=[];/^\s*$/.test(b[0])||d.push(g(b[0]).toLowerCase()+":"+g(b[1]));b=d.join(";")}return b}"string"!=typeof l&&(l="");m=!!m;h=!!h;var r;if("undefined"!=typeof e&&!e||d.nodeType==b.DOCUMENT_FRAGMENT_NODE){e=
"";h=0;for(r=d.childNodes.length;h<r;h++)e+=a(d.childNodes[h],!0,l+"  ");return e}switch(d.nodeType){case b.ELEMENT_NODE:var k=d.tagName.toLowerCase();e=(m?"\r\n"+l:"")+"<";h=d.prefix?d.prefix:d.outerHTML&&(new RegExp("<([^:]+):"+d.tagName+"[^>]*>","i")).test(d.outerHTML)?RegExp.$1.toLowerCase():"";(m=!!h)&&(e+=h+":");e+=k;h=0;for(r=d.attributes.length;h<r;h++){var D=d.attributes[h];D.specified&&null!==D.nodeValue&&"style"!==D.nodeName.toLowerCase()&&"string"===typeof D.nodeValue&&0!==D.nodeName.indexOf("_moz")&&
(e+=" "+D.nodeName.toLowerCase()+'="',e+=D.nodeValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),e+='"')}d.style.cssText&&""!==n(d)&&(e+=' style="'+n(d)+'"');if(t(f,k)||m&&!d.hasChildNodes())e+="/>";else{e+=">";m=!(1===d.childNodes.length&&d.childNodes[0].nodeType===b.TEXT_NODE);D=t(c,k);h=0;for(r=d.childNodes.length;h<r;h++)e+=a(d.childNodes[h],!0,l+"  ",m,D);d="</"+k+">";e+=m?"\r\n"+l+d:d}return e;case b.TEXT_NODE:if(d.nodeType==b.TEXT_NODE&&/^[ \t\r\n]*$/.test(d.nodeValue))e=
"";else{if(h)e=d.nodeValue;else{d=p(g(d.nodeValue));e=[];h=0;for(r=d.length;h<r;h++)e[h]=g(d[h]);e=e.join("\r\n"+l)}m&&(e="\r\n"+l+e)}return e;case b.CDATA_SECTION_NODE:return"<![CDATA["+d.nodeValue+"]]\x3e\r\n";case b.DOCUMENT_NODE:e="";h=0;for(r=d.childNodes.length;h<r;h++)e+=a(d.childNodes[h],!0,l);return e;default:return""}}var b={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,
DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},c=["script","pre"],f="br img hr param link area input col base meta".split(" ");(function(){A.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])});A.addGlobalCommandLineFunction("dir",function(a,b,c){a=[];c=0;for(var f=b.length;c<f;c++){var l=c,m;m=void 0;var g=b[c],h=0;for(m in g)h=Math.max(d(m).length,h);var n=[];for(m in g){var r="  "+W(d(m),h+2),k;try{k=p(d(g[m])).join(W("\r\n",h+6))}catch(ca){k=
"[Error obtaining property. Details: "+e(ca)+"]"}n.push(r+k)}m=n.join("\r\n");a[l]=m}return a.join("\r\n\r\n")});A.addGlobalCommandLineFunction("dirxml",function(b,c,f){b=[];f=0;for(var d=c.length;f<d;f++)b[f]=a(c[f]);return b.join("\r\n\r\n")});A.addGlobalCommandLineFunction("cd",function(a,b,c){var f;0===b.length||""===b[0]?(f=window,b="Command line set to run in main window"):b[0].window==b[0]?(f=b[0],b="Command line set to run in frame '"+b[0].name+"'"):(f=window.frames[b[0]])?b="Command line set to run in frame '"+
b[0]+"'":(c.isError=!0,b="Frame '"+b[0]+"' does not exist",f=a.getCommandWindow());a.setCommandWindow(f);return b});A.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1;a.clear()});A.addGlobalCommandLineFunction("keys",function(a,b,c){a=[];for(var f in b[0])a.push(f);return a});A.addGlobalCommandLineFunction("values",function(a,b,c){a=[];for(var f in b[0])try{a.push(b[0][f])}catch(ia){I.warn("values(): Unable to obtain value for key "+f+". Details: "+e(ia))}return a});A.addGlobalCommandLineFunction("expansionDepth",
function(a,b,c){var f=parseInt(b[0],10);if(isNaN(f)||0>f)return c.isError=!0,""+b[0]+" is not a valid expansion depth";a.setCommandLineObjectExpansionDepth(f);return"Object expansion depth set to "+f})})()})();u.setDocumentReady=function(){wa=!0;u.dispatchEvent("load",{})};if(window.addEventListener)window.addEventListener("load",u.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",u.setDocumentReady);else{var Ga=window.onload;window.onload="function"!=typeof window.onload?
u.setDocumentReady:function(a){Ga&&Ga(a);u.setDocumentReady()}}return u},this);
!function(){var a={},c=null,b=!0,d=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!=typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"==typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){if(a=parseFloat(a),0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var f=0;f<this._howls[c]._audioNode.length;f++)this._howls[c]._audioNode[f].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var f=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=f;d.connect(c.destination);"undefined"==typeof d.start?
d.noteOn(0):d.start(0);setTimeout(function(){d.playbackState!==d.PLAYING_STATE&&d.playbackState!==d.FINISHED_STATE||(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1))},0)};return window.addEventListener("touchend",b,!1),a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!=typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};if(t.prototype={load:function(){var a=this,b=null;if(d)return void a.on("loaderror",Error("No audio support."));for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else{if(g=a._urls[c],e=/^data:audio\/([^;,]+);/i.exec(g),e||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),!e)return void a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
e=e[1].toLowerCase()}if(p[e]){b=a._urls[c];break}}if(!b)return void a.on("loaderror",Error("No codec support for selected audio sources."));if(a._src=b,a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a},urls:function(a){return a?(this.stop(),this._urls="string"==typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var f=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),f._loaded?f._sprite[a]?(f._inactiveNode(function(d){d._sprite=a;var e=
0<d._pos?d._pos:f._sprite[a][0]/1E3,l=0;f._webAudio?(l=f._sprite[a][1]/1E3-d._pos,0<d._pos&&(e=f._sprite[a][0]/1E3+e)):l=f._sprite[a][1]/1E3-(e-f._sprite[a][0]/1E3);var m,g=!(!f._loop&&!f._sprite[a][2]),h="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){m=setTimeout(function(){!f._webAudio&&g&&f.stop(h).play(a,h);f._webAudio&&!g&&(f._nodeById(h).paused=!0,f._nodeById(h)._pos=0,f._clearEndTimer(h));f._webAudio||g||f.stop(h);f.on("end",h)},l/f._rate*1E3);f._onendTimer.push({timer:m,
id:h})}(),f._webAudio){var n=f._sprite[a][0]/1E3,p=f._sprite[a][1]/1E3;d.id=h;d.paused=!1;k(f,[g,n,p],h);f._playStart=c.currentTime;d.gain.value=f._volume;"undefined"==typeof d.bufferSource.start?g?d.bufferSource.noteGrainOn(0,e,86400):d.bufferSource.noteGrainOn(0,e,l):g?d.bufferSource.start(0,e,86400):d.bufferSource.start(0,e,l)}else{if(4!==d.readyState&&(d.readyState||!navigator.isCocoonJS))return f._clearEndTimer(h),function(){var c=a,e=b,l=function(){f.play(c,e);d.removeEventListener("canplaythrough",
l,!1)};d.addEventListener("canplaythrough",l,!1)}(),f;d.readyState=4;d.id=h;d.currentTime=e;d.muted=q._muted||d.muted;d.volume=f._volume*q.volume();setTimeout(function(){d.play()},0)}return f.on("play"),"function"==typeof b&&b(h),f}),f):("function"==typeof b&&b(),f):(f.on("load",function(){f.play(a,b)}),f)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||
c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),
c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),0<=a&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var f=b?c._nodeById(b):c._activeNode();return f&&(c._webAudio?f.gain.value=a:f.volume=a*q.volume()),c}return c._volume},loop:function(a){return"boolean"==typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"==typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var f=this;if(!f._loaded)return f.on("load",function(){f.pos(a)}),"number"==typeof a?f:f._pos||0;a=parseFloat(a);var d=b?f._nodeById(b):f._activeNode();if(d)return 0<=a?(f.pause(b),
d._pos=a,f.play(d._sprite,b),f):f._webAudio?d._pos+(c.currentTime-f._playStart):d.currentTime;if(0<=a)return f;for(d=0;d<f._audioNode.length;d++)if(f._audioNode[d].paused&&4===f._audioNode[d].readyState)return f._webAudio?f._audioNode[d]._pos:f._audioNode[d].currentTime},pos3d:function(a,b,c,d){var f=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!f._loaded)return f.on("play",function(){f.pos3d(a,b,c,d)}),f;if(!(0<=a||0>a))return f._pos3d;if(f._webAudio){var e=d?f._nodeById(d):
f._activeNode();e&&(f._pos3d=[a,b,c],e.panner.setPosition(a,b,c),e.panner.panningModel=f._model||"HRTF")}return f},fade:function(a,b,c,d,e){var f=this,l=a>b?"down":"up",m=Math.abs(a-b)/.01,g=c/m;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var h=1;m>=h;h++)!function(){var a=Math.round(1E3*(f._volume+("up"===l?.01:-.01)*h))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},g*h)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,
b,c,d){var f=this;return f.fade(f._volume,a,b,function(){c&&c();f.pause(d);f.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}return this._drainPool(),a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}if(this._drainPool(),!b){var f;if(this._webAudio)f=this._setupAudioNode(),a(f);else{this.load();f=this._audioNode[this._audioNode.length-1];var d=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",e=function(){f.removeEventListener(d,e,!1);a(f)};f.addEventListener(d,e,!1)}}},_drainPool:function(){var a,b=0;for(a=0;a<this._audioNode.length;a++)this._audioNode[a].paused&&b++;for(a=this._audioNode.length-1;0<=a&&!(5>=b);a--)this._audioNode[a].paused&&
(this._webAudio&&this._audioNode[a].disconnect(0),b--,this._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}(a=this._onendTimer[b])&&(clearTimeout(a.timer),this._onendTimer.splice(b,1))},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;return a[b]="undefined"==typeof c.createGain?c.createGainNode():c.createGain(),a[b].gain.value=this._volume,a[b].paused=!0,a[b]._pos=0,a[b].readyState=
4,a[b].connect(e),a[b].panner=c.createPanner(),a[b].panner.panningModel=this._model||"equalpower",a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]),a[b].panner.connect(a[b]),a[b]},on:function(a,b){var c=this["_on"+a];if("function"==typeof b)c.push(b);else for(var d=0;d<c.length;d++)b?c[d].call(this,b):c[d].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var d=0;d<c.length;d++){if(b===c[d]){c.splice(d,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}},b)var x=function(b,c){if(c in a)return b._duration=a[c].duration,void G(b);if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),f=new Uint8Array(d.length),e=0;e<d.length;++e)f[e]=
d.charCodeAt(e);w(f.buffer,b,c)}else{var l=new XMLHttpRequest;l.open("GET",c,!0);l.responseType="arraybuffer";l.onload=function(){w(l.response,b,c)};l.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{l.send()}catch(H){l.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!=typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!=typeof window&&(window.Howler=q,window.Howl=t)}();jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,c,b,d,e){return jQuery.easing[jQuery.easing.def](a,c,b,d,e)},easeInQuad:function(a,c,b,d,e){return d*(c/=e)*c+b},easeOutQuad:function(a,c,b,d,e){return-d*(c/=e)*(c-2)+b},easeInOutQuad:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c+b:-d/2*(--c*(c-2)-1)+b},easeInCubic:function(a,c,b,d,e){return d*(c/=e)*c*c+b},easeOutCubic:function(a,c,b,d,e){return d*((c=c/e-1)*c*c+1)+b},easeInOutCubic:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c+b:
d/2*((c-=2)*c*c+2)+b},easeInQuart:function(a,c,b,d,e){return d*(c/=e)*c*c*c+b},easeOutQuart:function(a,c,b,d,e){return-d*((c=c/e-1)*c*c*c-1)+b},easeInOutQuart:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c+b:-d/2*((c-=2)*c*c*c-2)+b},easeInQuint:function(a,c,b,d,e){return d*(c/=e)*c*c*c*c+b},easeOutQuint:function(a,c,b,d,e){return d*((c=c/e-1)*c*c*c*c+1)+b},easeInOutQuint:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c*c+b:d/2*((c-=2)*c*c*c*c+2)+b},easeInSine:function(a,c,b,d,e){return-d*Math.cos(c/
e*(Math.PI/2))+d+b},easeOutSine:function(a,c,b,d,e){return d*Math.sin(c/e*(Math.PI/2))+b},easeInOutSine:function(a,c,b,d,e){return-d/2*(Math.cos(Math.PI*c/e)-1)+b},easeInExpo:function(a,c,b,d,e){return 0==c?b:d*Math.pow(2,10*(c/e-1))+b},easeOutExpo:function(a,c,b,d,e){return c==e?b+d:d*(-Math.pow(2,-10*c/e)+1)+b},easeInOutExpo:function(a,c,b,d,e){return 0==c?b:c==e?b+d:1>(c/=e/2)?d/2*Math.pow(2,10*(c-1))+b:d/2*(-Math.pow(2,-10*--c)+2)+b},easeInCirc:function(a,c,b,d,e){return-d*(Math.sqrt(1-(c/=e)*
c)-1)+b},easeOutCirc:function(a,c,b,d,e){return d*Math.sqrt(1-(c=c/e-1)*c)+b},easeInOutCirc:function(a,c,b,d,e){return 1>(c/=e/2)?-d/2*(Math.sqrt(1-c*c)-1)+b:d/2*(Math.sqrt(1-(c-=2)*c)+1)+b},easeInElastic:function(a,c,b,d,e){a=0;var h=d;if(0==c)return b;if(1==(c/=e))return b+d;a||(a=.3*e);h<Math.abs(d)?(h=d,d=a/4):d=a/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*--c)*Math.sin(2*(c*e-d)*Math.PI/a))+b},easeOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(1==(c/=e))return b+d;h||
(h=.3*e);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*c)*Math.sin(2*(c*e-a)*Math.PI/h)+d+b},easeInOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(2==(c/=e/2))return b+d;h||(h=.3*e*1.5);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return 1>c?-.5*g*Math.pow(2,10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)+b:g*Math.pow(2,-10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)*.5+d+b},easeInBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*(c/=e)*c*((h+1)*
c-h)+b},easeOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*((c=c/e-1)*c*((h+1)*c+h)+1)+b},easeInOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return 1>(c/=e/2)?d/2*c*c*(((h*=1.525)+1)*c-h)+b:d/2*((c-=2)*c*(((h*=1.525)+1)*c+h)+2)+b},easeInBounce:function(a,c,b,d,e){return d-jQuery.easing.easeOutBounce(a,e-c,0,d,e)+b},easeOutBounce:function(a,c,b,d,e){return(c/=e)<1/2.75?7.5625*d*c*c+b:c<2/2.75?d*(7.5625*(c-=1.5/2.75)*c+.75)+b:c<2.5/2.75?d*(7.5625*(c-=2.25/2.75)*c+.9375)+b:d*(7.5625*
(c-=2.625/2.75)*c+.984375)+b},easeInOutBounce:function(a,c,b,d,e){return c<e/2?.5*jQuery.easing.easeInBounce(a,2*c,0,d,e)+b:.5*jQuery.easing.easeOutBounce(a,2*c-e,0,d,e)+.5*d+b}});
(function(a){a.jqPagination=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$input=d.$el.find("input");d.$el.data("jqPagination",d);d.init=function(){d.options=a.extend({},a.jqPagination.defaultOptions,b);null===d.options.max_page&&(void 0!==d.$input.data("max-page")?d.options.max_page=d.$input.data("max-page"):d.options.max_page=1);void 0!==d.$input.data("current-page")&&d.isNumber(d.$input.data("current-page"))&&(d.options.current_page=d.$input.data("current-page"));d.$input.removeAttr("readonly");
d.updateInput(!0);d.$input.on("focus.jqPagination mouseup.jqPagination",function(b){if("focus"===b.type){var c=parseInt(d.options.current_page,10);a(this).val(c).select()}if("mouseup"===b.type)return!1});d.$input.on("blur.jqPagination keydown.jqPagination",function(b){var c=a(this),e=parseInt(d.options.current_page,10);27===b.keyCode&&(c.val(e),c.blur());13===b.keyCode&&c.blur();"blur"===b.type&&d.setPage(c.val())});d.$el.on("click.jqPagination","a",function(b){var c=a(this);if(c.hasClass("disabled"))return!1;
b.metaKey||b.ctrlKey||(b.preventDefault(),d.setPage(c.data("action")))})};d.setPage=function(a,b){if(void 0===a)return d.options.current_page;var c=parseInt(d.options.current_page,10),e=parseInt(d.options.max_page,10);if(isNaN(parseInt(a,10)))switch(a){case "first":a=1;break;case "prev":case "previous":a=c-1;break;case "next":a=c+1;break;case "last":a=e}a=parseInt(a,10);if(isNaN(a)||1>a||a>e)return d.setInputValue(c),!1;d.options.current_page=a;d.$input.data("current-page",a);d.updateInput(b)};d.setMaxPage=
function(a,b){if(void 0===a)return d.options.max_page;if(!d.isNumber(a))return console.error("jqPagination: max_page is not a number"),!1;if(a<d.options.current_page)return console.error("jqPagination: max_page lower than current_page"),!1;d.options.max_page=a;d.$input.data("max-page",a);d.updateInput(b)};d.updateInput=function(a){var b=parseInt(d.options.current_page,10);d.setInputValue(b);d.setLinks(b);!0!==a&&d.options.paged(b)};d.setInputValue=function(a){var b=d.options.page_string,c=d.options.max_page,
b=b.replace("{current_page}",a).replace("{max_page}",c);d.$input.val(b)};d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.setLinks=function(a){a=d.options.link_string;var b=parseInt(d.options.current_page,10),c=parseInt(d.options.max_page,10);if(""!==a){var e=b-1;1>e&&(e=1);var q=b+1;q>c&&(q=c);d.$el.find("a.first").attr("href",a.replace("{page_number}","1"));d.$el.find("a.prev, a.previous").attr("href",a.replace("{page_number}",e));d.$el.find("a.next").attr("href",a.replace("{page_number}",
q));d.$el.find("a.last").attr("href",a.replace("{page_number}",c))}d.$el.find("a").removeClass("disabled");b===c&&d.$el.find(".next, .last").addClass("disabled");1===b&&d.$el.find(".previous, .first").addClass("disabled")};d.callMethod=function(b,c,g){switch(b.toLowerCase()){case "option":if(void 0===g&&"object"!==typeof c)return d.options[c];b={trigger:!0};var e=!1;a.isPlainObject(c)&&!g?a.extend(b,c):b[c]=g;g=!1===b.trigger;void 0!==b.current_page&&(e=d.setPage(b.current_page,g));void 0!==b.max_page&&
(e=d.setMaxPage(b.max_page,g));!1===e&&console.error("jqPagination: cannot get / set option "+c);return e;case "destroy":d.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+b+'" does not exist'),!1}};d.init()};a.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}};a.fn.jqPagination=function(){var c=a(this),b=Array.prototype.slice.call(arguments),
d=!1;if("string"===typeof b[0])return void 0===b[2]?d=c.first().data("jqPagination").callMethod(b[0],b[1]):c.each(function(){d=a(this).data("jqPagination").callMethod(b[0],b[1],b[2])}),d;this.each(function(){new a.jqPagination(this,b[0])})}})(jQuery);console||(console={},func=function(){return!1},console.log=func,console.info=func,console.warn=func,console.error=func);CryptoJS=CryptoJS||function(a,c){var b={},d=b.lib={},e=function(){},h=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
g=d.WordArray=h.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=c?b:4*a.length},toString:function(a){return(a||q).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-
c%4*8;b.length=a.ceil(c/4)},clone:function(){var a=h.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),p=b.enc={},q=p.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new g.init(c,b/2)}},t=p.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new g.init(c,b)}},x=p.Utf8={stringify:function(a){try{return decodeURIComponent(escape(t.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return t.parse(unescape(encodeURIComponent(a)))}},
w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,h=this.blockSize,k=e/(4*h),k=b?a.ceil(k):a.max((k|0)-this._minBufferSize,0);b=k*h;e=a.min(4*b,e);if(b){for(var p=0;p<b;p+=h)this._doProcessBlock(d,p);p=d.splice(0,b);c.sigBytes-=e}return new g.init(p,e)},clone:function(){var a=h.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new G.HMAC.init(a,
c)).finalize(b)}}});var G=b.algo={};return b}(Math);
(function(){var a=CryptoJS,c=a.lib,b=c.WordArray,d=c.Hasher,e=[],c=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],g=c[1],h=c[2],w=c[3],G=c[4],k=0;80>k;k++){if(16>k)e[k]=a[b+k]|0;else{var f=e[k-3]^e[k-8]^e[k-14]^e[k-16];e[k]=f<<1|f>>>31}f=(d<<5|d>>>27)+G+e[k];f=20>k?f+((g&h|~g&w)+1518500249):40>k?f+((g^h^w)+1859775393):60>k?f+((g&h|g&w|h&w)-1894007588):f+((g^h^
w)-899497514);G=w;w=h;h=g<<30|g>>>2;g=d;d=f}c[0]=c[0]+d|0;c[1]=c[1]+g|0;c[2]=c[2]+h|0;c[3]=c[3]+w|0;c[4]=c[4]+G|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(c);a.HmacSHA1=d._createHmacHelper(c)})();
(function(){var a=CryptoJS,c=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,d){a=this._hasher=new a.init;"string"==typeof d&&(d=c.parse(d));var b=a.blockSize,h=4*b;d.sigBytes>h&&(d=a.finalize(d));d.clamp();for(var g=this._oKey=d.clone(),p=this._iKey=d.clone(),q=g.words,t=p.words,x=0;x<b;x++)q[x]^=1549556828,t[x]^=909522486;g.sigBytes=p.sigBytes=h;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=
this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();
(function(a){for(var c,b,d=document.getElementsByTagName("head")[0].style,e=["transformProperty","WebkitTransform","OTransform","msTransform","MozTransform"],h=0;h<e.length;h++)void 0!==d[e[h]]&&(c=e[h]);c&&(b=c.replace(/[tT]ransform/,"TransformOrigin"),"T"==b[0]&&(b[0]="t"));eval('IE = "v"=="\v"');jQuery.fn.extend({rotate:function(b){if(0!==this.length&&"undefined"!=typeof b){"number"==typeof b&&(b={angle:b});for(var c=[],d=0,e=this.length;d<e;d++){var g=this.get(d);if(g.Wilq32&&g.Wilq32.PhotoEffect)g.Wilq32.PhotoEffect._handleRotation(b);
else{var h=a.extend(!0,{},b),g=(new Wilq32.PhotoEffect(g,h))._rootObj;c.push(a(g))}}return c}},getRotateAngle:function(){for(var a=[],b=0,c=this.length;b<c;b++){var d=this.get(b);d.Wilq32&&d.Wilq32.PhotoEffect&&(a[b]=d.Wilq32.PhotoEffect._angle)}return a},stopRotate:function(){for(var a=0,b=this.length;a<b;a++){var c=this.get(a);c.Wilq32&&c.Wilq32.PhotoEffect&&clearTimeout(c.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return c?function(a,b){a.Wilq32={PhotoEffect:this};
this._img=this._rootObj=this._eventObj=a;this._handleRotation(b)}:function(a,b){this._img=a;this._onLoadDelegate=[b];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};a.parentNode.insertBefore(this._rootObj,a);if(a.complete)this._Loader();else{var c=this;jQuery(this._img).bind("load",function(){c._Loader()})}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(a){this._parameters=this._parameters||{};"number"!==
typeof this._angle&&(this._angle=0);"number"===typeof a.angle&&(this._angle=a.angle);this._parameters.animateTo="number"===typeof a.animateTo?a.animateTo:this._angle;this._parameters.step=a.step||this._parameters.step||null;this._parameters.easing=a.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration="duration"in a?a.duration:a.duration||this._parameters.duration||1E3;this._parameters.callback=a.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=
a.center||this._parameters.center||["50%","50%"];this._rotationCenterX="string"==typeof this._parameters.center[0]?parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._parameters.center[0];this._rotationCenterY="string"==typeof this._parameters.center[1]?parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._parameters.center[1];a.bind&&a.bind!=this._parameters.bind&&this._BindEvents(a.bind)},_emptyFunction:function(){},_defaultEasing:function(a,
b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},_handleRotation:function(a,b){c||this._img.complete||b?(this._setupParameters(a),this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()):this._onLoadDelegate.push(a)},_BindEvents:function(a){if(a&&this._eventObj){if(this._parameters.bind){var b=this._parameters.bind,c;for(c in b)b.hasOwnProperty(c)&&jQuery(this._eventObj).unbind(c,b[c])}this._parameters.bind=a;for(c in a)a.hasOwnProperty(c)&&jQuery(this._eventObj).bind(c,a[c])}},
_Loader:function(){return IE?function(){var a=this._img.width,b=this._img.height;this._imgWidth=a;this._imgHeight=b;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=b+"px";this._vimage.style.width=a+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=a;this._container.style.height=
b;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",a-1+","+(b-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=a+"px";this._rootObj.style.height=b+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;for(this._eventObj=this._rootObj;a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var a=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*a;this._height=3*a;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement("canvas");
this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;for(this._cnv=this._canvas.getContext("2d");a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var a=+new Date,b=a-this._animateStartTime>this._parameters.duration;if(b&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img)a=this._parameters.easing(0,a-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration),
this._rotate(~~(10*a)/10);this._parameters.step&&this._parameters.step(this._angle);var c=this;this._timer=setTimeout(function(){c._animate.call(c)},10)}this._parameters.callback&&b&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var a=Math.PI/180;return IE?function(a){this._angle=a;this._container.style.rotation=a%360+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=
-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:c?function(a){this._angle=a;this._img.style[c]="rotate("+a%360+"deg)";this._img.style[b]=this._parameters.center.join(" ")}:function(b){this._angle=b;b=b%360*a;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,
this._rotationCenterY);this._cnv.rotate(b);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(g){return function(a){return document.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())})(jQuery);
(function(a){a.fn.flexVerticalCenter=function(c){var b=a.extend({cssAttribute:"margin-top",verticalOffset:0,parentSelector:null,debounceTimeout:25,deferTilWindowLoad:!1},c||{});return this.each(function(){var c=a(this),e,h=function(){var a=b.parentSelector&&c.parents(b.parentSelector).length?c.parents(b.parentSelector).first().height():c.parent().height();c.css(b.cssAttribute,(a-c.height())/2+parseInt(b.verticalOffset));void 0!==b.complete&&b.complete()};a(window).resize(function(){clearTimeout(e);
e=setTimeout(h,b.debounceTimeout)});b.deferTilWindowLoad||h();a(window).load(function(){h()})})}})(jQuery);
(function(a){var c;try{c="string"==typeof a("body").css("background-position-x")}catch(b){c=!1}a._spritely={instances:{},animate:function(b){var c=a(b.el),e=c.attr("id");if(!a._spritely.instances[e])return this;b=a.extend(b,a._spritely.instances[e]||{});if("sprite"==b.type&&b.fps){b.play_frames&&!a._spritely.instances[e].remaining_frames?a._spritely.instances[e].remaining_frames=b.play_frames+1:b.do_once&&!a._spritely.instances[e].remaining_frames&&(a._spritely.instances[e].remaining_frames=b.no_of_frames);
var h,g=function(c){var d=b.width;if(!h){h=[];for(var g=total=0;g<b.no_of_frames;g++)h[h.length]=0-total,total+=d}if(0==a._spritely.instances[e].current_frame){if(b.on_first_frame)b.on_first_frame(c)}else if(a._spritely.instances[e].current_frame==h.length-1&&b.on_last_frame)b.on_last_frame(c);if(b.on_frame&&b.on_frame[a._spritely.instances[e].current_frame])b.on_frame[a._spritely.instances[e].current_frame](c);a._spritely.instances[e].current_frame=1==b.rewind?0>=a._spritely.instances[e].current_frame?
h.length-1:a._spritely.instances[e].current_frame-1:a._spritely.instances[e].current_frame>=h.length-1?0:a._spritely.instances[e].current_frame+1;d=a._spritely.getBgY(c);c.css("background-position",h[a._spritely.instances[e].current_frame]+"px "+d);if(b.bounce&&0<b.bounce[0]&&0<b.bounce[1]){var d=b.bounce[0],g=b.bounce[1],p=b.bounce[2];c.animate({top:"+="+d+"px",left:"-="+g+"px"},p).animate({top:"-="+d+"px",left:"+="+g+"px"},p)}};if(a._spritely.instances[e].remaining_frames&&0<a._spritely.instances[e].remaining_frames){a._spritely.instances[e].remaining_frames--;
if(0==a._spritely.instances[e].remaining_frames)return a._spritely.instances[e].remaining_frames=-1,delete a._spritely.instances[e].remaining_frames,this;g(c)}else-1!=a._spritely.instances[e].remaining_frames&&g(c)}else if("pan"==b.type&&!a._spritely.instances[e]._stopped){var g=b.speed||1,p=a._spritely.instances[e].l||parseInt(a._spritely.getBgX(c).replace("px",""),10)||0,q=a._spritely.instances[e].t||parseInt(a._spritely.getBgY(c).replace("px",""),10)||0;if(b.do_once&&!a._spritely.instances[e].remaining_frames||
0>=a._spritely.instances[e].remaining_frames){switch(b.dir){case "up":case "down":a._spritely.instances[e].remaining_frames=Math.floor((b.img_height||0)/g);break;case "left":case "right":a._spritely.instances[e].remaining_frames=Math.floor((b.img_width||0)/g)}a._spritely.instances[e].remaining_frames++}else b.do_once&&a._spritely.instances[e].remaining_frames--;switch(b.dir){case "up":g*=-1;case "down":a._spritely.instances[e].l||(a._spritely.instances[e].l=p);a._spritely.instances[e].t=q+g;b.img_height&&
(a._spritely.instances[e].t%=b.img_height);break;case "left":g*=-1;case "right":a._spritely.instances[e].t||(a._spritely.instances[e].t=q),a._spritely.instances[e].l=p+g,b.img_width&&(a._spritely.instances[e].l%=b.img_width)}g=a._spritely.instances[e].l.toString();g=-1==g.indexOf("%")?g+"px ":g+" ";p=a._spritely.instances[e].t.toString();p=-1==p.indexOf("%")?p+"px ":p+" ";a(c).css("background-position",g+p);if(b.do_once&&!a._spritely.instances[e].remaining_frames)return this}a._spritely.instances[e].options=
b;a._spritely.instances[e].timeout=window.setTimeout(function(){a._spritely.animate(b)},parseInt(1E3/b.fps))},randomIntBetween:function(a,c){return parseInt(rand_no=Math.floor((c-(a-1))*Math.random())+a)},getBgUseXY:c,getBgY:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-y")||"0":(a(b).css("background-position")||" ").split(" ")[1]},getBgX:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-x")||"0":(a(b).css("background-position")||" ").split(" ")[0]},
get_rel_pos:function(a,c){var b=a;if(0>a)for(;0>b;)b+=c;else for(;b>c;)b-=c;return b},_spStrip:function(a,c){for(;a.length;){var b,d,g=!1,p=!1;for(b=0;b<c.length;b++){var q=a.slice(0,1);d=a.slice(1);-1<c.indexOf(q)?a=d:g=!0}for(b=0;b<c.length;b++)q=a.slice(-1),d=a.slice(0,-1),-1<c.indexOf(q)?a=d:p=!0;if(g&&p)return a}return""}};a.fn.extend({spritely:function(b){var c=a(this),e=c.attr("id");b=a.extend({type:"sprite",do_once:!1,width:null,height:null,img_width:0,img_height:0,fps:12,no_of_frames:2,play_frames:0},
b||{});var h=new Image,g=a._spritely._spStrip(c.css("background-image")||"",'url("); ');a._spritely.instances[e]||(a._spritely.instances[e]=b.start_at_frame?{current_frame:b.start_at_frame-1}:{current_frame:-1});a._spritely.instances[e].type=b.type;a._spritely.instances[e].depth=b.depth;b.el=c;b.width=b.width||c.width()||100;b.height=b.height||c.height()||100;h.onload=function(){b.img_width=h.width;b.img_height=h.height;b.img=h;b.do_once?setTimeout(function(){a._spritely.animate(b)},0):setTimeout(function(){a._spritely.animate(b)},
parseInt(1E3/b.fps))};h.src=g;return this},sprite:function(b){b=a.extend({type:"sprite",bounce:[0,0,1E3]},b||{});return a(this).spritely(b)},pan:function(b){b=a.extend({type:"pan",dir:"left",continuous:!0,speed:1},b||{});return a(this).spritely(b)},flyToTap:function(b){b=a.extend({el_to_move:null,type:"moveToTap",ms:1E3,do_once:!0},b||{});b.el_to_move&&a(b.el_to_move).active();a._spritely.activeSprite&&(window.Touch?a(this)[0].ontouchstart=function(b){var c=a._spritely.activeSprite,d=b.touches[0];
b=d.pageY-c.height()/2;d=d.pageX-c.width()/2;c.animate({top:b+"px",left:d+"px"},1E3)}:a(this).click(function(b){var c=a._spritely.activeSprite;a(c).stop(!0);var d=c.width(),g=c.height();c.animate({top:b.pageY-g/2+"px",left:b.pageX-d/2+"px"},1E3)}));return this},isDraggable:function(b){if(!a(this).draggable)return this;b=a.extend({type:"isDraggable",start:null,stop:null,drag:null},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;a._spritely.instances[c].isDraggableOptions=b;
a(this).draggable({start:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!0;a(this).stop(!0);a._spritely.instances[b].isDraggableOptions.start&&a._spritely.instances[b].isDraggableOptions.start(this)},drag:b.drag,stop:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!1;a._spritely.instances[b].isDraggableOptions.stop&&a._spritely.instances[b].isDraggableOptions.stop(this)}});return this},active:function(){a._spritely.activeSprite=this;return this},
activeOnClick:function(){var b=a(this);window.Touch?b[0].ontouchstart=function(c){a._spritely.activeSprite=b}:b.click(function(c){a._spritely.activeSprite=b});return this},spRandom:function(b){b=a.extend({top:50,left:50,right:290,bottom:320,speed:4E3,pause:0},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;if(!a._spritely.instances[c].stop_random){var e=a._spritely.randomIntBetween,h=e(b.top,b.bottom),e=e(b.left,b.right);a("#"+c).animate({top:h+"px",left:e+"px"},b.speed)}window.setTimeout(function(){a("#"+
c).spRandom(b)},b.speed+b.pause);return this},makeAbsolute:function(){return this.each(function(){var b=a(this),c=b.position();b.css({position:"absolute",marginLeft:0,marginTop:0,top:c.top,left:c.left}).remove().appendTo("body")})},spSet:function(b,c){var d=a(this).attr("id");a._spritely.instances[d][b]=c;return this},spGet:function(b,c){var d=a(this).attr("id");return a._spritely.instances[d][b]},spStop:function(b){this.each(function(){var c=a(this),e=c.attr("id");a._spritely.instances[e].options.fps&&
(a._spritely.instances[e]._last_fps=a._spritely.instances[e].options.fps);"sprite"==a._spritely.instances[e].type&&c.spSet("fps",0);a._spritely.instances[e]._stopped=!0;if(a._spritely.instances[e]._stopped_f1=b)e=a._spritely.getBgY(a(this)),c.css("background-position","0 "+e)});return this},spStart:function(){a(this).each(function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._last_fps||12;"sprite"==a._spritely.instances[b].type&&a(this).spSet("fps",c);a._spritely.instances[b]._stopped=!1});
return this},spToggle:function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._stopped_f1||!1;a._spritely.instances[b]._stopped?a(this).spStart():a(this).spStop(c);return this},fps:function(b){a(this).each(function(){a(this).spSet("fps",b)});return this},goToFrame:function(b){var c=a(this).attr("id");a._spritely.instances&&a._spritely.instances[c]&&(a._spritely.instances[c].current_frame=b-1);return this},spSpeed:function(b){a(this).each(function(){a(this).spSet("speed",b)});return this},spRelSpeed:function(b){a(this).each(function(){var c=
a(this).spGet("depth")/100;a(this).spSet("speed",b*c)});return this},spChangeDir:function(b){a(this).each(function(){a(this).spSet("dir",b)});return this},spState:function(b){a(this).each(function(){var c=(b-1)*a(this).height()+"px",c=a._spritely.getBgX(a(this))+" -"+c;a(this).css("background-position",c)});return this},lockTo:function(b,c){a(this).each(function(){var d=a(this).attr("id");if(!a._spritely.instances[d])return this;a._spritely.instances[d].locked_el=a(this);a._spritely.instances[d].lock_to=
a(b);a._spritely.instances[d].lock_to_options=c;a._spritely.instances[d].interval=window.setInterval(function(){if(a._spritely.instances[d].lock_to){var b=a._spritely.instances[d].locked_el,c=a._spritely.instances[d].lock_to,e=a._spritely.instances[d].lock_to_options,q=e.bg_img_width;c.height();var t=a._spritely.getBgY(c),c=a._spritely.getBgX(c),c=parseInt(c)+parseInt(e.left),e=parseInt(t)+parseInt(e.top),c=a._spritely.get_rel_pos(c,q);a(b).css({top:e+"px",left:c+"px"})}},c.interval||20)});return this},
destroy:function(){a(this);var b=a(this).attr("id");a._spritely.instances[b]&&a._spritely.instances[b].timeout&&window.clearTimeout(a._spritely.instances[b].timeout);a._spritely.instances[b]&&a._spritely.instances[b].interval&&window.clearInterval(a._spritely.instances[b].interval);delete a._spritely.instances[b];return this}})})(jQuery);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}
function soundinit(){vlg.sfx={};vlg.music={};vlg.muted=!1;vlg.isSFXOn=!0;vlg.isMusicOn=!0;(function(a){Howl.prototype.play=function(c,b){"SFX"===this.audioType&&!vlg.isSFXOn||"MUSIC"===this.audioType&&!vlg.isMusicOn||a.call(this,c,b);return this}})(Howl.prototype.play);void 0!==GameConfig.config.defaultClickSound?(console.log("using sounds from GameConfig loaded from config sheet."),console.log("defaultClickSound",GameConfig.config.defaultClickSound),vlg.sfx.select=new Howl({urls:[GameConfig.config.defaultClickSound],
volume:1}),vlg.sfx.build=new Howl({urls:[GameConfig.config.defaultBuildSound],volume:.6}),vlg.sfx.cancel=new Howl({urls:[GameConfig.config.defaultCancelSound],volume:.8}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!0,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}),vlg.sfx.select.audioType="SFX",vlg.sfx.build.audioType="SFX",vlg.sfx.cancel.audioType="SFX",vlg.music.welcome.audioType=
"Music",vlg.music.levelfull1.audioType="Music"):(console.log("using sounds urls hardcoded in usehowler.js"),vlg.sfx.select=new Howl({urls:["/client/assets/audio/click.mp3"],volume:1}),vlg.sfx.cancel=new Howl({urls:["/client/assets/audio/cancel.mp3"],volume:.9}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!1,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}))}
function afterplay(a){vlg.log.info("Played ",a)}
function bindSounds(){vlg.log.info("binding sound");$("#goalButton").click(function(a){vlg.log.debug("#goalButton click   .",a)});$("#topToolbar").click(function(a){vlg.log.info("toptoolbar click",a)});$("#topToolbar").children().click(function(a){vlg.log.debug(" toolbar children click .",a);vlg.sfx.select.play(afterplay)});$(".ui-dialog-titlebar-close").click(function(){vlg.log.debug("binding cancel sound to cancel buttons.");vlg.sfx.cancel.play()})}
function toggleSound(){vlg.log.info("toggling Sound ",vlg.muted);vlg.muted?(Howler.unmute(),vlg.muted=!1):(Howler.mute(),vlg.muted=!0);vlg.log.info("now ",vlg.muted);return vlg.muted}function toggleMusic(){vlg.isMusicOn?vlg.music.levelfull1.volume(1):vlg.music.levelfull1.volume(0)}vlg.soundinit=soundinit;vlg.bindSounds=bindSounds;vlg.toggleSound=toggleSound;
$(document).ready(function(){vlg.log.info("Enabling sound and mute");$("#volume").click(function(){vlg.toggleSound();$("#volume").find("img").toggle()});vlg.log.debug("#volume",$("#volume"));vlg.log.debug("#volume kids",$("#volume").children());vlg.log.debug("toogleSound ",vlg.toggleSound)});
(function(){var a={},c=null,b=!0,d=!1;try{"undefined"!==typeof AudioContext?c=new AudioContext:"undefined"!==typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!==typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"===typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){a=parseFloat(a);if(0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){this._setMuted(!0);return this},unmute:function(){this._setMuted(!1);return this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var d=0;d<this._howls[c]._audioNode.length;d++)this._howls[c]._audioNode[d].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var d=c.createBuffer(1,1,22050),f=c.createBufferSource();f.buffer=d;f.connect(c.destination);"undefined"===typeof f.start?
f.noteOn(0):f.start(0);setTimeout(function(){if(f.playbackState===f.PLAYING_STATE||f.playbackState===f.FINISHED_STATE)a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1)},0)};window.addEventListener("touchend",b,!1);return a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!==typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};t.prototype={load:function(){var a=this,b=null;if(d)a.on("loaderror",Error("No audio support."));else{for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else if(g=a._urls[c],(e=/^data:audio\/([^;,]+);/i.exec(g))||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),e)e=e[1].toLowerCase();else{a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
return}if(p[e]){b=a._urls[c];break}}if(b){a._src=b;if(a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));
a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a}a.on("loaderror",Error("No codec support for selected audio sources."))}},urls:function(a){return a?(this.stop(),this._urls="string"===typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var d=this;"function"===typeof a&&(b=a);a&&"function"!==typeof a||(a="_default");if(!d._loaded)return d.on("load",function(){d.play(a,b)}),d;if(!d._sprite[a])return"function"===
typeof b&&b(),d;d._inactiveNode(function(f){f._sprite=a;var e=0<f._pos?f._pos:d._sprite[a][0]/1E3,l=0;d._webAudio?(l=d._sprite[a][1]/1E3-f._pos,0<f._pos&&(e=d._sprite[a][0]/1E3+e)):l=d._sprite[a][1]/1E3-(e-d._sprite[a][0]/1E3);var g=!(!d._loop&&!d._sprite[a][2]),m="string"===typeof b?b:Math.round(Date.now()*Math.random())+"",h;(function(){h=setTimeout(function(){!d._webAudio&&g&&d.stop(m).play(a,m);d._webAudio&&!g&&(d._nodeById(m).paused=!0,d._nodeById(m)._pos=0,d._clearEndTimer(m));d._webAudio||
g||d.stop(m);d.on("end",m)},l/d._rate*1E3);d._onendTimer.push({timer:h,id:m})})();if(d._webAudio){var n=d._sprite[a][0]/1E3,p=d._sprite[a][1]/1E3;f.id=m;f.paused=!1;k(d,[g,n,p],m);d._playStart=c.currentTime;f.gain.value=d._volume;"undefined"===typeof f.bufferSource.start?g?f.bufferSource.noteGrainOn(0,e,86400):f.bufferSource.noteGrainOn(0,e,l):g?f.bufferSource.start(0,e,86400):f.bufferSource.start(0,e,l)}else if(4===f.readyState||!f.readyState&&navigator.isCocoonJS)f.readyState=4,f.id=m,f.currentTime=
e,f.muted=q._muted||f.muted,f.volume=d._volume*q.volume(),setTimeout(function(){f.play()},0);else return d._clearEndTimer(m),function(){var c=a,e=b,l=function(){d.play(c,e);f.removeEventListener("canplaythrough",l,!1)};f.addEventListener("canplaythrough",l,!1)}(),d;d.on("play");"function"===typeof b&&b(m);return d});return d},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,
a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();b.on("pause");return b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||
(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=0:c.muted=!0);return b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1);return b},volume:function(a,b){var c=this;a=parseFloat(a);if(0<=a&&1>=a){c._volume=a;if(!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();d&&(c._webAudio?d.gain.value=a:d.volume=a*q.volume());return c}return c._volume},loop:function(a){return"boolean"===typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"===typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"===typeof a?d:d._pos||0;a=parseFloat(a);var f=b?d._nodeById(b):d._activeNode();if(f)return 0<=a?(d.pause(b),
f._pos=a,d.play(f._sprite,b),d):d._webAudio?f._pos+(c.currentTime-d._playStart):f.currentTime;if(0<=a)return d;for(f=0;f<d._audioNode.length;f++)if(d._audioNode[f].paused&&4===d._audioNode[f].readyState)return d._webAudio?d._audioNode[f]._pos:d._audioNode[f].currentTime},pos3d:function(a,b,c,d){var f=this;b="undefined"!==typeof b&&b?b:0;c="undefined"!==typeof c&&c?c:-.5;if(!f._loaded)return f.on("play",function(){f.pos3d(a,b,c,d)}),f;if(0<=a||0>a){if(f._webAudio){var e=d?f._nodeById(d):f._activeNode();
e&&(f._pos3d=[a,b,c],e.panner.setPosition(a,b,c),e.panner.panningModel=f._model||"HRTF")}}else return f._pos3d;return f},fade:function(a,b,c,d,e){var f=this,l=a>b?"down":"up",g=Math.abs(a-b)/.01,h=c/g;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var m=1;m<=g;m++)(function(){var a=Math.round(1E3*(f._volume+("up"===l?.01:-.01)*m))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},h*m)})()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},
fadeOut:function(a,b,c,d){var f=this;return f.fade(f._volume,a,b,function(){c&&c();f.pause(d);f.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}this._drainPool();return a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}this._drainPool();if(!b){var d;if(this._webAudio)d=this._setupAudioNode(),a(d);else{this.load();d=this._audioNode[this._audioNode.length-1];var f=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",e=function(){d.removeEventListener(f,e,!1);a(d)};d.addEventListener(f,e,!1)}}},_drainPool:function(){var a=0,b;for(b=0;b<this._audioNode.length;b++)this._audioNode[b].paused&&a++;for(b=this._audioNode.length-1;0<=b&&!(5>=a);b--)this._audioNode[b].paused&&
(this._webAudio&&this._audioNode[b].disconnect(0),a--,this._audioNode.splice(b,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}if(a=this._onendTimer[b])clearTimeout(a.timer),this._onendTimer.splice(b,1)},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;a[b]="undefined"===typeof c.createGain?c.createGainNode():c.createGain();a[b].gain.value=this._volume;a[b].paused=!0;a[b]._pos=0;a[b].readyState=4;a[b].connect(e);
a[b].panner=c.createPanner();a[b].panner.panningModel=this._model||"equalpower";a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]);a[b].panner.connect(a[b]);return a[b]},on:function(a,b){var c=this["_on"+a];if("function"===typeof b)c.push(b);else for(var d=0;d<c.length;d++)b?c[d].call(this,b):c[d].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var d=0;d<c.length;d++){if(b===c[d]){c.splice(d,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}};if(b)var x=function(b,c){if(c in a)b._duration=a[c].duration,G(b);else if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),f=new Uint8Array(d.length),e=0;e<d.length;++e)f[e]=
d.charCodeAt(e);w(f.buffer,b,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){w(g.response,b,c)};g.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{g.send()}catch(H){g.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"===typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!==typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!==typeof window&&(window.Howler=q,window.Howl=t)})();
(function(a){var c={numberStep:function(b,c){var d=Math.floor(b);a(c.elem).text(d)}},b=function(a){var b=a.elem;b.nodeType&&b.parentNode&&(b=b._animateNumberSetter,b||(b=c.numberStep),b(a.now,a))};a.Tween&&a.Tween.propHooks?a.Tween.propHooks.number={set:b}:a.fx.step.number=b;a.animateNumber={numberStepFactories:{append:function(b){return function(c,d){var e=Math.floor(c);a(d.elem).prop("number",c).text(e+b)}},separator:function(b,c,h){b=b||" ";c=c||3;h=h||"";return function(d,e){var g=Math.floor(d).toString(),
p=a(e.elem);if(g.length>c){for(var x=g,w=c,G=x.split("").reverse(),g=[],k,f,l,m=0,n=Math.ceil(x.length/w);m<n;m++){k="";for(l=0;l<w;l++){f=m*w+l;if(f===x.length)break;k+=G[f]}g.push(k)}x=g.length-1;w=g[x].split("").reverse().join("");g[x]=parseInt(w,10).toString().split("").reverse().join("");g=g.join(b);g=g.split("").reverse().join("")}p.prop("number",d).text(g+h)}}}};a.fn.animateNumber=function(){for(var b=arguments[0],e=a.extend({},c,b),h=a(this),g=[e],p=1,q=arguments.length;p<q;p++)g.push(arguments[p]);
if(b.numberStep){var t=this.each(function(){this._animateNumberSetter=b.numberStep}),x=e.complete;e.complete=function(){t.each(function(){delete this._animateNumberSetter});x&&x.apply(this,arguments)}}return h.animate.apply(h,g)}})(jQuery);
(function(a){function c(){return document[h?"webkit"===h?"webkitIsFullScreen":h+"FullScreen":"fullScreen"]}function b(){return document[h?h+"CancelFullScreen":"cancelFullScreen"]()}var d="undefined"!==typeof document.cancelFullScreen,e=["webkit","moz","o","ms","khtml"],h="",g=function(){},p;if(!d)for(p=0;h=e[p];p++)if("undefined"!==typeof document[h+"CancelFullScreen"]){d=!0;break}d?(a.fn.requestFullScreen=function(){return this.each(function(){return this[h?h+"RequestFullScreen":"requestFullScreen"]()})},
a.fn.fullScreenChange=function(b){var c=[h+"fullscreenchange"].concat([].slice.call(arguments,0)),d=a(this);return d.bind.apply(d,c)},a.FullScreen={isFullScreen:c,cancelFullScreen:b}):(a.fn.requestFullScreen=a.fn.fullScreenChange=g,a.FullScreen={isFullScreen:function(){return!1},cancelFullScreen:g})})(jQuery);
(function(a,c){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():c.log4javascript=a()})(function(){function a(a){return"undefined"==typeof a}function c(){}function b(){}function d(a){return a&&a.toString?a.toString():String(a)}function e(a){return a.message?a.message:a.description?a.description:d(a)}function h(a){if(a){var b="Exception: "+e(a);try{if(a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName){var c=b,d,f=a.fileName,
g=Math.max(f.lastIndexOf("/"),f.lastIndexOf("\\"));d=f.substr(g+1);b=c+(" in file "+d)}}catch(ka){I.warn("Unable to obtain file and line information for error")}oa&&a.stack&&(b+="\r\nStack trace:\r\n"+a.stack);return b}return null}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function p(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}function q(a,b){for(var c=-1,d=0,f=a.length;d<f;d++)if(a[d]===b){c=d;break}return 0<=c?(a.splice(c,1),!0):!1}function t(a,b){for(var c=
0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1}function x(b,c){return a(b)?c:!!b}function w(b,c){return a(b)?c:String(b)}function G(b,c){if(a(b))return c;try{var d=parseInt(b,10);return isNaN(d)?c:d}catch(ha){return I.warn("Invalid int param "+b,ha),c}}function k(a,b){I.error(a,b);u.dispatchEvent("error",{message:a,exception:b})}function f(b,c){this.name=b;this.level=a(c)?v.INFO:c;this.start=new Date}function l(b){this.name=b;this.parent=null;this.children=[];var c=[],e=null,g="root"===this.name,
l="[null]"===this.name,h=null,m=!1;this.addChild=function(a){this.children.push(a);a.parent=this;a.invalidateAppenderCache()};var r=!0;this.getAdditivity=function(){return r};this.setAdditivity=function(a){var b=r!=a;r=a;b&&this.invalidateAppenderCache()};this.addAppender=function(a){l?k("Logger.addAppender: you may not add an appender to the null logger"):a instanceof u.Appender?t(c,a)||(c.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):k("Logger.addAppender: appender supplied ('"+
d(a)+"') is not a subclass of Appender")};this.removeAppender=function(a){q(c,a);a.setRemovedFromLogger(this);this.invalidateAppenderCache()};this.removeAllAppenders=function(){var a=c.length;if(0<a){for(var b=0;b<a;b++)c[b].setRemovedFromLogger(this);c.length=0;this.invalidateAppenderCache()}};this.getEffectiveAppenders=function(){if(null===h||m)h=(g||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders()).concat(c),m=!1;return h};this.invalidateAppenderCache=function(){m=!0;for(var a=0,b=
this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()};this.log=function(a,b){if(Q&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,d=b.length-1,f=b[d];1<b.length&&f instanceof Error&&(c=f,d--);for(var f=[],e=0;e<=d;e++)f[e]=b[e];c=new qa(this,new Date,a,f,c);this.callAppenders(c)}};this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,d=b.length;c<d;c++)b[c].doAppend(a)};this.setLevel=function(a){g&&null===a?k("Logger.setLevel: you cannot set the level of the root logger to null"):
a instanceof v?e=a:k("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")};this.getLevel=function(){return e};this.getEffectiveLevel=function(){for(var a=this;null!==a;a=a.parent){var b=a.getLevel();if(null!==b)return b}};this.group=function(a,b){if(Q)for(var c=this.getEffectiveAppenders(),d=0,f=c.length;d<f;d++)c[d].group(a,b)};this.groupEnd=function(){if(Q)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;b<c;b++)a[b].groupEnd()};var n={};this.time=
function(b,c){Q&&(a(b)?k("Logger.time: a name for the timer must be supplied"):!c||c instanceof v?n[b]=new f(b,c):k("Logger.time: level supplied to timer "+b+" is not an instance of log4javascript.Level"))};this.timeEnd=function(b){if(Q)if(a(b))k("Logger.timeEnd: a name for the timer must be supplied");else if(n[b]){var c=n[b],f=c.getElapsedTime();this.log(c.level,["Timer "+d(b)+" completed in "+f+"ms"]);delete n[b]}else I.warn("Logger.timeEnd: no timer found with name "+b)};this.assert=function(a){if(Q&&
!a){for(var b=[],c=1,d=arguments.length;c<d;c++)b.push(arguments[c]);b=0<b.length?b:["Assertion Failure"];b.push("\r\n");b.push(a);this.log(v.ERROR,b)}};this.toString=function(){return"Logger["+this.name+"]"}}function m(){this.customFields=[]}function n(){this.customFields=[]}function C(a){this.combineMessages=x(a,!0);this.customFields=[]}function B(a,b){this.readable=x(a,!1);this.combineMessages=x(b,!0);this.batchHeader=this.readable?"[\r\n":"[";this.batchFooter=this.readable?"]\r\n":"]";this.batchSeparator=
this.readable?",\r\n":",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?"\r\n":"";this.customFields=[]}function H(){this.setKeys();this.customFields=[];this.returnsPostData=!0}function ga(a,b,c){function f(a,b,c){function g(a){a=p(a);for(var b=1,d=a.length;b<d;b++)a[b]=c+a[b];return a.join("\r\n")}var l,m,r,n,k,D;c||(c="");if(null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return g(a);if("object"==
typeof a&&t(e,a)){try{k=d(a)}catch(ca){k="Error formatting property. Details: "+h(ca)}return k+" [already expanded]"}if(a instanceof Array&&0<b){e.push(a);k="[\r\n";m=b-1;r=c+"  ";n=[];l=0;for(b=a.length;l<b;l++)try{D=f(a[l],m,r),n.push(r+D)}catch(ca){n.push(r+"Error formatting array member. Details: "+h(ca)+"")}return k+=n.join(",\r\n")+"\r\n"+c+"]"}if("[object Date]"==Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&0<b){e.push(a);k="{\r\n";m=b-1;r=c+"  ";n=[];for(l in a)try{D=
f(a[l],m,r),n.push(r+l+": "+D)}catch(ca){n.push(r+l+": Error formatting property. Details: "+h(ca))}return k+=n.join(",\r\n")+"\r\n"+c+"}"}return g(d(a))}var e=[];return f(a,b,c)}function E(a){this.pattern=a?a:E.DEFAULT_CONVERSION_PATTERN;this.customFields=[]}function K(){}function F(){}function M(b,c){function d(a){return ga?(k("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0}function f(){if(p&&Q){K=!0;var a;if(J)0<F.length?(a=F.shift(),
m(g(a),f)):(K=!1,q&&window.setTimeout(f,B));else{for(;a=F.shift();)m(g(a));K=!1;q&&window.setTimeout(f,B)}}}function e(){var a=!1;if(p&&Q){for(var a=n.getLayout().allowBatching()?t:1,b,c=[];b=A.shift();)c.push(b),A.length>=a&&(F.push(c),c=[]);0<c.length&&F.push(c);a=0<F.length;q=J=!1;f()}return a}function g(a){for(var b=[],c;c=a.shift();)b.push(n.getLayout().formatWithException(c));a=1==a.length?b.join(""):n.getLayout().batchHeader+b.join(n.getLayout().batchSeparator)+n.getLayout().batchFooter;y==
n.defaults.contentType&&(a=n.getLayout().returnsPostData?a:U(v)+"="+U(a),0<a.length&&(a+="&"),a+="layout="+U(n.getLayout().toString()));return a}function l(){k("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled");p=!1;C&&C("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled")}function m(d,f){try{var e=ra(l);if(p){e.onreadystatechange=function(){if(4==e.readyState){var c=e;a(c.status)||0===c.status||200<=c.status&&300>c.status||1223==c.status?(u&&
u(e),f&&f(e)):(c="AjaxAppender.append: XMLHttpRequest request to URL "+b+" returned status code "+e.status,k(c),C&&C(c));e.onreadystatechange=da;e=null}};e.open("POST",b,!0);c&&za&&(e.withCredentials=!0);try{for(var g=0,m;m=I[g++];)e.setRequestHeader(m.name,m.value);e.setRequestHeader("Content-Type",y)}catch(na){k("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");p=!1;C&&C("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");
return}e.send(d)}}catch(na){g="AjaxAppender.append: error sending log message to "+b,k(g,na),p=!1,C&&C(g+". Details: "+h(na))}}function r(){ga=!0;if(E){var a=window.onbeforeunload;window.onbeforeunload=function(){a&&a();e()}}q&&window.setTimeout(f,B)}var n=this,p=!0;b||(k("AjaxAppender: URL must be specified in constructor"),p=!1);var q=this.defaults.timed,J=this.defaults.waitForResponse,t=this.defaults.batchSize,B=this.defaults.timerInterval,u=this.defaults.requestSuccessCallback,C=this.defaults.failCallback,
v=this.defaults.postVarName,E=this.defaults.sendAllOnUnload,y=this.defaults.contentType,H=null,A=[],F=[],I=[],K=!1,ga=!1;this.getSessionId=function(){return H};this.setSessionId=function(a){H=w(a,null);this.layout.setCustomField("sessionid",H)};this.setLayout=function(a){d("layout")&&(this.layout=a,null!==H&&this.setSessionId(H))};this.isTimed=function(){return q};this.setTimed=function(a){d("timed")&&(q=!!a)};this.getTimerInterval=function(){return B};this.setTimerInterval=function(a){d("timerInterval")&&
(B=G(a,B))};this.isWaitForResponse=function(){return J};this.setWaitForResponse=function(a){d("waitForResponse")&&(J=!!a)};this.getBatchSize=function(){return t};this.setBatchSize=function(a){d("batchSize")&&(t=G(a,t))};this.isSendAllOnUnload=function(){return E};this.setSendAllOnUnload=function(a){d("sendAllOnUnload")&&(E=x(a,E))};this.setRequestSuccessCallback=function(a){u="function"==typeof a?a:u};this.setFailCallback=function(a){C="function"==typeof a?a:C};this.getPostVarName=function(){return v};
this.setPostVarName=function(a){d("postVarName")&&(v=w(a,v))};this.getHeaders=function(){return I};this.addHeader=function(a,b){"content-type"==a.toLowerCase()?y=b:I.push({name:a,value:b})};this.sendAll=f;this.sendAllRemaining=e;this.append=function(a){if(p&&(ga||r(),A.push(a),a=this.getLayout().allowBatching()?t:1,A.length>=a)){for(var b=[];a=A.shift();)b.push(a);F.push(b);q||J&&(!J||K)||f()}}}function ba(a){try{return!!a.loaded}catch(J){return!1}}function W(a,b){if(a.length<b){for(var c=[],d=Math.max(0,
b-a.length),f=0;f<d;f++)c[f]=" ";a+=c.join("")}return a}Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length});Array.prototype.shift||(Array.prototype.shift=function(){if(0<this.length){for(var a=this[0],b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];--this.length;return a}});Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),d=this.slice(a,a+b);this.length=a;for(var f=[],e=0,
g=arguments.length;e<g;e++)f[e]=arguments[e];c=2<f.length?f.slice(2).concat(c):c;e=0;for(g=c.length;e<g;e++)this.push(c[e]);return d});c.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a;this.eventListeners={};a=0;for(var b=this.eventTypes.length;a<b;a++)this.eventListeners[this.eventTypes[a]]=[]}else k("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){"function"==
typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):k("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){"function"==typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),q(this.eventListeners[a],b)):k("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},
dispatchEvent:function(a,b){if(t(this.eventTypes,a))for(var c=this.eventListeners[a],d=0,f=c.length;d<f;d++)c[d](this,a,b);else k("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var Aa=new Date,Ba="log4javascript_"+Aa.getTime()+"_"+Math.floor(1E8*Math.random()),da=function(){},wa=!1;b.prototype=new c;var u=new b;u.version="1.4.13";u.edition="log4javascript";var U="undefined"!=typeof window.encodeURIComponent?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,
"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(a,b){var c="__apply__";"undefined"!=typeof a[c]&&(c+=String(Math.random()).substr(2));a[c]=this;for(var d=[],f=0,e=b.length;f<e;f++)d[f]="args["+f+"]";d="obj."+c+"("+d.join(",")+")";d=eval(d);delete a[c];return d});Function.prototype.call||(Function.prototype.call=function(a){for(var b=[],c=1,d=arguments.length;c<d;c++)b[c-1]=arguments[c];return this.apply(a,
b)});var I={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=!!a},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join("\r\n"))},warn:function(a,b){},error:function(a,b){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+="\r\n\r\nOriginal error: "+h(b));alert(c)}}};u.logLog=I;u.setEventTypes(["load",
"error"]);u.handleError=k;var Q=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);u.setEnabled=function(a){Q=!!a};u.isEnabled=function(){return Q};var ea=!0;u.setTimeStampsInMilliseconds=function(a){ea=!!a};u.isTimeStampsInMilliseconds=function(){return ea};u.evalInScope=function(a){return eval(a)};var oa=!1;u.setShowStackTraces=function(a){oa=!!a};var v=function(a,b){this.level=a;this.name=b};v.prototype={toString:function(){return this.name},equals:function(a){return this.level==
a.level},isGreaterOrEqual:function(a){return this.level>=a.level}};v.ALL=new v(Number.MIN_VALUE,"ALL");v.TRACE=new v(1E4,"TRACE");v.DEBUG=new v(2E4,"DEBUG");v.INFO=new v(3E4,"INFO");v.WARN=new v(4E4,"WARN");v.ERROR=new v(5E4,"ERROR");v.FATAL=new v(6E4,"FATAL");v.OFF=new v(Number.MAX_VALUE,"OFF");u.Level=v;f.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};l.prototype={trace:function(){this.log(v.TRACE,arguments)},debug:function(){this.log(v.DEBUG,arguments)},info:function(){this.log(v.INFO,
arguments)},warn:function(){this.log(v.WARN,arguments)},error:function(){this.log(v.ERROR,arguments)},fatal:function(){this.log(v.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(v.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(v.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(v.INFO)},isWarnEnabled:function(){return this.isEnabledFor(v.WARN)},isErrorEnabled:function(){return this.isEnabledFor(v.ERROR)},
isFatalEnabled:function(){return this.isEnabledFor(v.FATAL)}};l.prototype.trace.isEntryPoint=!0;l.prototype.debug.isEntryPoint=!0;l.prototype.info.isEntryPoint=!0;l.prototype.warn.isEntryPoint=!0;l.prototype.error.isEntryPoint=!0;l.prototype.fatal.isEntryPoint=!0;var aa={},Ia=[],Ca=v.DEBUG,Y=new l("root");Y.setLevel(Ca);u.getRootLogger=function(){return Y};u.getLogger=function(a){"string"!=typeof a&&(a="[anonymous]",I.warn("log4javascript.getLogger: non-string logger name "+d(a)+" supplied, returning anonymous logger"));
"root"==a&&k("log4javascript.getLogger: root logger may not be obtained by name");if(!aa[a]){var b=new l(a);aa[a]=b;Ia.push(a);var c=a.lastIndexOf(".");-1<c?(c=a.substring(0,c),c=u.getLogger(c)):c=Y;c.addChild(b)}return aa[a]};var fa=null;u.getDefaultLogger=function(){if(!fa){var a=u.getLogger("[default]"),b=new u.PopUpAppender;a.addAppender(b);fa=a}return fa};var Z=null;u.getNullLogger=function(){Z||(Z=new l("[null]"),Z.setLevel(v.OFF));return Z};u.resetConfiguration=function(){Y.setLevel(Ca);aa=
{}};var qa=function(a,b,c,d,f){this.logger=a;this.timeStamp=b;this.timeStampInMilliseconds=b.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1E3);this.milliseconds=this.timeStamp.getMilliseconds();this.level=c;this.messages=d;this.exception=f};qa.prototype={getThrowableStrRep:function(){return this.exception?h(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join("\r\n")},toString:function(){return"LoggingEvent["+
this.level+"]"}};u.LoggingEvent=qa;var R=function(){};R.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,
format:function(){k("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){k("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0;this.useTimeStampsInMilliseconds=!!a},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:ea},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?
a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]);a.exception&&c.push([this.exceptionKey,h(a.exception)]);if(this.hasCustomFields())for(var d=0,f=this.customFields.length;d<f;d++){var e=this.customFields[d].value;
"function"===typeof e&&(e=e(this,a));c.push([this.customFields[d].name,e])}return c},setKeys:function(a,b,c,d,f,e,g){this.loggerKey=w(a,this.defaults.loggerKey);this.timeStampKey=w(b,this.defaults.timeStampKey);this.levelKey=w(c,this.defaults.levelKey);this.messageKey=w(d,this.defaults.messageKey);this.exceptionKey=w(f,this.defaults.exceptionKey);this.urlKey=w(e,this.defaults.urlKey);this.millisecondsKey=w(g,this.defaults.millisecondsKey)},setCustomField:function(a,b){for(var c=!1,d=0,f=this.customFields.length;d<
f;d++)this.customFields[d].name===a&&(this.customFields[d].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return 0<this.customFields.length},formatWithException:function(a){var b=this.format(a);a.exception&&this.ignoresThrowable()&&(b+=a.getThrowableStrRep());return b},toString:function(){k("Layout.toString: all layouts must override this method")}};u.Layout=R;var y=function(){};y.prototype=new c;y.prototype.layout=new E;y.prototype.threshold=v.ALL;y.prototype.loggers=
[];y.prototype.doAppend=function(a){Q&&a.level.level>=this.threshold.level&&this.append(a)};y.prototype.append=function(a){};y.prototype.setLayout=function(a){a instanceof R?this.layout=a:k("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")};y.prototype.getLayout=function(){return this.layout};y.prototype.setThreshold=function(a){a instanceof v?this.threshold=a:k("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")};
y.prototype.getThreshold=function(){return this.threshold};y.prototype.setAddedToLogger=function(a){this.loggers.push(a)};y.prototype.setRemovedFromLogger=function(a){q(this.loggers,a)};y.prototype.group=da;y.prototype.groupEnd=da;y.prototype.toString=function(){k("Appender.toString: all appenders must override this method")};u.Appender=y;m.prototype=new R;m.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()};m.prototype.ignoresThrowable=function(){return!0};m.prototype.toString=
function(){return"SimpleLayout"};u.SimpleLayout=m;n.prototype=new R;n.prototype.format=function(a){return a.messages};n.prototype.ignoresThrowable=function(){return!0};n.prototype.formatWithException=function(a){var b=a.messages;return(a=a.exception)?b.concat([a]):b};n.prototype.toString=function(){return"NullLayout"};u.NullLayout=n;C.prototype=new R;C.prototype.isCombinedMessages=function(){return this.combineMessages};C.prototype.getContentType=function(){return"text/xml"};C.prototype.escapeCdata=
function(a){return a.replace(/\]\]>/,"]]\x3e]]&gt;<![CDATA[")};C.prototype.format=function(a){function b(a){a="string"===typeof a?a:d(a);return"<log4javascript:message><![CDATA["+c.escapeCdata(a)+"]]\x3e</log4javascript:message>"}var c=this,f,e,g='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';this.isTimeStampsInMilliseconds()||(g+=' milliseconds="'+a.milliseconds+'"');g+=' level="'+a.level.name+'">\r\n';if(this.combineMessages)g+=b(a.getCombinedMessages());
else{g+="<log4javascript:messages>\r\n";f=0;for(e=a.messages.length;f<e;f++)g+=b(a.messages[f])+"\r\n";g+="</log4javascript:messages>\r\n"}if(this.hasCustomFields())for(f=0,e=this.customFields.length;f<e;f++)g+='<log4javascript:customfield name="'+this.customFields[f].name+'"><![CDATA['+this.customFields[f].value.toString()+"]]\x3e</log4javascript:customfield>\r\n";a.exception&&(g+="<log4javascript:exception><![CDATA["+h(a.exception)+"]]\x3e</log4javascript:exception>\r\n");return g+"</log4javascript:event>\r\n\r\n"};
C.prototype.ignoresThrowable=function(){return!1};C.prototype.toString=function(){return"XmlLayout"};u.XmlLayout=C;B.prototype=new R;B.prototype.isReadable=function(){return this.readable};B.prototype.isCombinedMessages=function(){return this.combineMessages};B.prototype.format=function(a){function b(a,f,e){var g=typeof a;if(a instanceof Date)e=String(a.getTime());else if(e&&a instanceof Array){e="["+c.lineBreak;for(var g=0,l=a.length;g<l;g++){var h=f+c.tab;e+=h+b(a[g],h,!1);g<a.length-1&&(e+=",");
e+=c.lineBreak}e+=f+"]"}else e="number"!==g&&"boolean"!==g?'"'+d(a).replace(/\"/g,'\\"').replace(/\r\n|\r|\n/g,"\\r\\n")+'"':a;return e}var c=this;a=this.getDataValues(a,this.combineMessages);var f="{"+this.lineBreak,e,g;e=0;for(g=a.length-1;e<=g;e++)f+=this.tab+'"'+a[e][0]+'"'+this.colon+b(a[e][1],this.tab,!0),e<g&&(f+=","),f+=this.lineBreak;return f+="}"+this.lineBreak};B.prototype.ignoresThrowable=function(){return!1};B.prototype.toString=function(){return"JsonLayout"};B.prototype.getContentType=
function(){return"application/json"};u.JsonLayout=B;H.prototype=new R;H.prototype.allowBatching=function(){return!1};H.prototype.format=function(a){a=this.getDataValues(a);for(var b=[],c=0,d=a.length;c<d;c++){var f=a[c][1]instanceof Date?String(a[c][1].getTime()):a[c][1];b.push(U(a[c][0])+"="+U(f))}return b.join("&")};H.prototype.ignoresThrowable=function(a){return!1};H.prototype.toString=function(){return"HttpPostDataLayout"};u.HttpPostDataLayout=H;var P;(function(){var b=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,
c="January February March April May June July August September October November December".split(" "),d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f={G:0,y:3,M:4,w:2,W:2,D:2,d:2,F:2,E:1,a:0,H:2,k:2,K:2,h:2,m:2,s:2,S:2,Z:5},e=function(a,b,c){a=new Date(a,b,c,0,0,0);a.setMilliseconds(0);return a};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()};Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),
this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()};Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),a=new Date(a.getTime()-864E5*this.getDay());return e(a.getFullYear(),a.getMonth(),a.getDate())};Date.prototype.getWeekInYear=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),
d=e(this.getFullYear(),0,1),c=c.isBefore(d)?0:1+Math.floor(c.getTimeSince(d)/6048E5),d=7-d.getDay();d<b&&c--;return c};Date.prototype.getWeekInMonth=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),d=e(this.getFullYear(),this.getMonth(),1),c=c.isBefore(d)?0:1+Math.floor(c.getTimeSince(d)/6048E5),d=7-d.getDay();d>=b&&c++;return c};Date.prototype.getDayInYear=function(){var a=e(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/864E5)};P=function(a){this.formatString=
a};P.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a};P.prototype.getMinimalDaysInFirstWeek=function(){return a(this.minimalDaysInFirstWeek)?1:this.minimalDaysInFirstWeek};var g=function(a,b){for(;a.length<b;)a="0"+a;return a},l=function(a,b,c){return 4<=b?a:a.substr(0,Math.max(c,b))};P.prototype.format=function(a){for(var e="",h,m=this.formatString;h=b.exec(m);){var n=h[1],k=h[2],r=h[3],p=h[4];if(n)e="''"==n?e+"'":e+n.substring(1,n.length-1);else if(!r)if(p)e+=p;else if(k){n=
k.charAt(0);k=k.length;r="";switch(n){case "G":r="AD";break;case "y":r=a.getFullYear();break;case "M":r=a.getMonth();break;case "w":r=a.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case "W":r=a.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case "D":r=a.getDayInYear();break;case "d":r=a.getDate();break;case "F":r=1+Math.floor((a.getDate()-1)/7);break;case "E":r=d[a.getDay()];break;case "a":r=12<=a.getHours()?"PM":"AM";break;case "H":r=a.getHours();break;case "k":r=a.getHours()||24;
break;case "K":r=a.getHours()%12;break;case "h":r=a.getHours()%12||12;break;case "m":r=a.getMinutes();break;case "s":r=a.getSeconds();break;case "S":r=a.getMilliseconds();break;case "Z":r=a.getTimezoneOffset()}switch(f[n]){case 0:e+=l(r,k,2);break;case 1:e+=l(r,k,3);break;case 2:e+=g(""+r,k);break;case 3:e=3>=k?e+(""+r).substr(2,2):e+g(""+r,k);break;case 4:e=3<=k?e+l(c[r],k,k):e+g(""+(r+1),k);break;case 5:k=0<r?"-":"+",r=Math.abs(r),n=""+Math.floor(r/60),n=g(n,2),r=""+r%60,r=g(r,2),e+=k+n+r}}m=m.substr(h.index+
h[0].length)}return e}})();u.SimpleDateFormat=P;E.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";E.DEFAULT_CONVERSION_PATTERN="%m%n";E.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";E.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";E.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";E.prototype=new R;E.prototype.format=function(a){for(var b=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,c="",d,f=this.pattern;d=b.exec(f);){var e=d[0],g=d[1],l=d[2],h=d[3],m=d[5],n=d[6];if(n)c+=""+n;else{n="";switch(h){case "a":case "m":e=
0;m&&(e=parseInt(m,10),isNaN(e)&&(k("PatternLayout.format: invalid specifier '"+m+"' for conversion character '"+h+"' - should be a number"),e=0));for(var m="a"===h?a.messages[0]:a.messages,h=0,r=m.length;h<r;h++)0<h&&" "!==n.charAt(n.length-1)&&(n+=" "),n=0===e?n+m[h]:n+ga(m[h],e);break;case "c":n=a.logger.name;m&&(m=parseInt(m,10),e=a.logger.name.split("."),n=m>=e.length?n:e.slice(e.length-m).join("."));break;case "d":n=E.ISO8601_DATEFORMAT;m&&(n=m,"ISO8601"==n?n=E.ISO8601_DATEFORMAT:"ABSOLUTE"==
n?n=E.ABSOLUTETIME_DATEFORMAT:"DATE"==n&&(n=E.DATETIME_DATEFORMAT));n=(new P(n)).format(a.timeStamp);break;case "f":this.hasCustomFields()&&(n=0,m&&(n=parseInt(m,10),isNaN(n)?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - should be a number"):0===n?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - must be greater than zero"):n>this.customFields.length?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - there aren't that many custom fields"):
--n),n=this.customFields[n].value,"function"==typeof n&&(n=n(this,a)));break;case "n":n="\r\n";break;case "p":n=a.level.name;break;case "r":n=""+a.timeStamp.getDifference(Aa);break;case "%":n="%";break;default:n=e}l&&(l=parseInt(l.substr(1),10),m=n.length,l<m&&(n=n.substring(m-l,m)));if(g)if("-"==g.charAt(0))for(l=parseInt(g.substr(1),10);n.length<l;)n+=" ";else for(l=parseInt(g,10);n.length<l;)n=" "+n;c+=n}f=f.substr(d.index+d[0].length)}return c};E.prototype.ignoresThrowable=function(){return!0};
E.prototype.toString=function(){return"PatternLayout"};u.PatternLayout=E;K.prototype=new y;K.prototype.layout=new m;K.prototype.append=function(a){alert(this.getLayout().formatWithException(a))};K.prototype.toString=function(){return"AlertAppender"};u.AlertAppender=K;F.prototype=new u.Appender;F.prototype.layout=new n;F.prototype.threshold=v.DEBUG;F.prototype.append=function(a){var b=this,c=function(c){var d=b.getLayout().formatWithException(a);return"string"==typeof d?c?d:[d]:c?d.join(" "):d},d=
window.console;if(d&&d.log){var f;f=d.debug&&v.DEBUG.isGreaterOrEqual(a.level)?"debug":d.info&&v.INFO.equals(a.level)?"info":d.warn&&v.WARN.equals(a.level)?"warn":d.error&&a.level.isGreaterOrEqual(v.ERROR)?"error":"log";if("function"==typeof d[f].apply)d[f].apply(d,c(!1));else d[f](c(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(c(!0))};F.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)};F.prototype.groupEnd=function(){window.console&&
window.console.groupEnd&&window.console.groupEnd()};F.prototype.toString=function(){return"BrowserConsoleAppender"};u.BrowserConsoleAppender=F;var Da=function(){return new XMLHttpRequest},Ea=[Da,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],za=!1,ra=function(a){for(var b=null,c,d=0,f=Ea.length;d<f;d++){c=Ea[d];try{return b=c(),za=c==Da&&"withCredentials"in b,ra=c,b}catch(D){}}a?a():k("getXmlHttp: unable to obtain XMLHttpRequest object")};
M.prototype=new y;M.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1E3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};M.prototype.layout=new H;M.prototype.toString=function(){return"AjaxAppender"};u.AjaxAppender=M;var A;(function(){function b(a,b,c,d,f){this.create(!1,null,a,b,c,d,f,this.defaults.focusPopUp)}function c(a,b,c,d,f,e){this.create(!0,a,b,c,d,f,e,!1)}var d=[];A=function(){};
var f=1;A.prototype=new y;A.prototype.create=function(b,c,e,g,l,m,n,r){function p(a,b){this.loggingEvent=a;this.levelName=a.level.name;this.formattedMessage=b}function q(a,b){this.name=a;this.initiallyExpanded=b}function D(){}var t=this,V=!1,B=!1,C=!1,J=!1,pa=[],S=!0,la=f++;g=x(g,this.defaults.initiallyMinimized);e=x(e,this.defaults.lazyInit);l=x(l,this.defaults.useDocumentWrite);var ia=this.defaults.newestMessageAtTop,ka=this.defaults.scrollToLatestMessage;m=m?m:this.defaults.width;n=n?n:this.defaults.height;
var ha=this.defaults.maxMessages,ua=this.defaults.showCommandLine,y=this.defaults.commandLineObjectExpansionDepth,H=this.defaults.showHideButton,va=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var A,F,K,z,M,R=b?"InPageAppender":"PopUpAppender",P=function(a){return B?(k(R+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0},N=function(){return C&&S&&!J};this.isNewestMessageAtTop=function(){return ia};this.setNewestMessageAtTop=function(a){ia=
!!a;N()&&z().setNewestAtTop(ia)};this.isScrollToLatestMessage=function(){return ka};this.setScrollToLatestMessage=function(a){ka=!!a;N()&&z().setScrollToLatest(ka)};this.getWidth=function(){return m};this.setWidth=function(a){P("width")&&(m=w(a,m))};this.getHeight=function(){return n};this.setHeight=function(a){P("height")&&(n=w(a,n))};this.getMaxMessages=function(){return ha};this.setMaxMessages=function(a){ha=G(a,ha);N()&&z().setMaxMessages(ha)};this.isShowCommandLine=function(){return ua};this.setShowCommandLine=
function(a){ua=!!a;N()&&z().setShowCommandLine(ua)};this.isShowHideButton=function(){return H};this.setShowHideButton=function(a){H=!!a;N()&&z().setShowHideButton(H)};this.isShowCloseButton=function(){return va};this.setShowCloseButton=function(a){va=!!a;N()&&z().setShowCloseButton(va)};this.getCommandLineObjectExpansionDepth=function(){return y};this.setCommandLineObjectExpansionDepth=function(a){y=G(a,y)};var W=g;this.isInitiallyMinimized=function(){return g};this.setInitiallyMinimized=function(a){P("initiallyMinimized")&&
(W=g=!!a)};this.isUseDocumentWrite=function(){return l};this.setUseDocumentWrite=function(a){P("useDocumentWrite")&&(l=!!a)};p.prototype.append=function(){z().log(this.levelName,this.formattedMessage)};q.prototype.append=function(){z().group(this.name,this.initiallyExpanded)};D.prototype.append=function(){z().groupEnd()};var U=function(){K();V?J&&xa&&F():A();K()&&aa()};this.append=function(a){if(S){var b=t.getLayout().formatWithException(a);pa.push(new p(a,b));U()}};this.group=function(a,b){S&&(pa.push(new q(a,
b)),U())};this.groupEnd=function(){S&&(pa.push(new D),U())};var aa=function(){for(;0<pa.length;)pa.shift().append();r&&z().focus()};this.setAddedToLogger=function(a){this.loggers.push(a);Q&&!e&&A()};this.clear=function(){N()&&z().clearLog();pa.length=0};this.focus=function(){N()&&z().focus()};this.focusCommandLine=function(){N()&&z().focusCommandLine()};this.focusSearch=function(){N()&&z().focusSearch()};var L=window;this.getCommandWindow=function(){return L};this.setCommandWindow=function(a){L=a};
this.executeLastCommand=function(){N()&&z().evalLastCommand()};var Y=new E("%m");this.getCommandLayout=function(){return Y};this.setCommandLayout=function(a){Y=a};this.evalCommandAndAppend=function(b){var c={appendResult:!0,isError:!1},d="";try{var f,e;!L.eval&&L.execScript&&L.execScript("null");var g={};e=0;for(len=ja.length;e<len;e++)g[ja[e][0]]=ja[e][1];var l=[],m=function(a){l.push([a,L[a]])};m("appender");L.appender=t;m("commandReturnValue");L.commandReturnValue=c;m("commandLineFunctionsHash");
L.commandLineFunctionsHash=g;g=function(a){m(a);L[a]=function(){return this.commandLineFunctionsHash[a](t,arguments,c)}};e=0;for(len=ja.length;e<len;e++)g(ja[e][0]);L===window&&L.execScript?(m("evalExpr"),m("result"),window.evalExpr=b,L.execScript("window.result=eval(window.evalExpr);"),f=window.result):f=L.eval(b);d=a(f)?f:ga(f,y);e=0;for(len=l.length;e<len;e++)L[l[e][0]]=l[e][1]}catch(La){d="Error evaluating command: "+h(La),c.isError=!0}c.appendResult&&(b=">>> "+b,a(d)||(b+="\r\n"+d),d=new qa(null,
new Date,c.isError?v.ERROR:v.INFO,[b],null),b=this.getLayout(),this.setLayout(Y),this.append(d),this.setLayout(b))};var ja=d.concat([]);this.addCommandLineFunction=function(a,b){ja.push([a,b])};this.storeCommandHistory=function(a){a=a.join(",");var b=void 0,b=b?"; path="+b:"";document.cookie=escape("log4javascriptCommandHistory")+"="+escape(a)+""+b};var Z=function(a){var b=['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',
"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\x3c!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work --\x3e",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;\x3c/script>','\x3c!--[if IE]><script type="text/javascript">isIe = true\x3c/script><![endif]--\x3e','\x3c!--[if lt IE 7]><script type="text/javascript">isIePre7 = true\x3c/script><![endif]--\x3e',
'<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}",
"this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",
'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',
"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",
'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}',
'GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",
'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',
"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}",
"this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}",
"this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",
'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}',
'LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}',
'LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',
"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}',
'this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',
"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",
'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}',
'logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',
"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}",
"var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}",
"matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",
'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}",
"var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}",
"return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}",
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}",
"displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}",
"var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",
'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}',
'function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}',
'function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}",
"searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}",
"return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',
"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+",
"preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}",
"logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}",
"var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}",
"setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',
"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}",
"this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}',
'currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}',
'addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}",
"function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}',
'function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}',
'if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',
"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}',
'function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}',
'function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}",
"function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}",
"currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}",
"return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-',
'($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}",
"this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}",
"return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}",
"return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',
"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',
"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}",
"currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]\x3e","\x3c/script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}",
"</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>',
'<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>',
'<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />',
'<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>',
'<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>',
'<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>',
'<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />',
'<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />',
'<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];a.open();for(var c=0,d=b.length;c<d;c++)a.writeln(b[c]);a.close()};this.setEventTypes(["load","unload"]);var fa=function(){var a=z();a.setAppender(t);a.setNewestAtTop(ia);a.setScrollToLatest(ka);a.setMaxMessages(ha);a.setShowCommandLine(ua);a.setShowHideButton(H);a.setShowCloseButton(va);a.setMainWindow(window);var b;a:{b=
escape("log4javascriptCommandHistory")+"=";for(var c=document.cookie.split(";"),d=0,f=c.length;d<f;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b)){b=unescape(e.substring(b.length,e.length));break a}}b=null}b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length);t.dispatchEvent("load",{win:a})};this.unload=function(){I.debug("unload "+this+", caller: "+this.unload.caller);J||(I.debug("really doing unload "+this),J=!0,B=C=!1,t.dispatchEvent("unload",
{}))};var da=function(a,b,c,d){var f=setInterval(function(){try{J&&clearInterval(f),a(z())&&(clearInterval(f),c())}catch(sa){clearInterval(f),S=!1,k(d,sa)}},b)},ea=function(){var a=document.domain!=location.hostname;if(l)a="";else{var b;a:{b=document.getElementsByTagName("script");for(var c=0,d=b.length;c<d;++c)if(-1!=b[c].src.indexOf("log4javascript")){d=b[c].src.lastIndexOf("/");b=-1==d?"":b[c].src.substr(0,d+1);break a}b=null}a=b+"console.html"+(a?"?log4javascript_domain="+escape(document.domain):
"")}return a};if(b){var X=null,ta=[];this.addCssProperty=function(a,b){P("cssProperties")&&ta.push([a,b])};var oa=!1,T,ra=Ba+"_InPageAppender_"+la;this.hide=function(){V&&B&&(N()&&z().$("command").blur(),T.style.display="none",W=!0)};this.show=function(){V&&(B?(T.style.display="block",this.setShowCommandLine(ua),W=!1):oa||F(!0))};this.isVisible=function(){return!W&&!J};this.close=function(a){J||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||
(T.parentNode.removeChild(T),this.unload())};M=function(){function a(){try{g||t.show(),fa(),C=!0,aa()}catch(Ka){S=!1,k("InPageAppender.open: unable to create console iframe",Ka)}}function b(){try{var b=function(a){return ba(a)};l&&Z(z().document);ba(z())?a():da(b,100,a,"InPageAppender.open: unable to create console iframe")}catch(sa){S=!1,k("InPageAppender.open: unable to create console iframe",sa)}}W=!1;T=X.appendChild(document.createElement("div"));T.style.width=m;T.style.height=n;T.style.border=
"solid gray 1px";for(var c=0,d=ta.length;c<d;c++)T.style[ta[c][0]]=ta[c][1];c=l?"":" src='"+ea()+"'";T.innerHTML="<iframe id='"+ra+"' name='"+ra+"' width='100%' height='100%' frameborder='0'"+c+" scrolling='no'></iframe>";J=!1;c=function(a){try{return!!a&&!!a.document}catch(sa){return!1}};c(z())?b():da(c,100,b,"InPageAppender.open: unable to create console iframe");B=!0};F=function(a){if(a||!g)a=function(){if(c)try{var a=document.getElementById(c);1==a.nodeType&&(X=a);M()}catch(Ja){k("InPageAppender.init: invalid container element '"+
c+"' supplied",Ja)}else X=document.createElement("div"),X.style.position="fixed",X.style.left="0",X.style.right="0",X.style.bottom="0",document.body.appendChild(X),t.addCssProperty("borderWidth","1px 0 0 0"),t.addCssProperty("zIndex",1E6),M()},wa&&c&&c.appendChild?(X=c,M()):wa?a():u.addEventListener("load",a),oa=!0};A=function(){F();V=!0};z=function(){var a=window.frames[ra];if(a)return a};K=function(){return S&&!J?(B&&!C&&z()&&ba(z())&&(C=!0),C):!1}}else{var ma=t.defaults.useOldPopUp,ya=t.defaults.complainAboutPopUpBlocking,
xa=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return ma};this.setUseOldPopUp=function(a){P("useOldPopUp")&&(ma=!!a)};this.isComplainAboutPopUpBlocking=function(){return ya};this.setComplainAboutPopUpBlocking=function(a){P("complainAboutPopUpBlocking")&&(ya=!!a)};this.isFocusPopUp=function(){return r};this.setFocusPopUp=function(a){r=!!a};this.isReopenWhenClosed=function(){return xa};this.setReopenWhenClosed=function(a){xa=!!a};this.close=function(){I.debug("close "+this);try{O.close(),
this.unload()}catch(Ma){}};this.hide=function(){I.debug("hide "+this);N()&&this.close()};this.show=function(){I.debug("show "+this);B||M()};this.isVisible=function(){return K()};var O;M=function(){function a(){z().setCloseIfOpenerCloses(!ma||!l);fa();C=!0;aa();da(f,500,e,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+m+",height="+n+",status,resizable",c="";try{var d=window.frameElement;d&&(c="_"+d.tagName+"_"+(d.name||d.id||""))}catch(Fa){c="_inaccessibleParentFrame"}c=
"PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+la+c;ma&&l||(c=c+"_"+Ba);var f=function(a){if(J)return!0;try{return!!a&&a.closed}catch(Na){}return!1},e=function(){J||t.unload()};try{O=window.open(ea(),c,b),J=!1,B=!0,O&&O.document?l&&ma&&ba(O)?(O.mainPageReloaded(),a()):(l&&Z(O.document),b=function(a){return!!a&&ba(a)},ba(O)?a():da(b,100,a,"PopUpAppender.init: unable to create console window")):(S=!1,I.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),ya&&k("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging."))}catch(Fa){k("PopUpAppender.init: error creating pop-up",
Fa)}};F=function(){g||M()};A=function(){F();V=!0};z=function(){return O};K=function(){if(S&&!a(O)&&!J){if(O.closed||C&&a(O.closed))return t.unload(),I.debug("PopUpAppender: pop-up closed"),!1;!C&&ba(O)&&(C=!0)}return S&&C&&!J}}this.getConsoleWindow=z};A.addGlobalCommandLineFunction=function(a,b){d.push([a,b])};b.prototype=new A;b.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,
scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0};b.prototype.toString=function(){return"PopUpAppender"};u.PopUpAppender=b;c.prototype=new A;c.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,
showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0};c.prototype.toString=function(){return"InPageAppender"};u.InPageAppender=c;u.InlineAppender=c})();(function(){function a(d,e,l,h,m){function n(a){a=a.style.cssText.split(";");for(var b="",c=0,d=a.length;c<d;c++){var b=a[c].split(":"),f=[];/^\s*$/.test(b[0])||f.push(g(b[0]).toLowerCase()+":"+g(b[1]));b=f.join(";")}return b}"string"!=typeof l&&(l="");h=!!h;m=!!m;var k;if("undefined"!=typeof e&&!e||d.nodeType==b.DOCUMENT_FRAGMENT_NODE){e=
"";m=0;for(k=d.childNodes.length;m<k;m++)e+=a(d.childNodes[m],!0,l+"  ");return e}switch(d.nodeType){case b.ELEMENT_NODE:var r=d.tagName.toLowerCase();e=(h?"\r\n"+l:"")+"<";m=d.prefix?d.prefix:d.outerHTML&&(new RegExp("<([^:]+):"+d.tagName+"[^>]*>","i")).test(d.outerHTML)?RegExp.$1.toLowerCase():"";(h=!!m)&&(e+=m+":");e+=r;m=0;for(k=d.attributes.length;m<k;m++){var q=d.attributes[m];q.specified&&null!==q.nodeValue&&"style"!==q.nodeName.toLowerCase()&&"string"===typeof q.nodeValue&&0!==q.nodeName.indexOf("_moz")&&
(e+=" "+q.nodeName.toLowerCase()+'="',e+=q.nodeValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),e+='"')}d.style.cssText&&""!==n(d)&&(e+=' style="'+n(d)+'"');if(t(f,r)||h&&!d.hasChildNodes())e+="/>";else{e+=">";h=!(1===d.childNodes.length&&d.childNodes[0].nodeType===b.TEXT_NODE);q=t(c,r);m=0;for(k=d.childNodes.length;m<k;m++)e+=a(d.childNodes[m],!0,l+"  ",h,q);d="</"+r+">";e+=h?"\r\n"+l+d:d}return e;case b.TEXT_NODE:if(d.nodeType==b.TEXT_NODE&&/^[ \t\r\n]*$/.test(d.nodeValue))e=
"";else{if(m)e=d.nodeValue;else{d=p(g(d.nodeValue));e=[];m=0;for(k=d.length;m<k;m++)e[m]=g(d[m]);e=e.join("\r\n"+l)}h&&(e="\r\n"+l+e)}return e;case b.CDATA_SECTION_NODE:return"<![CDATA["+d.nodeValue+"]]\x3e\r\n";case b.DOCUMENT_NODE:e="";m=0;for(k=d.childNodes.length;m<k;m++)e+=a(d.childNodes[m],!0,l);return e;default:return""}}var b={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,
DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},c=["script","pre"],f="br img hr param link area input col base meta".split(" ");(function(){A.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])});A.addGlobalCommandLineFunction("dir",function(a,b,c){a=[];c=0;for(var f=b.length;c<f;c++){var g=c,l;l=void 0;var h=b[c],m=0;for(l in h)m=Math.max(d(l).length,m);var n=[];for(l in h){var k="  "+W(d(l),m+2),r;try{r=p(d(h[l])).join(W("\r\n",m+6))}catch(ca){r=
"[Error obtaining property. Details: "+e(ca)+"]"}n.push(k+r)}l=n.join("\r\n");a[g]=l}return a.join("\r\n\r\n")});A.addGlobalCommandLineFunction("dirxml",function(b,c,d){b=[];d=0;for(var f=c.length;d<f;d++)b[d]=a(c[d]);return b.join("\r\n\r\n")});A.addGlobalCommandLineFunction("cd",function(a,b,c){var d;0===b.length||""===b[0]?(d=window,b="Command line set to run in main window"):b[0].window==b[0]?(d=b[0],b="Command line set to run in frame '"+b[0].name+"'"):(d=window.frames[b[0]])?b="Command line set to run in frame '"+
b[0]+"'":(c.isError=!0,b="Frame '"+b[0]+"' does not exist",d=a.getCommandWindow());a.setCommandWindow(d);return b});A.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1;a.clear()});A.addGlobalCommandLineFunction("keys",function(a,b,c){a=[];for(var d in b[0])a.push(d);return a});A.addGlobalCommandLineFunction("values",function(a,b,c){a=[];for(var d in b[0])try{a.push(b[0][d])}catch(ia){I.warn("values(): Unable to obtain value for key "+d+". Details: "+e(ia))}return a});A.addGlobalCommandLineFunction("expansionDepth",
function(a,b,c){var d=parseInt(b[0],10);if(isNaN(d)||0>d)return c.isError=!0,""+b[0]+" is not a valid expansion depth";a.setCommandLineObjectExpansionDepth(d);return"Object expansion depth set to "+d})})()})();u.setDocumentReady=function(){wa=!0;u.dispatchEvent("load",{})};if(window.addEventListener)window.addEventListener("load",u.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",u.setDocumentReady);else{var Ga=window.onload;window.onload="function"!=typeof window.onload?
u.setDocumentReady:function(a){Ga&&Ga(a);u.setDocumentReady()}}return u},this);
!function(){var a={},c=null,b=!0,d=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!=typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"==typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){if(a=parseFloat(a),0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var d=0;d<this._howls[c]._audioNode.length;d++)this._howls[c]._audioNode[d].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var d=c.createBuffer(1,1,22050),f=c.createBufferSource();f.buffer=d;f.connect(c.destination);"undefined"==typeof f.start?
f.noteOn(0):f.start(0);setTimeout(function(){f.playbackState!==f.PLAYING_STATE&&f.playbackState!==f.FINISHED_STATE||(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1))},0)};return window.addEventListener("touchend",b,!1),a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!=typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};if(t.prototype={load:function(){var a=this,b=null;if(d)return void a.on("loaderror",Error("No audio support."));for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else{if(g=a._urls[c],e=/^data:audio\/([^;,]+);/i.exec(g),e||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),!e)return void a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
e=e[1].toLowerCase()}if(p[e]){b=a._urls[c];break}}if(!b)return void a.on("loaderror",Error("No codec support for selected audio sources."));if(a._src=b,a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a},urls:function(a){return a?(this.stop(),this._urls="string"==typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var d=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(f){f._sprite=a;var e=
0<f._pos?f._pos:d._sprite[a][0]/1E3,g=0;d._webAudio?(g=d._sprite[a][1]/1E3-f._pos,0<f._pos&&(e=d._sprite[a][0]/1E3+e)):g=d._sprite[a][1]/1E3-(e-d._sprite[a][0]/1E3);var l,h=!(!d._loop&&!d._sprite[a][2]),m="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){l=setTimeout(function(){!d._webAudio&&h&&d.stop(m).play(a,m);d._webAudio&&!h&&(d._nodeById(m).paused=!0,d._nodeById(m)._pos=0,d._clearEndTimer(m));d._webAudio||h||d.stop(m);d.on("end",m)},g/d._rate*1E3);d._onendTimer.push({timer:l,
id:m})}(),d._webAudio){var n=d._sprite[a][0]/1E3,p=d._sprite[a][1]/1E3;f.id=m;f.paused=!1;k(d,[h,n,p],m);d._playStart=c.currentTime;f.gain.value=d._volume;"undefined"==typeof f.bufferSource.start?h?f.bufferSource.noteGrainOn(0,e,86400):f.bufferSource.noteGrainOn(0,e,g):h?f.bufferSource.start(0,e,86400):f.bufferSource.start(0,e,g)}else{if(4!==f.readyState&&(f.readyState||!navigator.isCocoonJS))return d._clearEndTimer(m),function(){var c=a,e=b,g=function(){d.play(c,e);f.removeEventListener("canplaythrough",
g,!1)};f.addEventListener("canplaythrough",g,!1)}(),d;f.readyState=4;f.id=m;f.currentTime=e;f.muted=q._muted||f.muted;f.volume=d._volume*q.volume();setTimeout(function(){f.play()},0)}return d.on("play"),"function"==typeof b&&b(m),d}),d):("function"==typeof b&&b(),d):(d.on("load",function(){d.play(a,b)}),d)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||
c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),
c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),0<=a&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*q.volume()),c}return c._volume},loop:function(a){return"boolean"==typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"==typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return 0<=a?(d.pause(b),
e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(0<=a)return d;for(e=0;e<d._audioNode.length;e++)if(d._audioNode[e].paused&&4===d._audioNode[e].readyState)return d._webAudio?d._audioNode[e]._pos:d._audioNode[e].currentTime},pos3d:function(a,b,c,d){var e=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(0<=a||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):
e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}return e},fade:function(a,b,c,d,e){var f=this,g=a>b?"down":"up",h=Math.abs(a-b)/.01,l=c/h;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var m=1;h>=m;m++)!function(){var a=Math.round(1E3*(f._volume+("up"===g?.01:-.01)*m))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},l*m)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,
b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c();e.pause(d);e.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}return this._drainPool(),a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}if(this._drainPool(),!b){var d;if(this._webAudio)d=this._setupAudioNode(),a(d);else{this.load();d=this._audioNode[this._audioNode.length-1];var e=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",f=function(){d.removeEventListener(e,f,!1);a(d)};d.addEventListener(e,f,!1)}}},_drainPool:function(){var a,b=0;for(a=0;a<this._audioNode.length;a++)this._audioNode[a].paused&&b++;for(a=this._audioNode.length-1;0<=a&&!(5>=b);a--)this._audioNode[a].paused&&
(this._webAudio&&this._audioNode[a].disconnect(0),b--,this._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}(a=this._onendTimer[b])&&(clearTimeout(a.timer),this._onendTimer.splice(b,1))},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;return a[b]="undefined"==typeof c.createGain?c.createGainNode():c.createGain(),a[b].gain.value=this._volume,a[b].paused=!0,a[b]._pos=0,a[b].readyState=
4,a[b].connect(e),a[b].panner=c.createPanner(),a[b].panner.panningModel=this._model||"equalpower",a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]),a[b].panner.connect(a[b]),a[b]},on:function(a,b){var c=this["_on"+a];if("function"==typeof b)c.push(b);else for(var d=0;d<c.length;d++)b?c[d].call(this,b):c[d].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var d=0;d<c.length;d++){if(b===c[d]){c.splice(d,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}},b)var x=function(b,c){if(c in a)return b._duration=a[c].duration,void G(b);if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=
d.charCodeAt(f);w(e.buffer,b,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){w(g.response,b,c)};g.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{g.send()}catch(H){g.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!=typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!=typeof window&&(window.Howler=q,window.Howl=t)}();jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,c,b,d,e){return jQuery.easing[jQuery.easing.def](a,c,b,d,e)},easeInQuad:function(a,c,b,d,e){return d*(c/=e)*c+b},easeOutQuad:function(a,c,b,d,e){return-d*(c/=e)*(c-2)+b},easeInOutQuad:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c+b:-d/2*(--c*(c-2)-1)+b},easeInCubic:function(a,c,b,d,e){return d*(c/=e)*c*c+b},easeOutCubic:function(a,c,b,d,e){return d*((c=c/e-1)*c*c+1)+b},easeInOutCubic:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c+b:
d/2*((c-=2)*c*c+2)+b},easeInQuart:function(a,c,b,d,e){return d*(c/=e)*c*c*c+b},easeOutQuart:function(a,c,b,d,e){return-d*((c=c/e-1)*c*c*c-1)+b},easeInOutQuart:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c+b:-d/2*((c-=2)*c*c*c-2)+b},easeInQuint:function(a,c,b,d,e){return d*(c/=e)*c*c*c*c+b},easeOutQuint:function(a,c,b,d,e){return d*((c=c/e-1)*c*c*c*c+1)+b},easeInOutQuint:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c*c+b:d/2*((c-=2)*c*c*c*c+2)+b},easeInSine:function(a,c,b,d,e){return-d*Math.cos(c/
e*(Math.PI/2))+d+b},easeOutSine:function(a,c,b,d,e){return d*Math.sin(c/e*(Math.PI/2))+b},easeInOutSine:function(a,c,b,d,e){return-d/2*(Math.cos(Math.PI*c/e)-1)+b},easeInExpo:function(a,c,b,d,e){return 0==c?b:d*Math.pow(2,10*(c/e-1))+b},easeOutExpo:function(a,c,b,d,e){return c==e?b+d:d*(-Math.pow(2,-10*c/e)+1)+b},easeInOutExpo:function(a,c,b,d,e){return 0==c?b:c==e?b+d:1>(c/=e/2)?d/2*Math.pow(2,10*(c-1))+b:d/2*(-Math.pow(2,-10*--c)+2)+b},easeInCirc:function(a,c,b,d,e){return-d*(Math.sqrt(1-(c/=e)*
c)-1)+b},easeOutCirc:function(a,c,b,d,e){return d*Math.sqrt(1-(c=c/e-1)*c)+b},easeInOutCirc:function(a,c,b,d,e){return 1>(c/=e/2)?-d/2*(Math.sqrt(1-c*c)-1)+b:d/2*(Math.sqrt(1-(c-=2)*c)+1)+b},easeInElastic:function(a,c,b,d,e){a=0;var h=d;if(0==c)return b;if(1==(c/=e))return b+d;a||(a=.3*e);h<Math.abs(d)?(h=d,d=a/4):d=a/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*--c)*Math.sin(2*(c*e-d)*Math.PI/a))+b},easeOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(1==(c/=e))return b+d;h||
(h=.3*e);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*c)*Math.sin(2*(c*e-a)*Math.PI/h)+d+b},easeInOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(2==(c/=e/2))return b+d;h||(h=.3*e*1.5);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return 1>c?-.5*g*Math.pow(2,10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)+b:g*Math.pow(2,-10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)*.5+d+b},easeInBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*(c/=e)*c*((h+1)*
c-h)+b},easeOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*((c=c/e-1)*c*((h+1)*c+h)+1)+b},easeInOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return 1>(c/=e/2)?d/2*c*c*(((h*=1.525)+1)*c-h)+b:d/2*((c-=2)*c*(((h*=1.525)+1)*c+h)+2)+b},easeInBounce:function(a,c,b,d,e){return d-jQuery.easing.easeOutBounce(a,e-c,0,d,e)+b},easeOutBounce:function(a,c,b,d,e){return(c/=e)<1/2.75?7.5625*d*c*c+b:c<2/2.75?d*(7.5625*(c-=1.5/2.75)*c+.75)+b:c<2.5/2.75?d*(7.5625*(c-=2.25/2.75)*c+.9375)+b:d*(7.5625*
(c-=2.625/2.75)*c+.984375)+b},easeInOutBounce:function(a,c,b,d,e){return c<e/2?.5*jQuery.easing.easeInBounce(a,2*c,0,d,e)+b:.5*jQuery.easing.easeOutBounce(a,2*c-e,0,d,e)+.5*d+b}});
(function(a){a.jqPagination=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$input=d.$el.find("input");d.$el.data("jqPagination",d);d.init=function(){d.options=a.extend({},a.jqPagination.defaultOptions,b);null===d.options.max_page&&(void 0!==d.$input.data("max-page")?d.options.max_page=d.$input.data("max-page"):d.options.max_page=1);void 0!==d.$input.data("current-page")&&d.isNumber(d.$input.data("current-page"))&&(d.options.current_page=d.$input.data("current-page"));d.$input.removeAttr("readonly");
d.updateInput(!0);d.$input.on("focus.jqPagination mouseup.jqPagination",function(b){if("focus"===b.type){var c=parseInt(d.options.current_page,10);a(this).val(c).select()}if("mouseup"===b.type)return!1});d.$input.on("blur.jqPagination keydown.jqPagination",function(b){var c=a(this),e=parseInt(d.options.current_page,10);27===b.keyCode&&(c.val(e),c.blur());13===b.keyCode&&c.blur();"blur"===b.type&&d.setPage(c.val())});d.$el.on("click.jqPagination","a",function(b){var c=a(this);if(c.hasClass("disabled"))return!1;
b.metaKey||b.ctrlKey||(b.preventDefault(),d.setPage(c.data("action")))})};d.setPage=function(a,b){if(void 0===a)return d.options.current_page;var c=parseInt(d.options.current_page,10),e=parseInt(d.options.max_page,10);if(isNaN(parseInt(a,10)))switch(a){case "first":a=1;break;case "prev":case "previous":a=c-1;break;case "next":a=c+1;break;case "last":a=e}a=parseInt(a,10);if(isNaN(a)||1>a||a>e)return d.setInputValue(c),!1;d.options.current_page=a;d.$input.data("current-page",a);d.updateInput(b)};d.setMaxPage=
function(a,b){if(void 0===a)return d.options.max_page;if(!d.isNumber(a))return console.error("jqPagination: max_page is not a number"),!1;if(a<d.options.current_page)return console.error("jqPagination: max_page lower than current_page"),!1;d.options.max_page=a;d.$input.data("max-page",a);d.updateInput(b)};d.updateInput=function(a){var b=parseInt(d.options.current_page,10);d.setInputValue(b);d.setLinks(b);!0!==a&&d.options.paged(b)};d.setInputValue=function(a){var b=d.options.page_string,c=d.options.max_page,
b=b.replace("{current_page}",a).replace("{max_page}",c);d.$input.val(b)};d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.setLinks=function(a){a=d.options.link_string;var b=parseInt(d.options.current_page,10),c=parseInt(d.options.max_page,10);if(""!==a){var e=b-1;1>e&&(e=1);var q=b+1;q>c&&(q=c);d.$el.find("a.first").attr("href",a.replace("{page_number}","1"));d.$el.find("a.prev, a.previous").attr("href",a.replace("{page_number}",e));d.$el.find("a.next").attr("href",a.replace("{page_number}",
q));d.$el.find("a.last").attr("href",a.replace("{page_number}",c))}d.$el.find("a").removeClass("disabled");b===c&&d.$el.find(".next, .last").addClass("disabled");1===b&&d.$el.find(".previous, .first").addClass("disabled")};d.callMethod=function(b,c,g){switch(b.toLowerCase()){case "option":if(void 0===g&&"object"!==typeof c)return d.options[c];b={trigger:!0};var e=!1;a.isPlainObject(c)&&!g?a.extend(b,c):b[c]=g;g=!1===b.trigger;void 0!==b.current_page&&(e=d.setPage(b.current_page,g));void 0!==b.max_page&&
(e=d.setMaxPage(b.max_page,g));!1===e&&console.error("jqPagination: cannot get / set option "+c);return e;case "destroy":d.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+b+'" does not exist'),!1}};d.init()};a.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}};a.fn.jqPagination=function(){var c=a(this),b=Array.prototype.slice.call(arguments),
d=!1;if("string"===typeof b[0])return void 0===b[2]?d=c.first().data("jqPagination").callMethod(b[0],b[1]):c.each(function(){d=a(this).data("jqPagination").callMethod(b[0],b[1],b[2])}),d;this.each(function(){new a.jqPagination(this,b[0])})}})(jQuery);console||(console={},func=function(){return!1},console.log=func,console.info=func,console.warn=func,console.error=func);
CryptoJS=CryptoJS||function(a,c){var b={},d=b.lib={},e=function(){},h=d.Base={extend:function(a){e.prototype=this;var b=new e;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
g=d.WordArray=h.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=c?b:4*a.length},toString:function(a){return(a||q).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-
c%4*8;b.length=a.ceil(c/4)},clone:function(){var a=h.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),p=b.enc={},q=p.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new g.init(c,b/2)}},t=p.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new g.init(c,b)}},x=p.Utf8={stringify:function(a){try{return decodeURIComponent(escape(t.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return t.parse(unescape(encodeURIComponent(a)))}},
w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,h=this.blockSize,k=e/(4*h),k=b?a.ceil(k):a.max((k|0)-this._minBufferSize,0);b=k*h;e=a.min(4*b,e);if(b){for(var p=0;p<b;p+=h)this._doProcessBlock(d,p);p=d.splice(0,b);c.sigBytes-=e}return new g.init(p,e)},clone:function(){var a=h.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new G.HMAC.init(a,
c)).finalize(b)}}});var G=b.algo={};return b}(Math);
(function(){var a=CryptoJS,c=a.lib,b=c.WordArray,d=c.Hasher,e=[],c=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],g=c[1],h=c[2],w=c[3],G=c[4],k=0;80>k;k++){if(16>k)e[k]=a[b+k]|0;else{var f=e[k-3]^e[k-8]^e[k-14]^e[k-16];e[k]=f<<1|f>>>31}f=(d<<5|d>>>27)+G+e[k];f=20>k?f+((g&h|~g&w)+1518500249):40>k?f+((g^h^w)+1859775393):60>k?f+((g&h|g&w|h&w)-1894007588):f+((g^h^
w)-899497514);G=w;w=h;h=g<<30|g>>>2;g=d;d=f}c[0]=c[0]+d|0;c[1]=c[1]+g|0;c[2]=c[2]+h|0;c[3]=c[3]+w|0;c[4]=c[4]+G|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(c);a.HmacSHA1=d._createHmacHelper(c)})();
(function(){var a=CryptoJS,c=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,d){a=this._hasher=new a.init;"string"==typeof d&&(d=c.parse(d));var b=a.blockSize,h=4*b;d.sigBytes>h&&(d=a.finalize(d));d.clamp();for(var g=this._oKey=d.clone(),p=this._iKey=d.clone(),q=g.words,t=p.words,x=0;x<b;x++)q[x]^=1549556828,t[x]^=909522486;g.sigBytes=p.sigBytes=h;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=
this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();
(function(a){for(var c,b,d=document.getElementsByTagName("head")[0].style,e=["transformProperty","WebkitTransform","OTransform","msTransform","MozTransform"],h=0;h<e.length;h++)void 0!==d[e[h]]&&(c=e[h]);c&&(b=c.replace(/[tT]ransform/,"TransformOrigin"),"T"==b[0]&&(b[0]="t"));eval('IE = "v"=="\v"');jQuery.fn.extend({rotate:function(b){if(0!==this.length&&"undefined"!=typeof b){"number"==typeof b&&(b={angle:b});for(var c=[],d=0,e=this.length;d<e;d++){var g=this.get(d);if(g.Wilq32&&g.Wilq32.PhotoEffect)g.Wilq32.PhotoEffect._handleRotation(b);
else{var h=a.extend(!0,{},b),g=(new Wilq32.PhotoEffect(g,h))._rootObj;c.push(a(g))}}return c}},getRotateAngle:function(){for(var a=[],b=0,c=this.length;b<c;b++){var d=this.get(b);d.Wilq32&&d.Wilq32.PhotoEffect&&(a[b]=d.Wilq32.PhotoEffect._angle)}return a},stopRotate:function(){for(var a=0,b=this.length;a<b;a++){var c=this.get(a);c.Wilq32&&c.Wilq32.PhotoEffect&&clearTimeout(c.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return c?function(a,b){a.Wilq32={PhotoEffect:this};
this._img=this._rootObj=this._eventObj=a;this._handleRotation(b)}:function(a,b){this._img=a;this._onLoadDelegate=[b];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};a.parentNode.insertBefore(this._rootObj,a);if(a.complete)this._Loader();else{var c=this;jQuery(this._img).bind("load",function(){c._Loader()})}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(a){this._parameters=this._parameters||{};"number"!==
typeof this._angle&&(this._angle=0);"number"===typeof a.angle&&(this._angle=a.angle);this._parameters.animateTo="number"===typeof a.animateTo?a.animateTo:this._angle;this._parameters.step=a.step||this._parameters.step||null;this._parameters.easing=a.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration="duration"in a?a.duration:a.duration||this._parameters.duration||1E3;this._parameters.callback=a.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=
a.center||this._parameters.center||["50%","50%"];this._rotationCenterX="string"==typeof this._parameters.center[0]?parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._parameters.center[0];this._rotationCenterY="string"==typeof this._parameters.center[1]?parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._parameters.center[1];a.bind&&a.bind!=this._parameters.bind&&this._BindEvents(a.bind)},_emptyFunction:function(){},_defaultEasing:function(a,
b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},_handleRotation:function(a,b){c||this._img.complete||b?(this._setupParameters(a),this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()):this._onLoadDelegate.push(a)},_BindEvents:function(a){if(a&&this._eventObj){if(this._parameters.bind){var b=this._parameters.bind,c;for(c in b)b.hasOwnProperty(c)&&jQuery(this._eventObj).unbind(c,b[c])}this._parameters.bind=a;for(c in a)a.hasOwnProperty(c)&&jQuery(this._eventObj).bind(c,a[c])}},
_Loader:function(){return IE?function(){var a=this._img.width,b=this._img.height;this._imgWidth=a;this._imgHeight=b;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=b+"px";this._vimage.style.width=a+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=a;this._container.style.height=
b;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",a-1+","+(b-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=a+"px";this._rootObj.style.height=b+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;for(this._eventObj=this._rootObj;a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var a=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*a;this._height=3*a;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement("canvas");
this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;for(this._cnv=this._canvas.getContext("2d");a=this._onLoadDelegate.shift();)this._handleRotation(a,
!0)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var a=+new Date,b=a-this._animateStartTime>this._parameters.duration;if(b&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img)a=this._parameters.easing(0,a-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration),
this._rotate(~~(10*a)/10);this._parameters.step&&this._parameters.step(this._angle);var c=this;this._timer=setTimeout(function(){c._animate.call(c)},10)}this._parameters.callback&&b&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var a=Math.PI/180;return IE?function(a){this._angle=a;this._container.style.rotation=a%360+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=
-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:c?function(a){this._angle=a;this._img.style[c]="rotate("+a%360+"deg)";this._img.style[b]=this._parameters.center.join(" ")}:function(b){this._angle=b;b=b%360*a;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,
this._rotationCenterY);this._cnv.rotate(b);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(g){return function(a){return document.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())})(jQuery);
(function(a){a.fn.flexVerticalCenter=function(c){var b=a.extend({cssAttribute:"margin-top",verticalOffset:0,parentSelector:null,debounceTimeout:25,deferTilWindowLoad:!1},c||{});return this.each(function(){var c=a(this),e,h=function(){var a=b.parentSelector&&c.parents(b.parentSelector).length?c.parents(b.parentSelector).first().height():c.parent().height();c.css(b.cssAttribute,(a-c.height())/2+parseInt(b.verticalOffset));void 0!==b.complete&&b.complete()};a(window).resize(function(){clearTimeout(e);
e=setTimeout(h,b.debounceTimeout)});b.deferTilWindowLoad||h();a(window).load(function(){h()})})}})(jQuery);
(function(a){var c;try{c="string"==typeof a("body").css("background-position-x")}catch(b){c=!1}a._spritely={instances:{},animate:function(b){var c=a(b.el),e=c.attr("id");if(!a._spritely.instances[e])return this;b=a.extend(b,a._spritely.instances[e]||{});if("sprite"==b.type&&b.fps){b.play_frames&&!a._spritely.instances[e].remaining_frames?a._spritely.instances[e].remaining_frames=b.play_frames+1:b.do_once&&!a._spritely.instances[e].remaining_frames&&(a._spritely.instances[e].remaining_frames=b.no_of_frames);
var h,g=function(c){var d=b.width;if(!h){h=[];for(var g=total=0;g<b.no_of_frames;g++)h[h.length]=0-total,total+=d}if(0==a._spritely.instances[e].current_frame){if(b.on_first_frame)b.on_first_frame(c)}else if(a._spritely.instances[e].current_frame==h.length-1&&b.on_last_frame)b.on_last_frame(c);if(b.on_frame&&b.on_frame[a._spritely.instances[e].current_frame])b.on_frame[a._spritely.instances[e].current_frame](c);a._spritely.instances[e].current_frame=1==b.rewind?0>=a._spritely.instances[e].current_frame?
h.length-1:a._spritely.instances[e].current_frame-1:a._spritely.instances[e].current_frame>=h.length-1?0:a._spritely.instances[e].current_frame+1;d=a._spritely.getBgY(c);c.css("background-position",h[a._spritely.instances[e].current_frame]+"px "+d);if(b.bounce&&0<b.bounce[0]&&0<b.bounce[1]){var d=b.bounce[0],g=b.bounce[1],p=b.bounce[2];c.animate({top:"+="+d+"px",left:"-="+g+"px"},p).animate({top:"-="+d+"px",left:"+="+g+"px"},p)}};if(a._spritely.instances[e].remaining_frames&&0<a._spritely.instances[e].remaining_frames){a._spritely.instances[e].remaining_frames--;
if(0==a._spritely.instances[e].remaining_frames)return a._spritely.instances[e].remaining_frames=-1,delete a._spritely.instances[e].remaining_frames,this;g(c)}else-1!=a._spritely.instances[e].remaining_frames&&g(c)}else if("pan"==b.type&&!a._spritely.instances[e]._stopped){var g=b.speed||1,p=a._spritely.instances[e].l||parseInt(a._spritely.getBgX(c).replace("px",""),10)||0,q=a._spritely.instances[e].t||parseInt(a._spritely.getBgY(c).replace("px",""),10)||0;if(b.do_once&&!a._spritely.instances[e].remaining_frames||
0>=a._spritely.instances[e].remaining_frames){switch(b.dir){case "up":case "down":a._spritely.instances[e].remaining_frames=Math.floor((b.img_height||0)/g);break;case "left":case "right":a._spritely.instances[e].remaining_frames=Math.floor((b.img_width||0)/g)}a._spritely.instances[e].remaining_frames++}else b.do_once&&a._spritely.instances[e].remaining_frames--;switch(b.dir){case "up":g*=-1;case "down":a._spritely.instances[e].l||(a._spritely.instances[e].l=p);a._spritely.instances[e].t=q+g;b.img_height&&
(a._spritely.instances[e].t%=b.img_height);break;case "left":g*=-1;case "right":a._spritely.instances[e].t||(a._spritely.instances[e].t=q),a._spritely.instances[e].l=p+g,b.img_width&&(a._spritely.instances[e].l%=b.img_width)}g=a._spritely.instances[e].l.toString();g=-1==g.indexOf("%")?g+"px ":g+" ";p=a._spritely.instances[e].t.toString();p=-1==p.indexOf("%")?p+"px ":p+" ";a(c).css("background-position",g+p);if(b.do_once&&!a._spritely.instances[e].remaining_frames)return this}a._spritely.instances[e].options=
b;a._spritely.instances[e].timeout=window.setTimeout(function(){a._spritely.animate(b)},parseInt(1E3/b.fps))},randomIntBetween:function(a,c){return parseInt(rand_no=Math.floor((c-(a-1))*Math.random())+a)},getBgUseXY:c,getBgY:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-y")||"0":(a(b).css("background-position")||" ").split(" ")[1]},getBgX:function(b){return a._spritely.getBgUseXY?a(b).css("background-position-x")||"0":(a(b).css("background-position")||" ").split(" ")[0]},
get_rel_pos:function(a,c){var b=a;if(0>a)for(;0>b;)b+=c;else for(;b>c;)b-=c;return b},_spStrip:function(a,c){for(;a.length;){var b,d,g=!1,p=!1;for(b=0;b<c.length;b++){var q=a.slice(0,1);d=a.slice(1);-1<c.indexOf(q)?a=d:g=!0}for(b=0;b<c.length;b++)q=a.slice(-1),d=a.slice(0,-1),-1<c.indexOf(q)?a=d:p=!0;if(g&&p)return a}return""}};a.fn.extend({spritely:function(b){var c=a(this),e=c.attr("id");b=a.extend({type:"sprite",do_once:!1,width:null,height:null,img_width:0,img_height:0,fps:12,no_of_frames:2,play_frames:0},
b||{});var h=new Image,g=a._spritely._spStrip(c.css("background-image")||"",'url("); ');a._spritely.instances[e]||(a._spritely.instances[e]=b.start_at_frame?{current_frame:b.start_at_frame-1}:{current_frame:-1});a._spritely.instances[e].type=b.type;a._spritely.instances[e].depth=b.depth;b.el=c;b.width=b.width||c.width()||100;b.height=b.height||c.height()||100;h.onload=function(){b.img_width=h.width;b.img_height=h.height;b.img=h;b.do_once?setTimeout(function(){a._spritely.animate(b)},0):setTimeout(function(){a._spritely.animate(b)},
parseInt(1E3/b.fps))};h.src=g;return this},sprite:function(b){b=a.extend({type:"sprite",bounce:[0,0,1E3]},b||{});return a(this).spritely(b)},pan:function(b){b=a.extend({type:"pan",dir:"left",continuous:!0,speed:1},b||{});return a(this).spritely(b)},flyToTap:function(b){b=a.extend({el_to_move:null,type:"moveToTap",ms:1E3,do_once:!0},b||{});b.el_to_move&&a(b.el_to_move).active();a._spritely.activeSprite&&(window.Touch?a(this)[0].ontouchstart=function(b){var c=a._spritely.activeSprite,d=b.touches[0];
b=d.pageY-c.height()/2;d=d.pageX-c.width()/2;c.animate({top:b+"px",left:d+"px"},1E3)}:a(this).click(function(b){var c=a._spritely.activeSprite;a(c).stop(!0);var d=c.width(),g=c.height();c.animate({top:b.pageY-g/2+"px",left:b.pageX-d/2+"px"},1E3)}));return this},isDraggable:function(b){if(!a(this).draggable)return this;b=a.extend({type:"isDraggable",start:null,stop:null,drag:null},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;a._spritely.instances[c].isDraggableOptions=b;
a(this).draggable({start:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!0;a(this).stop(!0);a._spritely.instances[b].isDraggableOptions.start&&a._spritely.instances[b].isDraggableOptions.start(this)},drag:b.drag,stop:function(){var b=a(this).attr("id");a._spritely.instances[b].stop_random=!1;a._spritely.instances[b].isDraggableOptions.stop&&a._spritely.instances[b].isDraggableOptions.stop(this)}});return this},active:function(){a._spritely.activeSprite=this;return this},
activeOnClick:function(){var b=a(this);window.Touch?b[0].ontouchstart=function(c){a._spritely.activeSprite=b}:b.click(function(c){a._spritely.activeSprite=b});return this},spRandom:function(b){b=a.extend({top:50,left:50,right:290,bottom:320,speed:4E3,pause:0},b||{});var c=a(this).attr("id");if(!a._spritely.instances[c])return this;if(!a._spritely.instances[c].stop_random){var e=a._spritely.randomIntBetween,h=e(b.top,b.bottom),e=e(b.left,b.right);a("#"+c).animate({top:h+"px",left:e+"px"},b.speed)}window.setTimeout(function(){a("#"+
c).spRandom(b)},b.speed+b.pause);return this},makeAbsolute:function(){return this.each(function(){var b=a(this),c=b.position();b.css({position:"absolute",marginLeft:0,marginTop:0,top:c.top,left:c.left}).remove().appendTo("body")})},spSet:function(b,c){var d=a(this).attr("id");a._spritely.instances[d][b]=c;return this},spGet:function(b,c){var d=a(this).attr("id");return a._spritely.instances[d][b]},spStop:function(b){this.each(function(){var c=a(this),e=c.attr("id");a._spritely.instances[e].options.fps&&
(a._spritely.instances[e]._last_fps=a._spritely.instances[e].options.fps);"sprite"==a._spritely.instances[e].type&&c.spSet("fps",0);a._spritely.instances[e]._stopped=!0;if(a._spritely.instances[e]._stopped_f1=b)e=a._spritely.getBgY(a(this)),c.css("background-position","0 "+e)});return this},spStart:function(){a(this).each(function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._last_fps||12;"sprite"==a._spritely.instances[b].type&&a(this).spSet("fps",c);a._spritely.instances[b]._stopped=!1});
return this},spToggle:function(){var b=a(this).attr("id"),c=a._spritely.instances[b]._stopped_f1||!1;a._spritely.instances[b]._stopped?a(this).spStart():a(this).spStop(c);return this},fps:function(b){a(this).each(function(){a(this).spSet("fps",b)});return this},goToFrame:function(b){var c=a(this).attr("id");a._spritely.instances&&a._spritely.instances[c]&&(a._spritely.instances[c].current_frame=b-1);return this},spSpeed:function(b){a(this).each(function(){a(this).spSet("speed",b)});return this},spRelSpeed:function(b){a(this).each(function(){var c=
a(this).spGet("depth")/100;a(this).spSet("speed",b*c)});return this},spChangeDir:function(b){a(this).each(function(){a(this).spSet("dir",b)});return this},spState:function(b){a(this).each(function(){var c=(b-1)*a(this).height()+"px",c=a._spritely.getBgX(a(this))+" -"+c;a(this).css("background-position",c)});return this},lockTo:function(b,c){a(this).each(function(){var d=a(this).attr("id");if(!a._spritely.instances[d])return this;a._spritely.instances[d].locked_el=a(this);a._spritely.instances[d].lock_to=
a(b);a._spritely.instances[d].lock_to_options=c;a._spritely.instances[d].interval=window.setInterval(function(){if(a._spritely.instances[d].lock_to){var b=a._spritely.instances[d].locked_el,c=a._spritely.instances[d].lock_to,e=a._spritely.instances[d].lock_to_options,q=e.bg_img_width;c.height();var t=a._spritely.getBgY(c),c=a._spritely.getBgX(c),c=parseInt(c)+parseInt(e.left),e=parseInt(t)+parseInt(e.top),c=a._spritely.get_rel_pos(c,q);a(b).css({top:e+"px",left:c+"px"})}},c.interval||20)});return this},
destroy:function(){a(this);var b=a(this).attr("id");a._spritely.instances[b]&&a._spritely.instances[b].timeout&&window.clearTimeout(a._spritely.instances[b].timeout);a._spritely.instances[b]&&a._spritely.instances[b].interval&&window.clearInterval(a._spritely.instances[b].interval);delete a._spritely.instances[b];return this}})})(jQuery);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}
function soundinit(){vlg.sfx={};vlg.music={};vlg.muted=!1;vlg.isSFXOn=!0;vlg.isMusicOn=!0;(function(a){Howl.prototype.play=function(c,b){"SFX"===this.audioType&&!vlg.isSFXOn||"MUSIC"===this.audioType&&!vlg.isMusicOn||a.call(this,c,b);return this}})(Howl.prototype.play);void 0!==GameConfig.config.defaultClickSound?(console.log("using sounds from GameConfig loaded from config sheet."),console.log("defaultClickSound",GameConfig.config.defaultClickSound),vlg.sfx.select=new Howl({urls:[GameConfig.config.defaultClickSound],
volume:1}),vlg.sfx.build=new Howl({urls:[GameConfig.config.defaultBuildSound],volume:.6}),vlg.sfx.cancel=new Howl({urls:[GameConfig.config.defaultCancelSound],volume:.8}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!0,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}),vlg.sfx.select.audioType="SFX",vlg.sfx.build.audioType="SFX",vlg.sfx.cancel.audioType="SFX",vlg.music.welcome.audioType=
"Music",vlg.music.levelfull1.audioType="Music"):(console.log("using sounds urls hardcoded in usehowler.js"),vlg.sfx.select=new Howl({urls:["/client/assets/audio/click.mp3"],volume:1}),vlg.sfx.cancel=new Howl({urls:["/client/assets/audio/cancel.mp3"],volume:.9}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!1,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}))}
function afterplay(a){vlg.log.info("Played ",a)}
function bindSounds(){vlg.log.info("binding sound");$("#goalButton").click(function(a){vlg.log.debug("#goalButton click   .",a)});$("#topToolbar").click(function(a){vlg.log.info("toptoolbar click",a)});$("#topToolbar").children().click(function(a){vlg.log.debug(" toolbar children click .",a);vlg.sfx.select.play(afterplay)});$(".ui-dialog-titlebar-close").click(function(){vlg.log.debug("binding cancel sound to cancel buttons.");vlg.sfx.cancel.play()})}
function toggleSound(){vlg.log.info("toggling Sound ",vlg.muted);vlg.muted?(Howler.unmute(),vlg.muted=!1):(Howler.mute(),vlg.muted=!0);vlg.log.info("now ",vlg.muted);return vlg.muted}function toggleMusic(){vlg.isMusicOn?vlg.music.levelfull1.volume(1):vlg.music.levelfull1.volume(0)}vlg.soundinit=soundinit;vlg.bindSounds=bindSounds;vlg.toggleSound=toggleSound;
$(document).ready(function(){vlg.log.info("Enabling sound and mute");$("#volume").click(function(){vlg.toggleSound();$("#volume").find("img").toggle()});vlg.log.debug("#volume",$("#volume"));vlg.log.debug("#volume kids",$("#volume").children());vlg.log.debug("toogleSound ",vlg.toggleSound)});
(function(){var a={},c=null,b=!0,d=!1;try{"undefined"!==typeof AudioContext?c=new AudioContext:"undefined"!==typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!==typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"===typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){a=parseFloat(a);if(0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){this._setMuted(!0);return this},unmute:function(){this._setMuted(!1);return this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var d=0;d<this._howls[c]._audioNode.length;d++)this._howls[c]._audioNode[d].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var d=c.createBuffer(1,1,22050),e=c.createBufferSource();e.buffer=d;e.connect(c.destination);"undefined"===typeof e.start?
e.noteOn(0):e.start(0);setTimeout(function(){if(e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE)a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1)},0)};window.addEventListener("touchend",b,!1);return a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!==typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};t.prototype={load:function(){var a=this,b=null;if(d)a.on("loaderror",Error("No audio support."));else{for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else if(g=a._urls[c],(e=/^data:audio\/([^;,]+);/i.exec(g))||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),e)e=e[1].toLowerCase();else{a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
return}if(p[e]){b=a._urls[c];break}}if(b){a._src=b;if(a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));
a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a}a.on("loaderror",Error("No codec support for selected audio sources."))}},urls:function(a){return a?(this.stop(),this._urls="string"===typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var d=this;"function"===typeof a&&(b=a);a&&"function"!==typeof a||(a="_default");if(!d._loaded)return d.on("load",function(){d.play(a,b)}),d;if(!d._sprite[a])return"function"===
typeof b&&b(),d;d._inactiveNode(function(e){e._sprite=a;var f=0<e._pos?e._pos:d._sprite[a][0]/1E3,g=0;d._webAudio?(g=d._sprite[a][1]/1E3-e._pos,0<e._pos&&(f=d._sprite[a][0]/1E3+f)):g=d._sprite[a][1]/1E3-(f-d._sprite[a][0]/1E3);var h=!(!d._loop&&!d._sprite[a][2]),l="string"===typeof b?b:Math.round(Date.now()*Math.random())+"",m;(function(){m=setTimeout(function(){!d._webAudio&&h&&d.stop(l).play(a,l);d._webAudio&&!h&&(d._nodeById(l).paused=!0,d._nodeById(l)._pos=0,d._clearEndTimer(l));d._webAudio||
h||d.stop(l);d.on("end",l)},g/d._rate*1E3);d._onendTimer.push({timer:m,id:l})})();if(d._webAudio){var n=d._sprite[a][0]/1E3,p=d._sprite[a][1]/1E3;e.id=l;e.paused=!1;k(d,[h,n,p],l);d._playStart=c.currentTime;e.gain.value=d._volume;"undefined"===typeof e.bufferSource.start?h?e.bufferSource.noteGrainOn(0,f,86400):e.bufferSource.noteGrainOn(0,f,g):h?e.bufferSource.start(0,f,86400):e.bufferSource.start(0,f,g)}else if(4===e.readyState||!e.readyState&&navigator.isCocoonJS)e.readyState=4,e.id=l,e.currentTime=
f,e.muted=q._muted||e.muted,e.volume=d._volume*q.volume(),setTimeout(function(){e.play()},0);else return d._clearEndTimer(l),function(){var c=a,f=b,g=function(){d.play(c,f);e.removeEventListener("canplaythrough",g,!1)};e.addEventListener("canplaythrough",g,!1)}(),d;d.on("play");"function"===typeof b&&b(l);return d});return d},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,
a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();b.on("pause");return b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"===typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||
(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=0:c.muted=!0);return b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1);return b},volume:function(a,b){var c=this;a=parseFloat(a);if(0<=a&&1>=a){c._volume=a;if(!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();d&&(c._webAudio?d.gain.value=a:d.volume=a*q.volume());return c}return c._volume},loop:function(a){return"boolean"===typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"===typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"===typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return 0<=a?(d.pause(b),
e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(0<=a)return d;for(e=0;e<d._audioNode.length;e++)if(d._audioNode[e].paused&&4===d._audioNode[e].readyState)return d._webAudio?d._audioNode[e]._pos:d._audioNode[e].currentTime},pos3d:function(a,b,c,d){var e=this;b="undefined"!==typeof b&&b?b:0;c="undefined"!==typeof c&&c?c:-.5;if(!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(0<=a||0>a){if(e._webAudio){var f=d?e._nodeById(d):e._activeNode();
f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}}else return e._pos3d;return e},fade:function(a,b,c,d,e){var f=this,g=a>b?"down":"up",h=Math.abs(a-b)/.01,l=c/h;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var m=1;m<=h;m++)(function(){var a=Math.round(1E3*(f._volume+("up"===g?.01:-.01)*m))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},l*m)})()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},
fadeOut:function(a,b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c();e.pause(d);e.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}this._drainPool();return a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}this._drainPool();if(!b){var d;if(this._webAudio)d=this._setupAudioNode(),a(d);else{this.load();d=this._audioNode[this._audioNode.length-1];var e=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",f=function(){d.removeEventListener(e,f,!1);a(d)};d.addEventListener(e,f,!1)}}},_drainPool:function(){var a=0,b;for(b=0;b<this._audioNode.length;b++)this._audioNode[b].paused&&a++;for(b=this._audioNode.length-1;0<=b&&!(5>=a);b--)this._audioNode[b].paused&&
(this._webAudio&&this._audioNode[b].disconnect(0),a--,this._audioNode.splice(b,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}if(a=this._onendTimer[b])clearTimeout(a.timer),this._onendTimer.splice(b,1)},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;a[b]="undefined"===typeof c.createGain?c.createGainNode():c.createGain();a[b].gain.value=this._volume;a[b].paused=!0;a[b]._pos=0;a[b].readyState=4;a[b].connect(e);
a[b].panner=c.createPanner();a[b].panner.panningModel=this._model||"equalpower";a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]);a[b].panner.connect(a[b]);return a[b]},on:function(a,b){var c=this["_on"+a];if("function"===typeof b)c.push(b);else for(var d=0;d<c.length;d++)b?c[d].call(this,b):c[d].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var d=0;d<c.length;d++){if(b===c[d]){c.splice(d,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}};if(b)var x=function(b,c){if(c in a)b._duration=a[c].duration,G(b);else if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=
d.charCodeAt(f);w(e.buffer,b,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){w(g.response,b,c)};g.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{g.send()}catch(H){g.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"===typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!==typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!==typeof window&&(window.Howler=q,window.Howl=t)})();
(function(a){var c={numberStep:function(b,c){var d=Math.floor(b);a(c.elem).text(d)}},b=function(a){var b=a.elem;b.nodeType&&b.parentNode&&(b=b._animateNumberSetter,b||(b=c.numberStep),b(a.now,a))};a.Tween&&a.Tween.propHooks?a.Tween.propHooks.number={set:b}:a.fx.step.number=b;a.animateNumber={numberStepFactories:{append:function(b){return function(c,d){var e=Math.floor(c);a(d.elem).prop("number",c).text(e+b)}},separator:function(b,c,h){b=b||" ";c=c||3;h=h||"";return function(d,e){var g=Math.floor(d).toString(),
p=a(e.elem);if(g.length>c){for(var x=g,w=c,G=x.split("").reverse(),g=[],k,f,l,m=0,n=Math.ceil(x.length/w);m<n;m++){k="";for(l=0;l<w;l++){f=m*w+l;if(f===x.length)break;k+=G[f]}g.push(k)}x=g.length-1;w=g[x].split("").reverse().join("");g[x]=parseInt(w,10).toString().split("").reverse().join("");g=g.join(b);g=g.split("").reverse().join("")}p.prop("number",d).text(g+h)}}}};a.fn.animateNumber=function(){for(var b=arguments[0],e=a.extend({},c,b),h=a(this),g=[e],p=1,q=arguments.length;p<q;p++)g.push(arguments[p]);
if(b.numberStep){var t=this.each(function(){this._animateNumberSetter=b.numberStep}),x=e.complete;e.complete=function(){t.each(function(){delete this._animateNumberSetter});x&&x.apply(this,arguments)}}return h.animate.apply(h,g)}})(jQuery);
(function(a){function c(){return document[h?"webkit"===h?"webkitIsFullScreen":h+"FullScreen":"fullScreen"]}function b(){return document[h?h+"CancelFullScreen":"cancelFullScreen"]()}var d="undefined"!==typeof document.cancelFullScreen,e=["webkit","moz","o","ms","khtml"],h="",g=function(){},p;if(!d)for(p=0;h=e[p];p++)if("undefined"!==typeof document[h+"CancelFullScreen"]){d=!0;break}d?(a.fn.requestFullScreen=function(){return this.each(function(){return this[h?h+"RequestFullScreen":"requestFullScreen"]()})},
a.fn.fullScreenChange=function(b){var c=[h+"fullscreenchange"].concat([].slice.call(arguments,0)),d=a(this);return d.bind.apply(d,c)},a.FullScreen={isFullScreen:c,cancelFullScreen:b}):(a.fn.requestFullScreen=a.fn.fullScreenChange=g,a.FullScreen={isFullScreen:function(){return!1},cancelFullScreen:g})})(jQuery);
(function(a,c){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():c.log4javascript=a()})(function(){function a(a){return"undefined"==typeof a}function c(){}function b(){}function d(a){return a&&a.toString?a.toString():String(a)}function e(a){return a.message?a.message:a.description?a.description:d(a)}function h(a){if(a){var b="Exception: "+e(a);try{if(a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName){var c=b,d,f=a.fileName,
g=Math.max(f.lastIndexOf("/"),f.lastIndexOf("\\"));d=f.substr(g+1);b=c+(" in file "+d)}}catch(ka){I.warn("Unable to obtain file and line information for error")}oa&&a.stack&&(b+="\r\nStack trace:\r\n"+a.stack);return b}return null}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function p(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}function q(a,b){for(var c=-1,d=0,e=a.length;d<e;d++)if(a[d]===b){c=d;break}return 0<=c?(a.splice(c,1),!0):!1}function t(a,b){for(var c=
0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1}function x(b,c){return a(b)?c:!!b}function w(b,c){return a(b)?c:String(b)}function G(b,c){if(a(b))return c;try{var d=parseInt(b,10);return isNaN(d)?c:d}catch(ha){return I.warn("Invalid int param "+b,ha),c}}function k(a,b){I.error(a,b);u.dispatchEvent("error",{message:a,exception:b})}function f(b,c){this.name=b;this.level=a(c)?v.INFO:c;this.start=new Date}function l(b){this.name=b;this.parent=null;this.children=[];var c=[],e=null,g="root"===this.name,
h="[null]"===this.name,l=null,m=!1;this.addChild=function(a){this.children.push(a);a.parent=this;a.invalidateAppenderCache()};var n=!0;this.getAdditivity=function(){return n};this.setAdditivity=function(a){var b=n!=a;n=a;b&&this.invalidateAppenderCache()};this.addAppender=function(a){h?k("Logger.addAppender: you may not add an appender to the null logger"):a instanceof u.Appender?t(c,a)||(c.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):k("Logger.addAppender: appender supplied ('"+
d(a)+"') is not a subclass of Appender")};this.removeAppender=function(a){q(c,a);a.setRemovedFromLogger(this);this.invalidateAppenderCache()};this.removeAllAppenders=function(){var a=c.length;if(0<a){for(var b=0;b<a;b++)c[b].setRemovedFromLogger(this);c.length=0;this.invalidateAppenderCache()}};this.getEffectiveAppenders=function(){if(null===l||m)l=(g||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders()).concat(c),m=!1;return l};this.invalidateAppenderCache=function(){m=!0;for(var a=0,b=
this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()};this.log=function(a,b){if(Q&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,d=b.length-1,e=b[d];1<b.length&&e instanceof Error&&(c=e,d--);for(var e=[],f=0;f<=d;f++)e[f]=b[f];c=new qa(this,new Date,a,e,c);this.callAppenders(c)}};this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,d=b.length;c<d;c++)b[c].doAppend(a)};this.setLevel=function(a){g&&null===a?k("Logger.setLevel: you cannot set the level of the root logger to null"):
a instanceof v?e=a:k("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")};this.getLevel=function(){return e};this.getEffectiveLevel=function(){for(var a=this;null!==a;a=a.parent){var b=a.getLevel();if(null!==b)return b}};this.group=function(a,b){if(Q)for(var c=this.getEffectiveAppenders(),d=0,e=c.length;d<e;d++)c[d].group(a,b)};this.groupEnd=function(){if(Q)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;b<c;b++)a[b].groupEnd()};var r={};this.time=
function(b,c){Q&&(a(b)?k("Logger.time: a name for the timer must be supplied"):!c||c instanceof v?r[b]=new f(b,c):k("Logger.time: level supplied to timer "+b+" is not an instance of log4javascript.Level"))};this.timeEnd=function(b){if(Q)if(a(b))k("Logger.timeEnd: a name for the timer must be supplied");else if(r[b]){var c=r[b],e=c.getElapsedTime();this.log(c.level,["Timer "+d(b)+" completed in "+e+"ms"]);delete r[b]}else I.warn("Logger.timeEnd: no timer found with name "+b)};this.assert=function(a){if(Q&&
!a){for(var b=[],c=1,d=arguments.length;c<d;c++)b.push(arguments[c]);b=0<b.length?b:["Assertion Failure"];b.push("\r\n");b.push(a);this.log(v.ERROR,b)}};this.toString=function(){return"Logger["+this.name+"]"}}function m(){this.customFields=[]}function n(){this.customFields=[]}function C(a){this.combineMessages=x(a,!0);this.customFields=[]}function B(a,b){this.readable=x(a,!1);this.combineMessages=x(b,!0);this.batchHeader=this.readable?"[\r\n":"[";this.batchFooter=this.readable?"]\r\n":"]";this.batchSeparator=
this.readable?",\r\n":",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?"\r\n":"";this.customFields=[]}function H(){this.setKeys();this.customFields=[];this.returnsPostData=!0}function ga(a,b,c){function e(a,b,c){function g(a){a=p(a);for(var b=1,d=a.length;b<d;b++)a[b]=c+a[b];return a.join("\r\n")}var l,m,k,n,r,q;c||(c="");if(null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return g(a);if("object"==
typeof a&&t(f,a)){try{r=d(a)}catch(ca){r="Error formatting property. Details: "+h(ca)}return r+" [already expanded]"}if(a instanceof Array&&0<b){f.push(a);r="[\r\n";m=b-1;k=c+"  ";n=[];l=0;for(b=a.length;l<b;l++)try{q=e(a[l],m,k),n.push(k+q)}catch(ca){n.push(k+"Error formatting array member. Details: "+h(ca)+"")}return r+=n.join(",\r\n")+"\r\n"+c+"]"}if("[object Date]"==Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&0<b){f.push(a);r="{\r\n";m=b-1;k=c+"  ";n=[];for(l in a)try{q=
e(a[l],m,k),n.push(k+l+": "+q)}catch(ca){n.push(k+l+": Error formatting property. Details: "+h(ca))}return r+=n.join(",\r\n")+"\r\n"+c+"}"}return g(d(a))}var f=[];return e(a,b,c)}function E(a){this.pattern=a?a:E.DEFAULT_CONVERSION_PATTERN;this.customFields=[]}function K(){}function F(){}function M(b,c){function d(a){return M?(k("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0}function e(){if(p&&Q){K=!0;var a;if(t)0<F.length?(a=F.shift(),m(g(a),
e)):(K=!1,q&&window.setTimeout(e,v));else{for(;a=F.shift();)m(g(a));K=!1;q&&window.setTimeout(e,v)}}}function f(){var a=!1;if(p&&Q){for(var a=r.getLayout().allowBatching()?u:1,b,c=[];b=H.shift();)c.push(b),H.length>=a&&(F.push(c),c=[]);0<c.length&&F.push(c);a=0<F.length;q=t=!1;e()}return a}function g(a){for(var b=[],c;c=a.shift();)b.push(r.getLayout().formatWithException(c));a=1==a.length?b.join(""):r.getLayout().batchHeader+b.join(r.getLayout().batchSeparator)+r.getLayout().batchFooter;E==r.defaults.contentType&&
(a=r.getLayout().returnsPostData?a:U(C)+"="+U(a),0<a.length&&(a+="&"),a+="layout="+U(r.getLayout().toString()));return a}function l(){k("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled");p=!1;B&&B("AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled")}function m(d,e){try{var f=ra(l);if(p){f.onreadystatechange=function(){if(4==f.readyState){var c=f;a(c.status)||0===c.status||200<=c.status&&300>c.status||1223==c.status?(J&&J(f),e&&e(f)):(c="AjaxAppender.append: XMLHttpRequest request to URL "+
b+" returned status code "+f.status,k(c),B&&B(c));f.onreadystatechange=da;f=null}};f.open("POST",b,!0);c&&za&&(f.withCredentials=!0);try{for(var g=0,m;m=I[g++];)f.setRequestHeader(m.name,m.value);f.setRequestHeader("Content-Type",E)}catch(na){k("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");p=!1;B&&B("AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled");
return}f.send(d)}}catch(na){g="AjaxAppender.append: error sending log message to "+b,k(g,na),p=!1,B&&B(g+". Details: "+h(na))}}function n(){M=!0;if(y){var a=window.onbeforeunload;window.onbeforeunload=function(){a&&a();f()}}q&&window.setTimeout(e,v)}var r=this,p=!0;b||(k("AjaxAppender: URL must be specified in constructor"),p=!1);var q=this.defaults.timed,t=this.defaults.waitForResponse,u=this.defaults.batchSize,v=this.defaults.timerInterval,J=this.defaults.requestSuccessCallback,B=this.defaults.failCallback,
C=this.defaults.postVarName,y=this.defaults.sendAllOnUnload,E=this.defaults.contentType,A=null,H=[],F=[],I=[],K=!1,M=!1;this.getSessionId=function(){return A};this.setSessionId=function(a){A=w(a,null);this.layout.setCustomField("sessionid",A)};this.setLayout=function(a){d("layout")&&(this.layout=a,null!==A&&this.setSessionId(A))};this.isTimed=function(){return q};this.setTimed=function(a){d("timed")&&(q=!!a)};this.getTimerInterval=function(){return v};this.setTimerInterval=function(a){d("timerInterval")&&
(v=G(a,v))};this.isWaitForResponse=function(){return t};this.setWaitForResponse=function(a){d("waitForResponse")&&(t=!!a)};this.getBatchSize=function(){return u};this.setBatchSize=function(a){d("batchSize")&&(u=G(a,u))};this.isSendAllOnUnload=function(){return y};this.setSendAllOnUnload=function(a){d("sendAllOnUnload")&&(y=x(a,y))};this.setRequestSuccessCallback=function(a){J="function"==typeof a?a:J};this.setFailCallback=function(a){B="function"==typeof a?a:B};this.getPostVarName=function(){return C};
this.setPostVarName=function(a){d("postVarName")&&(C=w(a,C))};this.getHeaders=function(){return I};this.addHeader=function(a,b){"content-type"==a.toLowerCase()?E=b:I.push({name:a,value:b})};this.sendAll=e;this.sendAllRemaining=f;this.append=function(a){if(p&&(M||n(),H.push(a),a=this.getLayout().allowBatching()?u:1,H.length>=a)){for(var b=[];a=H.shift();)b.push(a);F.push(b);q||t&&(!t||K)||e()}}}function ba(a){try{return!!a.loaded}catch(J){return!1}}function W(a,b){if(a.length<b){for(var c=[],d=Math.max(0,
b-a.length),e=0;e<d;e++)c[e]=" ";a+=c.join("")}return a}Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length});Array.prototype.shift||(Array.prototype.shift=function(){if(0<this.length){for(var a=this[0],b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];--this.length;return a}});Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),d=this.slice(a,a+b);this.length=a;for(var e=[],f=0,
g=arguments.length;f<g;f++)e[f]=arguments[f];c=2<e.length?e.slice(2).concat(c):c;f=0;for(g=c.length;f<g;f++)this.push(c[f]);return d});c.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a;this.eventListeners={};a=0;for(var b=this.eventTypes.length;a<b;a++)this.eventListeners[this.eventTypes[a]]=[]}else k("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){"function"==
typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):k("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){"function"==typeof b?(t(this.eventTypes,a)||k("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),q(this.eventListeners[a],b)):k("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},
dispatchEvent:function(a,b){if(t(this.eventTypes,a))for(var c=this.eventListeners[a],d=0,e=c.length;d<e;d++)c[d](this,a,b);else k("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var Aa=new Date,Ba="log4javascript_"+Aa.getTime()+"_"+Math.floor(1E8*Math.random()),da=function(){},wa=!1;b.prototype=new c;var u=new b;u.version="1.4.13";u.edition="log4javascript";var U="undefined"!=typeof window.encodeURIComponent?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,
"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(a,b){var c="__apply__";"undefined"!=typeof a[c]&&(c+=String(Math.random()).substr(2));a[c]=this;for(var d=[],e=0,f=b.length;e<f;e++)d[e]="args["+e+"]";d="obj."+c+"("+d.join(",")+")";d=eval(d);delete a[c];return d});Function.prototype.call||(Function.prototype.call=function(a){for(var b=[],c=1,d=arguments.length;c<d;c++)b[c-1]=arguments[c];return this.apply(a,
b)});var I={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=!!a},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join("\r\n"))},warn:function(a,b){},error:function(a,b){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+="\r\n\r\nOriginal error: "+h(b));alert(c)}}};u.logLog=I;u.setEventTypes(["load",
"error"]);u.handleError=k;var Q=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);u.setEnabled=function(a){Q=!!a};u.isEnabled=function(){return Q};var ea=!0;u.setTimeStampsInMilliseconds=function(a){ea=!!a};u.isTimeStampsInMilliseconds=function(){return ea};u.evalInScope=function(a){return eval(a)};var oa=!1;u.setShowStackTraces=function(a){oa=!!a};var v=function(a,b){this.level=a;this.name=b};v.prototype={toString:function(){return this.name},equals:function(a){return this.level==
a.level},isGreaterOrEqual:function(a){return this.level>=a.level}};v.ALL=new v(Number.MIN_VALUE,"ALL");v.TRACE=new v(1E4,"TRACE");v.DEBUG=new v(2E4,"DEBUG");v.INFO=new v(3E4,"INFO");v.WARN=new v(4E4,"WARN");v.ERROR=new v(5E4,"ERROR");v.FATAL=new v(6E4,"FATAL");v.OFF=new v(Number.MAX_VALUE,"OFF");u.Level=v;f.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};l.prototype={trace:function(){this.log(v.TRACE,arguments)},debug:function(){this.log(v.DEBUG,arguments)},info:function(){this.log(v.INFO,
arguments)},warn:function(){this.log(v.WARN,arguments)},error:function(){this.log(v.ERROR,arguments)},fatal:function(){this.log(v.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(v.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(v.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(v.INFO)},isWarnEnabled:function(){return this.isEnabledFor(v.WARN)},isErrorEnabled:function(){return this.isEnabledFor(v.ERROR)},
isFatalEnabled:function(){return this.isEnabledFor(v.FATAL)}};l.prototype.trace.isEntryPoint=!0;l.prototype.debug.isEntryPoint=!0;l.prototype.info.isEntryPoint=!0;l.prototype.warn.isEntryPoint=!0;l.prototype.error.isEntryPoint=!0;l.prototype.fatal.isEntryPoint=!0;var aa={},Ia=[],Ca=v.DEBUG,Y=new l("root");Y.setLevel(Ca);u.getRootLogger=function(){return Y};u.getLogger=function(a){"string"!=typeof a&&(a="[anonymous]",I.warn("log4javascript.getLogger: non-string logger name "+d(a)+" supplied, returning anonymous logger"));
"root"==a&&k("log4javascript.getLogger: root logger may not be obtained by name");if(!aa[a]){var b=new l(a);aa[a]=b;Ia.push(a);var c=a.lastIndexOf(".");-1<c?(c=a.substring(0,c),c=u.getLogger(c)):c=Y;c.addChild(b)}return aa[a]};var fa=null;u.getDefaultLogger=function(){if(!fa){var a=u.getLogger("[default]"),b=new u.PopUpAppender;a.addAppender(b);fa=a}return fa};var Z=null;u.getNullLogger=function(){Z||(Z=new l("[null]"),Z.setLevel(v.OFF));return Z};u.resetConfiguration=function(){Y.setLevel(Ca);aa=
{}};var qa=function(a,b,c,d,e){this.logger=a;this.timeStamp=b;this.timeStampInMilliseconds=b.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1E3);this.milliseconds=this.timeStamp.getMilliseconds();this.level=c;this.messages=d;this.exception=e};qa.prototype={getThrowableStrRep:function(){return this.exception?h(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join("\r\n")},toString:function(){return"LoggingEvent["+
this.level+"]"}};u.LoggingEvent=qa;var R=function(){};R.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,
format:function(){k("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){k("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0;this.useTimeStampsInMilliseconds=!!a},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:ea},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?
a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]);a.exception&&c.push([this.exceptionKey,h(a.exception)]);if(this.hasCustomFields())for(var d=0,e=this.customFields.length;d<e;d++){var f=this.customFields[d].value;
"function"===typeof f&&(f=f(this,a));c.push([this.customFields[d].name,f])}return c},setKeys:function(a,b,c,d,e,f,g){this.loggerKey=w(a,this.defaults.loggerKey);this.timeStampKey=w(b,this.defaults.timeStampKey);this.levelKey=w(c,this.defaults.levelKey);this.messageKey=w(d,this.defaults.messageKey);this.exceptionKey=w(e,this.defaults.exceptionKey);this.urlKey=w(f,this.defaults.urlKey);this.millisecondsKey=w(g,this.defaults.millisecondsKey)},setCustomField:function(a,b){for(var c=!1,d=0,e=this.customFields.length;d<
e;d++)this.customFields[d].name===a&&(this.customFields[d].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return 0<this.customFields.length},formatWithException:function(a){var b=this.format(a);a.exception&&this.ignoresThrowable()&&(b+=a.getThrowableStrRep());return b},toString:function(){k("Layout.toString: all layouts must override this method")}};u.Layout=R;var y=function(){};y.prototype=new c;y.prototype.layout=new E;y.prototype.threshold=v.ALL;y.prototype.loggers=
[];y.prototype.doAppend=function(a){Q&&a.level.level>=this.threshold.level&&this.append(a)};y.prototype.append=function(a){};y.prototype.setLayout=function(a){a instanceof R?this.layout=a:k("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")};y.prototype.getLayout=function(){return this.layout};y.prototype.setThreshold=function(a){a instanceof v?this.threshold=a:k("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")};
y.prototype.getThreshold=function(){return this.threshold};y.prototype.setAddedToLogger=function(a){this.loggers.push(a)};y.prototype.setRemovedFromLogger=function(a){q(this.loggers,a)};y.prototype.group=da;y.prototype.groupEnd=da;y.prototype.toString=function(){k("Appender.toString: all appenders must override this method")};u.Appender=y;m.prototype=new R;m.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()};m.prototype.ignoresThrowable=function(){return!0};m.prototype.toString=
function(){return"SimpleLayout"};u.SimpleLayout=m;n.prototype=new R;n.prototype.format=function(a){return a.messages};n.prototype.ignoresThrowable=function(){return!0};n.prototype.formatWithException=function(a){var b=a.messages;return(a=a.exception)?b.concat([a]):b};n.prototype.toString=function(){return"NullLayout"};u.NullLayout=n;C.prototype=new R;C.prototype.isCombinedMessages=function(){return this.combineMessages};C.prototype.getContentType=function(){return"text/xml"};C.prototype.escapeCdata=
function(a){return a.replace(/\]\]>/,"]]\x3e]]&gt;<![CDATA[")};C.prototype.format=function(a){function b(a){a="string"===typeof a?a:d(a);return"<log4javascript:message><![CDATA["+c.escapeCdata(a)+"]]\x3e</log4javascript:message>"}var c=this,e,f,g='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';this.isTimeStampsInMilliseconds()||(g+=' milliseconds="'+a.milliseconds+'"');g+=' level="'+a.level.name+'">\r\n';if(this.combineMessages)g+=b(a.getCombinedMessages());
else{g+="<log4javascript:messages>\r\n";e=0;for(f=a.messages.length;e<f;e++)g+=b(a.messages[e])+"\r\n";g+="</log4javascript:messages>\r\n"}if(this.hasCustomFields())for(e=0,f=this.customFields.length;e<f;e++)g+='<log4javascript:customfield name="'+this.customFields[e].name+'"><![CDATA['+this.customFields[e].value.toString()+"]]\x3e</log4javascript:customfield>\r\n";a.exception&&(g+="<log4javascript:exception><![CDATA["+h(a.exception)+"]]\x3e</log4javascript:exception>\r\n");return g+"</log4javascript:event>\r\n\r\n"};
C.prototype.ignoresThrowable=function(){return!1};C.prototype.toString=function(){return"XmlLayout"};u.XmlLayout=C;B.prototype=new R;B.prototype.isReadable=function(){return this.readable};B.prototype.isCombinedMessages=function(){return this.combineMessages};B.prototype.format=function(a){function b(a,e,f){var g=typeof a;if(a instanceof Date)f=String(a.getTime());else if(f&&a instanceof Array){f="["+c.lineBreak;for(var g=0,h=a.length;g<h;g++){var l=e+c.tab;f+=l+b(a[g],l,!1);g<a.length-1&&(f+=",");
f+=c.lineBreak}f+=e+"]"}else f="number"!==g&&"boolean"!==g?'"'+d(a).replace(/\"/g,'\\"').replace(/\r\n|\r|\n/g,"\\r\\n")+'"':a;return f}var c=this;a=this.getDataValues(a,this.combineMessages);var e="{"+this.lineBreak,f,g;f=0;for(g=a.length-1;f<=g;f++)e+=this.tab+'"'+a[f][0]+'"'+this.colon+b(a[f][1],this.tab,!0),f<g&&(e+=","),e+=this.lineBreak;return e+="}"+this.lineBreak};B.prototype.ignoresThrowable=function(){return!1};B.prototype.toString=function(){return"JsonLayout"};B.prototype.getContentType=
function(){return"application/json"};u.JsonLayout=B;H.prototype=new R;H.prototype.allowBatching=function(){return!1};H.prototype.format=function(a){a=this.getDataValues(a);for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c][1]instanceof Date?String(a[c][1].getTime()):a[c][1];b.push(U(a[c][0])+"="+U(e))}return b.join("&")};H.prototype.ignoresThrowable=function(a){return!1};H.prototype.toString=function(){return"HttpPostDataLayout"};u.HttpPostDataLayout=H;var P;(function(){var b=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,
c="January February March April May June July August September October November December".split(" "),d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),e={G:0,y:3,M:4,w:2,W:2,D:2,d:2,F:2,E:1,a:0,H:2,k:2,K:2,h:2,m:2,s:2,S:2,Z:5},f=function(a,b,c){a=new Date(a,b,c,0,0,0);a.setMilliseconds(0);return a};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()};Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),
this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()};Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),a=new Date(a.getTime()-864E5*this.getDay());return f(a.getFullYear(),a.getMonth(),a.getDate())};Date.prototype.getWeekInYear=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),
d=f(this.getFullYear(),0,1),c=c.isBefore(d)?0:1+Math.floor(c.getTimeSince(d)/6048E5),d=7-d.getDay();d<b&&c--;return c};Date.prototype.getWeekInMonth=function(b){a(this.minimalDaysInFirstWeek)&&(b=1);var c=this.getPreviousSunday(),d=f(this.getFullYear(),this.getMonth(),1),c=c.isBefore(d)?0:1+Math.floor(c.getTimeSince(d)/6048E5),d=7-d.getDay();d>=b&&c++;return c};Date.prototype.getDayInYear=function(){var a=f(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/864E5)};P=function(a){this.formatString=
a};P.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a};P.prototype.getMinimalDaysInFirstWeek=function(){return a(this.minimalDaysInFirstWeek)?1:this.minimalDaysInFirstWeek};var g=function(a,b){for(;a.length<b;)a="0"+a;return a},h=function(a,b,c){return 4<=b?a:a.substr(0,Math.max(c,b))};P.prototype.format=function(a){for(var f="",l,m=this.formatString;l=b.exec(m);){var k=l[1],n=l[2],p=l[3],q=l[4];if(k)f="''"==k?f+"'":f+k.substring(1,k.length-1);else if(!p)if(q)f+=q;else if(n){k=
n.charAt(0);n=n.length;p="";switch(k){case "G":p="AD";break;case "y":p=a.getFullYear();break;case "M":p=a.getMonth();break;case "w":p=a.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case "W":p=a.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case "D":p=a.getDayInYear();break;case "d":p=a.getDate();break;case "F":p=1+Math.floor((a.getDate()-1)/7);break;case "E":p=d[a.getDay()];break;case "a":p=12<=a.getHours()?"PM":"AM";break;case "H":p=a.getHours();break;case "k":p=a.getHours()||24;
break;case "K":p=a.getHours()%12;break;case "h":p=a.getHours()%12||12;break;case "m":p=a.getMinutes();break;case "s":p=a.getSeconds();break;case "S":p=a.getMilliseconds();break;case "Z":p=a.getTimezoneOffset()}switch(e[k]){case 0:f+=h(p,n,2);break;case 1:f+=h(p,n,3);break;case 2:f+=g(""+p,n);break;case 3:f=3>=n?f+(""+p).substr(2,2):f+g(""+p,n);break;case 4:f=3<=n?f+h(c[p],n,n):f+g(""+(p+1),n);break;case 5:n=0<p?"-":"+",p=Math.abs(p),k=""+Math.floor(p/60),k=g(k,2),p=""+p%60,p=g(p,2),f+=n+k+p}}m=m.substr(l.index+
l[0].length)}return f}})();u.SimpleDateFormat=P;E.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";E.DEFAULT_CONVERSION_PATTERN="%m%n";E.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";E.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";E.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";E.prototype=new R;E.prototype.format=function(a){for(var b=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,c="",d,e=this.pattern;d=b.exec(e);){var f=d[0],g=d[1],h=d[2],l=d[3],m=d[5],n=d[6];if(n)c+=""+n;else{n="";switch(l){case "a":case "m":f=
0;m&&(f=parseInt(m,10),isNaN(f)&&(k("PatternLayout.format: invalid specifier '"+m+"' for conversion character '"+l+"' - should be a number"),f=0));for(var m="a"===l?a.messages[0]:a.messages,l=0,p=m.length;l<p;l++)0<l&&" "!==n.charAt(n.length-1)&&(n+=" "),n=0===f?n+m[l]:n+ga(m[l],f);break;case "c":n=a.logger.name;m&&(m=parseInt(m,10),f=a.logger.name.split("."),n=m>=f.length?n:f.slice(f.length-m).join("."));break;case "d":n=E.ISO8601_DATEFORMAT;m&&(n=m,"ISO8601"==n?n=E.ISO8601_DATEFORMAT:"ABSOLUTE"==
n?n=E.ABSOLUTETIME_DATEFORMAT:"DATE"==n&&(n=E.DATETIME_DATEFORMAT));n=(new P(n)).format(a.timeStamp);break;case "f":this.hasCustomFields()&&(n=0,m&&(n=parseInt(m,10),isNaN(n)?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - should be a number"):0===n?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - must be greater than zero"):n>this.customFields.length?k("PatternLayout.format: invalid specifier '"+m+"' for conversion character 'f' - there aren't that many custom fields"):
--n),n=this.customFields[n].value,"function"==typeof n&&(n=n(this,a)));break;case "n":n="\r\n";break;case "p":n=a.level.name;break;case "r":n=""+a.timeStamp.getDifference(Aa);break;case "%":n="%";break;default:n=f}h&&(h=parseInt(h.substr(1),10),m=n.length,h<m&&(n=n.substring(m-h,m)));if(g)if("-"==g.charAt(0))for(h=parseInt(g.substr(1),10);n.length<h;)n+=" ";else for(h=parseInt(g,10);n.length<h;)n=" "+n;c+=n}e=e.substr(d.index+d[0].length)}return c};E.prototype.ignoresThrowable=function(){return!0};
E.prototype.toString=function(){return"PatternLayout"};u.PatternLayout=E;K.prototype=new y;K.prototype.layout=new m;K.prototype.append=function(a){alert(this.getLayout().formatWithException(a))};K.prototype.toString=function(){return"AlertAppender"};u.AlertAppender=K;F.prototype=new u.Appender;F.prototype.layout=new n;F.prototype.threshold=v.DEBUG;F.prototype.append=function(a){var b=this,c=function(c){var d=b.getLayout().formatWithException(a);return"string"==typeof d?c?d:[d]:c?d.join(" "):d},d=
window.console;if(d&&d.log){var e;e=d.debug&&v.DEBUG.isGreaterOrEqual(a.level)?"debug":d.info&&v.INFO.equals(a.level)?"info":d.warn&&v.WARN.equals(a.level)?"warn":d.error&&a.level.isGreaterOrEqual(v.ERROR)?"error":"log";if("function"==typeof d[e].apply)d[e].apply(d,c(!1));else d[e](c(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(c(!0))};F.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)};F.prototype.groupEnd=function(){window.console&&
window.console.groupEnd&&window.console.groupEnd()};F.prototype.toString=function(){return"BrowserConsoleAppender"};u.BrowserConsoleAppender=F;var Da=function(){return new XMLHttpRequest},Ea=[Da,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],za=!1,ra=function(a){for(var b=null,c,d=0,e=Ea.length;d<e;d++){c=Ea[d];try{return b=c(),za=c==Da&&"withCredentials"in b,ra=c,b}catch(D){}}a?a():k("getXmlHttp: unable to obtain XMLHttpRequest object")};
M.prototype=new y;M.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1E3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};M.prototype.layout=new H;M.prototype.toString=function(){return"AjaxAppender"};u.AjaxAppender=M;var A;(function(){function b(a,b,c,d,e){this.create(!1,null,a,b,c,d,e,this.defaults.focusPopUp)}function c(a,b,c,d,e,f){this.create(!0,a,b,c,d,e,f,!1)}var d=[];A=function(){};
var e=1;A.prototype=new y;A.prototype.create=function(b,c,f,g,l,m,n,p){function q(a,b){this.loggingEvent=a;this.levelName=a.level.name;this.formattedMessage=b}function r(a,b){this.name=a;this.initiallyExpanded=b}function t(){}var D=this,B=!1,C=!1,y=!1,A=!1,V=[],F=!0,H=e++;g=x(g,this.defaults.initiallyMinimized);f=x(f,this.defaults.lazyInit);l=x(l,this.defaults.useDocumentWrite);var J=this.defaults.newestMessageAtTop,K=this.defaults.scrollToLatestMessage;m=m?m:this.defaults.width;n=n?n:this.defaults.height;
var M=this.defaults.maxMessages,S=this.defaults.showCommandLine,ia=this.defaults.commandLineObjectExpansionDepth,ka=this.defaults.showHideButton,la=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var R,P,U,z,W,aa=b?"InPageAppender":"PopUpAppender",Y=function(a){return C?(k(aa+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0},N=function(){return y&&F&&!A};this.isNewestMessageAtTop=function(){return J};this.setNewestMessageAtTop=function(a){J=
!!a;N()&&z().setNewestAtTop(J)};this.isScrollToLatestMessage=function(){return K};this.setScrollToLatestMessage=function(a){K=!!a;N()&&z().setScrollToLatest(K)};this.getWidth=function(){return m};this.setWidth=function(a){Y("width")&&(m=w(a,m))};this.getHeight=function(){return n};this.setHeight=function(a){Y("height")&&(n=w(a,n))};this.getMaxMessages=function(){return M};this.setMaxMessages=function(a){M=G(a,M);N()&&z().setMaxMessages(M)};this.isShowCommandLine=function(){return S};this.setShowCommandLine=
function(a){S=!!a;N()&&z().setShowCommandLine(S)};this.isShowHideButton=function(){return ka};this.setShowHideButton=function(a){ka=!!a;N()&&z().setShowHideButton(ka)};this.isShowCloseButton=function(){return la};this.setShowCloseButton=function(a){la=!!a;N()&&z().setShowCloseButton(la)};this.getCommandLineObjectExpansionDepth=function(){return ia};this.setCommandLineObjectExpansionDepth=function(a){ia=G(a,ia)};var Z=g;this.isInitiallyMinimized=function(){return g};this.setInitiallyMinimized=function(a){Y("initiallyMinimized")&&
(Z=g=!!a)};this.isUseDocumentWrite=function(){return l};this.setUseDocumentWrite=function(a){Y("useDocumentWrite")&&(l=!!a)};q.prototype.append=function(){z().log(this.levelName,this.formattedMessage)};r.prototype.append=function(){z().group(this.name,this.initiallyExpanded)};t.prototype.append=function(){z().groupEnd()};var pa=function(){U();B?A&&xa&&P():R();U()&&da()};this.append=function(a){if(F){var b=D.getLayout().formatWithException(a);V.push(new q(a,b));pa()}};this.group=function(a,b){F&&(V.push(new r(a,
b)),pa())};this.groupEnd=function(){F&&(V.push(new t),pa())};var da=function(){for(;0<V.length;)V.shift().append();p&&z().focus()};this.setAddedToLogger=function(a){this.loggers.push(a);Q&&!f&&R()};this.clear=function(){N()&&z().clearLog();V.length=0};this.focus=function(){N()&&z().focus()};this.focusCommandLine=function(){N()&&z().focusCommandLine()};this.focusSearch=function(){N()&&z().focusSearch()};var L=window;this.getCommandWindow=function(){return L};this.setCommandWindow=function(a){L=a};
this.executeLastCommand=function(){N()&&z().evalLastCommand()};var ha=new E("%m");this.getCommandLayout=function(){return ha};this.setCommandLayout=function(a){ha=a};this.evalCommandAndAppend=function(b){var c={appendResult:!0,isError:!1},d="";try{var e,f;!L.eval&&L.execScript&&L.execScript("null");var g={};f=0;for(len=ja.length;f<len;f++)g[ja[f][0]]=ja[f][1];var l=[],m=function(a){l.push([a,L[a]])};m("appender");L.appender=D;m("commandReturnValue");L.commandReturnValue=c;m("commandLineFunctionsHash");
L.commandLineFunctionsHash=g;g=function(a){m(a);L[a]=function(){return this.commandLineFunctionsHash[a](D,arguments,c)}};f=0;for(len=ja.length;f<len;f++)g(ja[f][0]);L===window&&L.execScript?(m("evalExpr"),m("result"),window.evalExpr=b,L.execScript("window.result=eval(window.evalExpr);"),e=window.result):e=L.eval(b);d=a(e)?e:ga(e,ia);f=0;for(len=l.length;f<len;f++)L[l[f][0]]=l[f][1]}catch(La){d="Error evaluating command: "+h(La),c.isError=!0}c.appendResult&&(b=">>> "+b,a(d)||(b+="\r\n"+d),d=new qa(null,
new Date,c.isError?v.ERROR:v.INFO,[b],null),b=this.getLayout(),this.setLayout(ha),this.append(d),this.setLayout(b))};var ja=d.concat([]);this.addCommandLineFunction=function(a,b){ja.push([a,b])};this.storeCommandHistory=function(a){a=a.join(",");var b=void 0,b=b?"; path="+b:"";document.cookie=escape("log4javascriptCommandHistory")+"="+escape(a)+""+b};var fa=function(a){var b=['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',
"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\x3c!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work --\x3e",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;\x3c/script>','\x3c!--[if IE]><script type="text/javascript">isIe = true\x3c/script><![endif]--\x3e','\x3c!--[if lt IE 7]><script type="text/javascript">isIePre7 = true\x3c/script><![endif]--\x3e',
'<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}",
"this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",
'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',
"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",
'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}',
'GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",
'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',
"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}",
"this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}",
"this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",
'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}',
'LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}',
'LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',
"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}',
'this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',
"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",
'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}',
'logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',
"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}",
"var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}",
"matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",
'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}",
"var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}",
"return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}",
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}",
"displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}",
"var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',
"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",
'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}',
'function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}',
'function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}",
"searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}",
"return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',
"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+",
"preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}",
"logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}",
"var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}",
"setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',
"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}",
"this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}',
'currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}',
'addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}",
"function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}',
'function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}',
'if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',
"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}',
'function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}',
'function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}",
"function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}",
"currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}",
"return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-',
'($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}",
"this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}",
"return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}",
"return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',
"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',
"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}",
"currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]\x3e","\x3c/script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}",
"</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>',
'<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>',
'<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />',
'<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>',
'<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>',
'<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>',
'<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />',
'<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />',
'<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];a.open();for(var c=0,d=b.length;c<d;c++)a.writeln(b[c]);a.close()};this.setEventTypes(["load","unload"]);var va=function(){var a=z();a.setAppender(D);a.setNewestAtTop(J);a.setScrollToLatest(K);a.setMaxMessages(M);a.setShowCommandLine(S);a.setShowHideButton(ka);a.setShowCloseButton(la);a.setMainWindow(window);var b;a:{b=escape("log4javascriptCommandHistory")+
"=";for(var c=document.cookie.split(";"),d=0,e=c.length;d<e;d++){for(var f=c[d];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b)){b=unescape(f.substring(b.length,f.length));break a}}b=null}b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length);D.dispatchEvent("load",{win:a})};this.unload=function(){I.debug("unload "+this+", caller: "+this.unload.caller);A||(I.debug("really doing unload "+this),A=!0,C=y=!1,D.dispatchEvent("unload",{}))};var ea=function(a,b,
c,d){var e=setInterval(function(){try{A&&clearInterval(e),a(z())&&(clearInterval(e),c())}catch(sa){clearInterval(e),F=!1,k(d,sa)}},b)},oa=function(){var a=document.domain!=location.hostname;if(l)a="";else{var b;a:{b=document.getElementsByTagName("script");for(var c=0,d=b.length;c<d;++c)if(-1!=b[c].src.indexOf("log4javascript")){d=b[c].src.lastIndexOf("/");b=-1==d?"":b[c].src.substr(0,d+1);break a}b=null}a=b+"console.html"+(a?"?log4javascript_domain="+escape(document.domain):"")}return a};if(b){var X=
null,ta=[];this.addCssProperty=function(a,b){Y("cssProperties")&&ta.push([a,b])};var ua=!1,T,ra=Ba+"_InPageAppender_"+H;this.hide=function(){B&&C&&(N()&&z().$("command").blur(),T.style.display="none",Z=!0)};this.show=function(){B&&(C?(T.style.display="block",this.setShowCommandLine(S),Z=!1):ua||P(!0))};this.isVisible=function(){return!Z&&!A};this.close=function(a){A||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||(T.parentNode.removeChild(T),
this.unload())};W=function(){function a(){try{g||D.show(),va(),y=!0,da()}catch(Ka){F=!1,k("InPageAppender.open: unable to create console iframe",Ka)}}function b(){try{var b=function(a){return ba(a)};l&&fa(z().document);ba(z())?a():ea(b,100,a,"InPageAppender.open: unable to create console iframe")}catch(sa){F=!1,k("InPageAppender.open: unable to create console iframe",sa)}}Z=!1;T=X.appendChild(document.createElement("div"));T.style.width=m;T.style.height=n;T.style.border="solid gray 1px";for(var c=
0,d=ta.length;c<d;c++)T.style[ta[c][0]]=ta[c][1];c=l?"":" src='"+oa()+"'";T.innerHTML="<iframe id='"+ra+"' name='"+ra+"' width='100%' height='100%' frameborder='0'"+c+" scrolling='no'></iframe>";A=!1;c=function(a){try{return!!a&&!!a.document}catch(sa){return!1}};c(z())?b():ea(c,100,b,"InPageAppender.open: unable to create console iframe");C=!0};P=function(a){if(a||!g)a=function(){if(c)try{var a=document.getElementById(c);1==a.nodeType&&(X=a);W()}catch(Ja){k("InPageAppender.init: invalid container element '"+
c+"' supplied",Ja)}else X=document.createElement("div"),X.style.position="fixed",X.style.left="0",X.style.right="0",X.style.bottom="0",document.body.appendChild(X),D.addCssProperty("borderWidth","1px 0 0 0"),D.addCssProperty("zIndex",1E6),W()},wa&&c&&c.appendChild?(X=c,W()):wa?a():u.addEventListener("load",a),ua=!0};R=function(){P();B=!0};z=function(){var a=window.frames[ra];if(a)return a};U=function(){return F&&!A?(C&&!y&&z()&&ba(z())&&(y=!0),y):!1}}else{var ma=D.defaults.useOldPopUp,ya=D.defaults.complainAboutPopUpBlocking,
xa=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return ma};this.setUseOldPopUp=function(a){Y("useOldPopUp")&&(ma=!!a)};this.isComplainAboutPopUpBlocking=function(){return ya};this.setComplainAboutPopUpBlocking=function(a){Y("complainAboutPopUpBlocking")&&(ya=!!a)};this.isFocusPopUp=function(){return p};this.setFocusPopUp=function(a){p=!!a};this.isReopenWhenClosed=function(){return xa};this.setReopenWhenClosed=function(a){xa=!!a};this.close=function(){I.debug("close "+this);try{O.close(),
this.unload()}catch(Ma){}};this.hide=function(){I.debug("hide "+this);N()&&this.close()};this.show=function(){I.debug("show "+this);C||W()};this.isVisible=function(){return U()};var O;W=function(){function a(){z().setCloseIfOpenerCloses(!ma||!l);va();y=!0;da();ea(e,500,f,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+m+",height="+n+",status,resizable",c="";try{var d=window.frameElement;d&&(c="_"+d.tagName+"_"+(d.name||d.id||""))}catch(Fa){c="_inaccessibleParentFrame"}c=
"PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+H+c;ma&&l||(c=c+"_"+Ba);var e=function(a){if(A)return!0;try{return!!a&&a.closed}catch(Na){}return!1},f=function(){A||D.unload()};try{O=window.open(oa(),c,b),A=!1,C=!0,O&&O.document?l&&ma&&ba(O)?(O.mainPageReloaded(),a()):(l&&fa(O.document),b=function(a){return!!a&&ba(a)},ba(O)?a():ea(b,100,a,"PopUpAppender.init: unable to create console window")):(F=!1,I.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),ya&&k("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging."))}catch(Fa){k("PopUpAppender.init: error creating pop-up",
Fa)}};P=function(){g||W()};R=function(){P();B=!0};z=function(){return O};U=function(){if(F&&!a(O)&&!A){if(O.closed||y&&a(O.closed))return D.unload(),I.debug("PopUpAppender: pop-up closed"),!1;!y&&ba(O)&&(y=!0)}return F&&y&&!A}}this.getConsoleWindow=z};A.addGlobalCommandLineFunction=function(a,b){d.push([a,b])};b.prototype=new A;b.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,
scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0};b.prototype.toString=function(){return"PopUpAppender"};u.PopUpAppender=b;c.prototype=new A;c.prototype.defaults={layout:new E("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,
showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0};c.prototype.toString=function(){return"InPageAppender"};u.InPageAppender=c;u.InlineAppender=c})();(function(){function a(d,e,h,l,m){function k(a){a=a.style.cssText.split(";");for(var b="",c=0,d=a.length;c<d;c++){var b=a[c].split(":"),e=[];/^\s*$/.test(b[0])||e.push(g(b[0]).toLowerCase()+":"+g(b[1]));b=e.join(";")}return b}"string"!=typeof h&&(h="");l=!!l;m=!!m;var n;if("undefined"!=typeof e&&!e||d.nodeType==b.DOCUMENT_FRAGMENT_NODE){e=
"";m=0;for(n=d.childNodes.length;m<n;m++)e+=a(d.childNodes[m],!0,h+"  ");return e}switch(d.nodeType){case b.ELEMENT_NODE:var q=d.tagName.toLowerCase();e=(l?"\r\n"+h:"")+"<";m=d.prefix?d.prefix:d.outerHTML&&(new RegExp("<([^:]+):"+d.tagName+"[^>]*>","i")).test(d.outerHTML)?RegExp.$1.toLowerCase():"";(l=!!m)&&(e+=m+":");e+=q;m=0;for(n=d.attributes.length;m<n;m++){var r=d.attributes[m];r.specified&&null!==r.nodeValue&&"style"!==r.nodeName.toLowerCase()&&"string"===typeof r.nodeValue&&0!==r.nodeName.indexOf("_moz")&&
(e+=" "+r.nodeName.toLowerCase()+'="',e+=r.nodeValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),e+='"')}d.style.cssText&&""!==k(d)&&(e+=' style="'+k(d)+'"');if(t(f,q)||l&&!d.hasChildNodes())e+="/>";else{e+=">";l=!(1===d.childNodes.length&&d.childNodes[0].nodeType===b.TEXT_NODE);r=t(c,q);m=0;for(n=d.childNodes.length;m<n;m++)e+=a(d.childNodes[m],!0,h+"  ",l,r);d="</"+q+">";e+=l?"\r\n"+h+d:d}return e;case b.TEXT_NODE:if(d.nodeType==b.TEXT_NODE&&/^[ \t\r\n]*$/.test(d.nodeValue))e=
"";else{if(m)e=d.nodeValue;else{d=p(g(d.nodeValue));e=[];m=0;for(n=d.length;m<n;m++)e[m]=g(d[m]);e=e.join("\r\n"+h)}l&&(e="\r\n"+h+e)}return e;case b.CDATA_SECTION_NODE:return"<![CDATA["+d.nodeValue+"]]\x3e\r\n";case b.DOCUMENT_NODE:e="";m=0;for(n=d.childNodes.length;m<n;m++)e+=a(d.childNodes[m],!0,h);return e;default:return""}}var b={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,
DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},c=["script","pre"],f="br img hr param link area input col base meta".split(" ");(function(){A.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])});A.addGlobalCommandLineFunction("dir",function(a,b,c){a=[];c=0;for(var f=b.length;c<f;c++){var g=c,h;h=void 0;var l=b[c],m=0;for(h in l)m=Math.max(d(h).length,m);var k=[];for(h in l){var n="  "+W(d(h),m+2),q;try{q=p(d(l[h])).join(W("\r\n",m+6))}catch(ca){q=
"[Error obtaining property. Details: "+e(ca)+"]"}k.push(n+q)}h=k.join("\r\n");a[g]=h}return a.join("\r\n\r\n")});A.addGlobalCommandLineFunction("dirxml",function(b,c,d){b=[];d=0;for(var e=c.length;d<e;d++)b[d]=a(c[d]);return b.join("\r\n\r\n")});A.addGlobalCommandLineFunction("cd",function(a,b,c){var d;0===b.length||""===b[0]?(d=window,b="Command line set to run in main window"):b[0].window==b[0]?(d=b[0],b="Command line set to run in frame '"+b[0].name+"'"):(d=window.frames[b[0]])?b="Command line set to run in frame '"+
b[0]+"'":(c.isError=!0,b="Frame '"+b[0]+"' does not exist",d=a.getCommandWindow());a.setCommandWindow(d);return b});A.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1;a.clear()});A.addGlobalCommandLineFunction("keys",function(a,b,c){a=[];for(var d in b[0])a.push(d);return a});A.addGlobalCommandLineFunction("values",function(a,b,c){a=[];for(var d in b[0])try{a.push(b[0][d])}catch(ia){I.warn("values(): Unable to obtain value for key "+d+". Details: "+e(ia))}return a});A.addGlobalCommandLineFunction("expansionDepth",
function(a,b,c){var d=parseInt(b[0],10);if(isNaN(d)||0>d)return c.isError=!0,""+b[0]+" is not a valid expansion depth";a.setCommandLineObjectExpansionDepth(d);return"Object expansion depth set to "+d})})()})();u.setDocumentReady=function(){wa=!0;u.dispatchEvent("load",{})};if(window.addEventListener)window.addEventListener("load",u.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",u.setDocumentReady);else{var Ga=window.onload;window.onload="function"!=typeof window.onload?
u.setDocumentReady:function(a){Ga&&Ga(a);u.setDocumentReady()}}return u},this);
!function(){var a={},c=null,b=!0,d=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:b=!1}catch(f){b=!1}if(!b)if("undefined"!=typeof Audio)try{new Audio}catch(f){d=!0}else d=!0;if(b){var e="undefined"==typeof c.createGain?c.createGainNode():c.createGain();e.gain.value=1;e.connect(c.destination)}var h=function(a){this._volume=1;this._muted=!1;this.usingWebAudio=b;this.ctx=c;this.noAudio=d;this._howls=[];this._codecs=a;this.iOSAutoEnable=
!0};h.prototype={volume:function(a){if(a=parseFloat(a),0<=a&&1>=a){this._volume=a;b&&(e.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return b?e.gain.value:this._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){this._muted=a;b&&(e.gain.value=
a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(var d=0;d<this._howls[c]._audioNode.length;d++)this._howls[c]._audioNode[d].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var d=c.createBuffer(1,1,22050),e=c.createBufferSource();e.buffer=d;e.connect(c.destination);"undefined"==typeof e.start?
e.noteOn(0):e.start(0);setTimeout(function(){e.playbackState!==e.PLAYING_STATE&&e.playbackState!==e.FINISHED_STATE||(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchend",b,!1))},0)};return window.addEventListener("touchend",b,!1),a}}};var g=null,p={};d||(g=new Audio,p={mp3:!!g.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!g.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,
""),aac:!!g.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/m4a;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(g.canPlayType("audio/x-mp4;")||g.canPlayType("audio/mp4;")||g.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!g.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var q=new h(p),t=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;
this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._model=a.model||null;this._onload=[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=b&&!this._buffer;this._audioNode=[];this._webAudio&&
this._setupAudioNode();"undefined"!=typeof c&&c&&q.iOSAutoEnable&&q._enableiOSAudio();q._howls.push(this);this.load()};if(t.prototype={load:function(){var a=this,b=null;if(d)return void a.on("loaderror",Error("No audio support."));for(var c=0;c<a._urls.length;c++){var e,g;if(a._format)e=a._format;else{if(g=a._urls[c],e=/^data:audio\/([^;,]+);/i.exec(g),e||(e=/\.([^.]+)$/.exec(g.split("?",1)[0])),!e)return void a.on("loaderror",Error("Could not extract format from passed URLs, please add format parameter."));
e=e[1].toLowerCase()}if(p[e]){b=a._urls[c];break}}if(!b)return void a.on("loaderror",Error("No codec support for selected audio sources."));if(a._src=b,a._webAudio)x(a,b);else{var k=new Audio;k.addEventListener("error",function(){k.error&&4===k.error.code&&(h.noAudio=!0);a.on("loaderror",{type:k.error?k.error.code:0})},!1);a._audioNode.push(k);k.src=b;k._pos=0;k.preload="auto";k.volume=q._muted?0:a._volume*q.volume();var t=function(){a._duration=Math.ceil(10*k.duration)/10;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play();k.removeEventListener("canplaythrough",t,!1)};k.addEventListener("canplaythrough",t,!1);k.load()}return a},urls:function(a){return a?(this.stop(),this._urls="string"==typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var d=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var f=
0<e._pos?e._pos:d._sprite[a][0]/1E3,g=0;d._webAudio?(g=d._sprite[a][1]/1E3-e._pos,0<e._pos&&(f=d._sprite[a][0]/1E3+f)):g=d._sprite[a][1]/1E3-(f-d._sprite[a][0]/1E3);var h,l=!(!d._loop&&!d._sprite[a][2]),m="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){h=setTimeout(function(){!d._webAudio&&l&&d.stop(m).play(a,m);d._webAudio&&!l&&(d._nodeById(m).paused=!0,d._nodeById(m)._pos=0,d._clearEndTimer(m));d._webAudio||l||d.stop(m);d.on("end",m)},g/d._rate*1E3);d._onendTimer.push({timer:h,
id:m})}(),d._webAudio){var n=d._sprite[a][0]/1E3,p=d._sprite[a][1]/1E3;e.id=m;e.paused=!1;k(d,[l,n,p],m);d._playStart=c.currentTime;e.gain.value=d._volume;"undefined"==typeof e.bufferSource.start?l?e.bufferSource.noteGrainOn(0,f,86400):e.bufferSource.noteGrainOn(0,f,g):l?e.bufferSource.start(0,f,86400):e.bufferSource.start(0,f,g)}else{if(4!==e.readyState&&(e.readyState||!navigator.isCocoonJS))return d._clearEndTimer(m),function(){var c=a,f=b,g=function(){d.play(c,f);e.removeEventListener("canplaythrough",
g,!1)};e.addEventListener("canplaythrough",g,!1)}(),d;e.readyState=4;e.id=m;e.currentTime=f;e.muted=q._muted||e.muted;e.volume=d._volume*q.volume();setTimeout(function(){e.play()},0)}return d.on("play"),"function"==typeof b&&b(m),d}),d):("function"==typeof b&&b(),d):(d.on("load",function(){d.play(a,b)}),d)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||
c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0;"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),
c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),0<=a&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",
function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*q.volume()),c}return c._volume},loop:function(a){return"boolean"==typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"==typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return 0<=a?(d.pause(b),
e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(0<=a)return d;for(e=0;e<d._audioNode.length;e++)if(d._audioNode[e].paused&&4===d._audioNode[e].readyState)return d._webAudio?d._audioNode[e]._pos:d._audioNode[e].currentTime},pos3d:function(a,b,c,d){var e=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(0<=a||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):
e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}return e},fade:function(a,b,c,d,e){var f=this,g=a>b?"down":"up",h=Math.abs(a-b)/.01,l=c/h;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var k=1;h>=k;k++)!function(){var a=Math.round(1E3*(f._volume+("up"===g?.01:-.01)*k))/1E3;setTimeout(function(){f.volume(a,e);a===b&&d&&d()},l*k)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,
b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c();e.pause(d);e.on("end")},d)},_nodeById:function(a){for(var b=this._audioNode[0],c=0;c<this._audioNode.length;c++)if(this._audioNode[c].id===a){b=this._audioNode[c];break}return b},_activeNode:function(){for(var a=null,b=0;b<this._audioNode.length;b++)if(!this._audioNode[b].paused){a=this._audioNode[b];break}return this._drainPool(),a},_inactiveNode:function(a){for(var b=null,c=0;c<this._audioNode.length;c++)if(this._audioNode[c].paused&&
4===this._audioNode[c].readyState){a(this._audioNode[c]);b=!0;break}if(this._drainPool(),!b){var d;if(this._webAudio)d=this._setupAudioNode(),a(d);else{this.load();d=this._audioNode[this._audioNode.length-1];var e=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",f=function(){d.removeEventListener(e,f,!1);a(d)};d.addEventListener(e,f,!1)}}},_drainPool:function(){var a,b=0;for(a=0;a<this._audioNode.length;a++)this._audioNode[a].paused&&b++;for(a=this._audioNode.length-1;0<=a&&!(5>=b);a--)this._audioNode[a].paused&&
(this._webAudio&&this._audioNode[a].disconnect(0),b--,this._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=-1,c=0;c<this._onendTimer.length;c++)if(this._onendTimer[c].id===a){b=c;break}(a=this._onendTimer[b])&&(clearTimeout(a.timer),this._onendTimer.splice(b,1))},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;return a[b]="undefined"==typeof c.createGain?c.createGainNode():c.createGain(),a[b].gain.value=this._volume,a[b].paused=!0,a[b]._pos=0,a[b].readyState=
4,a[b].connect(e),a[b].panner=c.createPanner(),a[b].panner.panningModel=this._model||"equalpower",a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]),a[b].panner.connect(a[b]),a[b]},on:function(a,b){var c=this["_on"+a];if("function"==typeof b)c.push(b);else for(var d=0;d<c.length;d++)b?c[d].call(this,b):c[d].call(this);return this},off:function(a,b){var c=this["_on"+a];if(b)for(var d=0;d<c.length;d++){if(b===c[d]){c.splice(d,1);break}}else this["_on"+a]=[];return this},unload:function(){for(var b=
this._audioNode,c=0;c<this._audioNode.length;c++)b[c].paused||(this.stop(b[c].id),this.on("end",b[c].id)),this._webAudio?b[c].disconnect(0):b[c].src="";for(c=0;c<this._onendTimer.length;c++)clearTimeout(this._onendTimer[c].timer);b=q._howls.indexOf(this);null!==b&&0<=b&&q._howls.splice(b,1);delete a[this._src]}},b)var x=function(b,c){if(c in a)return b._duration=a[c].duration,void G(b);if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=
d.charCodeAt(f);w(e.buffer,b,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){w(g.response,b,c)};g.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{g.send()}catch(H){g.onerror()}}},w=function(b,d,e){c.decodeAudioData(b,function(b){b&&(a[e]=b,G(d,b))},function(a){d.on("loaderror",a)})},G=function(a,b){a._duration=b?b.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&
(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},k=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:q,Howl:t}});"undefined"!=typeof exports&&(exports.Howler=
q,exports.Howl=t);"undefined"!=typeof window&&(window.Howler=q,window.Howl=t)}();jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,c,b,d,e){return jQuery.easing[jQuery.easing.def](a,c,b,d,e)},easeInQuad:function(a,c,b,d,e){return d*(c/=e)*c+b},easeOutQuad:function(a,c,b,d,e){return-d*(c/=e)*(c-2)+b},easeInOutQuad:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c+b:-d/2*(--c*(c-2)-1)+b},easeInCubic:function(a,c,b,d,e){return d*(c/=e)*c*c+b},easeOutCubic:function(a,c,b,d,e){return d*((c=c/e-1)*c*c+1)+b},easeInOutCubic:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c+b:
d/2*((c-=2)*c*c+2)+b},easeInQuart:function(a,c,b,d,e){return d*(c/=e)*c*c*c+b},easeOutQuart:function(a,c,b,d,e){return-d*((c=c/e-1)*c*c*c-1)+b},easeInOutQuart:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c+b:-d/2*((c-=2)*c*c*c-2)+b},easeInQuint:function(a,c,b,d,e){return d*(c/=e)*c*c*c*c+b},easeOutQuint:function(a,c,b,d,e){return d*((c=c/e-1)*c*c*c*c+1)+b},easeInOutQuint:function(a,c,b,d,e){return 1>(c/=e/2)?d/2*c*c*c*c*c+b:d/2*((c-=2)*c*c*c*c+2)+b},easeInSine:function(a,c,b,d,e){return-d*Math.cos(c/
e*(Math.PI/2))+d+b},easeOutSine:function(a,c,b,d,e){return d*Math.sin(c/e*(Math.PI/2))+b},easeInOutSine:function(a,c,b,d,e){return-d/2*(Math.cos(Math.PI*c/e)-1)+b},easeInExpo:function(a,c,b,d,e){return 0==c?b:d*Math.pow(2,10*(c/e-1))+b},easeOutExpo:function(a,c,b,d,e){return c==e?b+d:d*(-Math.pow(2,-10*c/e)+1)+b},easeInOutExpo:function(a,c,b,d,e){return 0==c?b:c==e?b+d:1>(c/=e/2)?d/2*Math.pow(2,10*(c-1))+b:d/2*(-Math.pow(2,-10*--c)+2)+b},easeInCirc:function(a,c,b,d,e){return-d*(Math.sqrt(1-(c/=e)*
c)-1)+b},easeOutCirc:function(a,c,b,d,e){return d*Math.sqrt(1-(c=c/e-1)*c)+b},easeInOutCirc:function(a,c,b,d,e){return 1>(c/=e/2)?-d/2*(Math.sqrt(1-c*c)-1)+b:d/2*(Math.sqrt(1-(c-=2)*c)+1)+b},easeInElastic:function(a,c,b,d,e){a=0;var h=d;if(0==c)return b;if(1==(c/=e))return b+d;a||(a=.3*e);h<Math.abs(d)?(h=d,d=a/4):d=a/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*--c)*Math.sin(2*(c*e-d)*Math.PI/a))+b},easeOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(1==(c/=e))return b+d;h||
(h=.3*e);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*c)*Math.sin(2*(c*e-a)*Math.PI/h)+d+b},easeInOutElastic:function(a,c,b,d,e){var h=0,g=d;if(0==c)return b;if(2==(c/=e/2))return b+d;h||(h=.3*e*1.5);g<Math.abs(d)?(g=d,a=h/4):a=h/(2*Math.PI)*Math.asin(d/g);return 1>c?-.5*g*Math.pow(2,10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)+b:g*Math.pow(2,-10*--c)*Math.sin(2*(c*e-a)*Math.PI/h)*.5+d+b},easeInBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*(c/=e)*c*((h+1)*
c-h)+b},easeOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return d*((c=c/e-1)*c*((h+1)*c+h)+1)+b},easeInOutBack:function(a,c,b,d,e,h){void 0==h&&(h=1.70158);return 1>(c/=e/2)?d/2*c*c*(((h*=1.525)+1)*c-h)+b:d/2*((c-=2)*c*(((h*=1.525)+1)*c+h)+2)+b},easeInBounce:function(a,c,b,d,e){return d-jQuery.easing.easeOutBounce(a,e-c,0,d,e)+b},easeOutBounce:function(a,c,b,d,e){return(c/=e)<1/2.75?7.5625*d*c*c+b:c<2/2.75?d*(7.5625*(c-=1.5/2.75)*c+.75)+b:c<2.5/2.75?d*(7.5625*(c-=2.25/2.75)*c+.9375)+b:d*(7.5625*
(c-=2.625/2.75)*c+.984375)+b},easeInOutBounce:function(a,c,b,d,e){return c<e/2?.5*jQuery.easing.easeInBounce(a,2*c,0,d,e)+b:.5*jQuery.easing.easeOutBounce(a,2*c-e,0,d,e)+.5*d+b}});
(function(a){a.jqPagination=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$input=d.$el.find("input");d.$el.data("jqPagination",d);d.init=function(){d.options=a.extend({},a.jqPagination.defaultOptions,b);null===d.options.max_page&&(void 0!==d.$input.data("max-page")?d.options.max_page=d.$input.data("max-page"):d.options.max_page=1);void 0!==d.$input.data("current-page")&&d.isNumber(d.$input.data("current-page"))&&(d.options.current_page=d.$input.data("current-page"));d.$input.removeAttr("readonly");
d.updateInput(!0);d.$input.on("focus.jqPagination mouseup.jqPagination",function(b){if("focus"===b.type){var c=parseInt(d.options.current_page,10);a(this).val(c).select()}if("mouseup"===b.type)return!1});d.$input.on("blur.jqPagination keydown.jqPagination",function(b){var c=a(this),e=parseInt(d.options.current_page,10);27===b.keyCode&&(c.val(e),c.blur());13===b.keyCode&&c.blur();"blur"===b.type&&d.setPage(c.val())});d.$el.on("click.jqPagination","a",function(b){var c=a(this);if(c.hasClass("disabled"))return!1;
b.metaKey||b.ctrlKey||(b.preventDefault(),d.setPage(c.data("action")))})};d.setPage=function(a,b){if(void 0===a)return d.options.current_page;var c=parseInt(d.options.current_page,10),e=parseInt(d.options.max_page,10);if(isNaN(parseInt(a,10)))switch(a){case "first":a=1;break;case "prev":case "previous":a=c-1;break;case "next":a=c+1;break;case "last":a=e}a=parseInt(a,10);if(isNaN(a)||1>a||a>e)return d.setInputValue(c),!1;d.options.current_page=a;d.$input.data("current-page",a);d.updateInput(b)};d.setMaxPage=
function(a,b){if(void 0===a)return d.options.max_page;if(!d.isNumber(a))return console.error("jqPagination: max_page is not a number"),!1;if(a<d.options.current_page)return console.error("jqPagination: max_page lower than current_page"),!1;d.options.max_page=a;d.$input.data("max-page",a);d.updateInput(b)};d.updateInput=function(a){var b=parseInt(d.options.current_page,10);d.setInputValue(b);d.setLinks(b);!0!==a&&d.options.paged(b)};d.setInputValue=function(a){var b=d.options.page_string,c=d.options.max_page,
b=b.replace("{current_page}",a).replace("{max_page}",c);d.$input.val(b)};d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.setLinks=function(a){a=d.options.link_string;var b=parseInt(d.options.current_page,10),c=parseInt(d.options.max_page,10);if(""!==a){var e=b-1;1>e&&(e=1);var q=b+1;q>c&&(q=c);d.$el.find("a.first").attr("href",a.replace("{page_number}","1"));d.$el.find("a.prev, a.previous").attr("href",a.replace("{page_number}",e));d.$el.find("a.next").attr("href",a.replace("{page_number}",
q));d.$el.find("a.last").attr("href",a.replace("{page_number}",c))}d.$el.find("a").removeClass("disabled");b===c&&d.$el.find(".next, .last").addClass("disabled");1===b&&d.$el.find(".previous, .first").addClass("disabled")};d.callMethod=function(b,c,g){switch(b.toLowerCase()){case "option":if(void 0===g&&"object"!==typeof c)return d.options[c];b={trigger:!0};var e=!1;a.isPlainObject(c)&&!g?a.extend(b,c):b[c]=g;g=!1===b.trigger;void 0!==b.current_page&&(e=d.setPage(b.current_page,g));void 0!==b.max_page&&
(e=d.setMaxPage(b.max_page,g));!1===e&&console.error("jqPagination: cannot get / set option "+c);return e;case "destroy":d.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+b+'" does not exist'),!1}};d.init()};a.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}};a.fn.jqPagination=function(){var c=a(this),b=Array.prototype.slice.call(arguments),
d=!1;if("string"===typeof b[0])return void 0===b[2]?d=c.first().data("jqPagination").callMethod(b[0],b[1]):c.each(function(){d=a(this).data("jqPagination").callMethod(b[0],b[1],b[2])}),d;this.each(function(){new a.jqPagination(this,b[0])})}})(jQuery);console||(console={},func=function(){return!1},console.log=func,console.info=func,console.warn=func,console.error=func);function soundinit(){vlg.sfx={};vlg.music={};vlg.muted=!1;vlg.isSFXOn=!0;vlg.isMusicOn=!0;(function(a){Howl.prototype.play=function(c,b){"SFX"===this.audioType&&!vlg.isSFXOn||"MUSIC"===this.audioType&&!vlg.isMusicOn||a.call(this,c,b);return this}})(Howl.prototype.play);void 0!==GameConfig.config.defaultClickSound?(console.log("using sounds from GameConfig loaded from config sheet."),console.log("defaultClickSound",GameConfig.config.defaultClickSound),vlg.sfx.select=new Howl({urls:[GameConfig.config.defaultClickSound],
volume:1}),vlg.sfx.build=new Howl({urls:[GameConfig.config.defaultBuildSound],volume:.6}),vlg.sfx.cancel=new Howl({urls:[GameConfig.config.defaultCancelSound],volume:.8}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!0,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}),vlg.sfx.select.audioType="SFX",vlg.sfx.build.audioType="SFX",vlg.sfx.cancel.audioType="SFX",vlg.music.welcome.audioType=
"Music",vlg.music.levelfull1.audioType="Music"):(console.log("using sounds urls hardcoded in usehowler.js"),vlg.sfx.select=new Howl({urls:["/client/assets/audio/click.mp3"],volume:1}),vlg.sfx.cancel=new Howl({urls:["/client/assets/audio/cancel.mp3"],volume:.9}),vlg.music.welcome=new Howl({urls:["/client/assets/audio/music/Welcome.mp3"],autoplay:!1,loop:!1,volume:1}),vlg.music.levelfull1=new Howl({urls:["/client/assets/audio/music/Level1Full.mp3"],autoplay:!1,loop:!0,volume:1}))}
function afterplay(a){vlg.log.info("Played ",a)}
function bindSounds(){vlg.log.info("binding sound");$("#goalButton").click(function(a){vlg.log.debug("#goalButton click   .",a)});$("#topToolbar").click(function(a){vlg.log.info("toptoolbar click",a)});$("#topToolbar").children().click(function(a){vlg.log.debug(" toolbar children click .",a);vlg.sfx.select.play(afterplay)});$(".ui-dialog-titlebar-close").click(function(){vlg.log.debug("binding cancel sound to cancel buttons.");vlg.sfx.cancel.play()})}
function toggleSound(){vlg.log.info("toggling Sound ",vlg.muted);vlg.muted?(Howler.unmute(),vlg.muted=!1):(Howler.mute(),vlg.muted=!0);vlg.log.info("now ",vlg.muted);return vlg.muted}function toggleMusic(){vlg.isMusicOn?vlg.music.levelfull1.volume(1):vlg.music.levelfull1.volume(0)}vlg.soundinit=soundinit;vlg.bindSounds=bindSounds;vlg.toggleSound=toggleSound;
$(document).ready(function(){vlg.log.info("Enabling sound and mute");$("#volume").click(function(){vlg.toggleSound();$("#volume").find("img").toggle()});vlg.log.debug("#volume",$("#volume"));vlg.log.debug("#volume kids",$("#volume").children());vlg.log.debug("toogleSound ",vlg.toggleSound)});
